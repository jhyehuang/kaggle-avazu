2018-06-28 15:41:08,607 - DEBUG - data_preprocessing.py:235 - (40428967, 24)
2018-06-28 15:41:19,705 - DEBUG - data_preprocessing.py:240 - 0    10000174058809263569
1    10000182526920855428
2    10000554139829213984
3    10001094637809798845
4    10001377041558670745
Name: id, dtype: object
2018-06-28 15:41:19,706 - DEBUG - data_preprocessing.py:241 -                      id
0  10000174058809263569
1  10000182526920855428
2  10000554139829213984
3  10001094637809798845
4  10001377041558670745
2018-06-28 15:41:23,302 - DEBUG - data_preprocessing.py:244 - {'train': 40428967, 'test': 4577464}
2018-06-28 15:41:23,303 - DEBUG - data_preprocessing.py:248 - (4577464, 24)
2018-06-28 15:41:36,295 - DEBUG - data_preprocessing.py:260 - (45006431, 23)
2018-06-28 15:42:27,961 - DEBUG - data_preprocessing.py:104 - (45006431, 28)
2018-06-28 15:42:52,444 - DEBUG - data_preprocessing.py:60 - 2895973
2018-06-28 15:44:02,789 - DEBUG - data_preprocessing.py:62 - 7338655
2018-06-28 15:46:27,363 - DEBUG - data_preprocessing.py:65 - 14015907
2018-06-28 15:48:42,731 - DEBUG - data_preprocessing.py:68 - 14015907
2018-06-28 15:48:56,872 - DEBUG - data_preprocessing.py:98 - 0    37300009
1    37300009
2    37300009
3    37300009
4    37300009
Name: device_id_cnt, dtype: int64
2018-06-28 15:49:21,979 - DEBUG - data_preprocessing.py:98 - 0    79222
1       -1
2       -1
3       65
4       31
Name: device_ip_cnt, dtype: int64
2018-06-28 15:49:49,174 - DEBUG - data_preprocessing.py:98 - 0    114
1     -1
2     -1
3     -1
4     31
Name: uid_cnt, dtype: int64
2018-06-28 15:50:16,146 - DEBUG - data_preprocessing.py:98 - 0    114
1     -1
2     -1
3     -1
4     31
Name: uid_time_cnt, dtype: int64
2018-06-28 15:50:16,146 - DEBUG - data_preprocessing.py:75 - C1
2018-06-28 15:50:16,151 - DEBUG - data_preprocessing.py:75 - C14
2018-06-28 15:50:16,151 - DEBUG - data_preprocessing.py:75 - C15
2018-06-28 15:50:16,151 - DEBUG - data_preprocessing.py:75 - C16
2018-06-28 15:50:16,151 - DEBUG - data_preprocessing.py:75 - C17
2018-06-28 15:50:16,152 - DEBUG - data_preprocessing.py:75 - C18
2018-06-28 15:50:16,152 - DEBUG - data_preprocessing.py:75 - C19
2018-06-28 15:50:16,152 - DEBUG - data_preprocessing.py:75 - C20
2018-06-28 15:50:16,152 - DEBUG - data_preprocessing.py:75 - C21
2018-06-28 15:50:16,152 - DEBUG - data_preprocessing.py:75 - app_category
2018-06-28 15:50:17,413 - DEBUG - data_preprocessing.py:78 - [0 0 0 ... 0 4 0]
2018-06-28 15:50:19,965 - DEBUG - data_preprocessing.py:75 - app_domain
2018-06-28 15:50:21,141 - DEBUG - data_preprocessing.py:78 - [265 265 265 ... 265 393 265]
2018-06-28 15:50:23,459 - DEBUG - data_preprocessing.py:75 - app_id
2018-06-28 15:50:24,732 - DEBUG - data_preprocessing.py:78 - [8433 8433 8433 ... 8433 5231 8433]
2018-06-28 15:50:26,797 - DEBUG - data_preprocessing.py:75 - banner_pos
2018-06-28 15:50:26,797 - DEBUG - data_preprocessing.py:75 - click
2018-06-28 15:50:26,797 - DEBUG - data_preprocessing.py:75 - device_conn_type
2018-06-28 15:50:26,797 - DEBUG - data_preprocessing.py:75 - device_id
2018-06-28 15:50:37,303 - DEBUG - data_preprocessing.py:78 - [1918736 1918736 1918736 ... 1918736 1918736 1918736]
2018-06-28 15:50:39,116 - DEBUG - data_preprocessing.py:75 - device_ip
2018-06-28 15:51:14,444 - DEBUG - data_preprocessing.py:78 - [6359476 4316348 5155789 ... 5503589 2952329  529365]
2018-06-28 15:51:15,962 - DEBUG - data_preprocessing.py:75 - device_model
2018-06-28 15:51:17,571 - DEBUG - data_preprocessing.py:78 - [2200 3635 4485 ... 6770  162 5215]
2018-06-28 15:51:18,156 - DEBUG - data_preprocessing.py:75 - device_type
2018-06-28 15:51:18,156 - DEBUG - data_preprocessing.py:75 - hour
2018-06-28 15:51:18,156 - DEBUG - data_preprocessing.py:75 - site_category
2018-06-28 15:51:19,532 - DEBUG - data_preprocessing.py:78 - [ 2  2  2 ...  4  6 24]
2018-06-28 15:51:20,071 - DEBUG - data_preprocessing.py:75 - site_domain
2018-06-28 15:51:21,428 - DEBUG - data_preprocessing.py:78 - [7495 7495 7495 ... 3746 6124 7495]
2018-06-28 15:51:21,694 - DEBUG - data_preprocessing.py:75 - site_id
2018-06-28 15:51:23,300 - DEBUG - data_preprocessing.py:78 - [ 594  594  594 ... 1787 2546  439]
2018-06-28 15:51:23,421 - DEBUG - data_preprocessing.py:75 - one_day
2018-06-28 15:51:23,421 - DEBUG - data_preprocessing.py:75 - one_day_hour
2018-06-28 15:51:23,421 - DEBUG - data_preprocessing.py:75 - day_hour_prev
2018-06-28 15:51:23,421 - DEBUG - data_preprocessing.py:75 - day_hour_next
2018-06-28 15:51:23,421 - DEBUG - data_preprocessing.py:75 - is_work_day
2018-06-28 15:51:23,421 - DEBUG - data_preprocessing.py:75 - uid
2018-06-28 15:52:36,324 - DEBUG - data_preprocessing.py:78 - [11341862  8525242  9682604 ... 10161346  6639546  3302115]
2018-06-28 15:52:36,784 - DEBUG - data_preprocessing.py:75 - uid_time
2018-06-28 15:53:49,416 - DEBUG - data_preprocessing.py:78 - [11341862  8525242  9682604 ... 10161346  6639546  3302115]
2018-06-28 15:53:49,876 - DEBUG - data_preprocessing.py:75 - device_id_cnt
2018-06-28 15:53:49,876 - DEBUG - data_preprocessing.py:75 - device_ip_cnt
2018-06-28 15:53:49,876 - DEBUG - data_preprocessing.py:75 - uid_cnt
2018-06-28 15:53:49,876 - DEBUG - data_preprocessing.py:75 - uid_time_cnt
2018-06-28 15:53:50,194 - DEBUG - ml_utils.py:601 - 8433    28690990
5231     1655839
8075     1283649
5537     1021574
9094      838533
4136      662544
3757      610110
5885      537352
7535      484661
3032      421513
120       350509
8569      324961
8319      314461
8063      307451
2885      270931
5443      240762
3703      233257
134       219640
4127      207378
8742      201763
7333      183926
8314      180062
6791      134958
8870      118475
1049      117254
2119      110350
2021      104798
7370      102690
2987       89905
2025       86891
          ...   
3114           1
1237           1
4966           1
5016           1
8176           1
5018           1
5013           1
5011           1
8935           1
3087           1
8173           1
2050           1
8172           1
5002           1
2051           1
1220           1
1222           1
4970           1
2048           1
8182           1
4987           1
3089           1
8191           1
3090           1
4973           1
8190           1
4975           1
8188           1
1233           1
2348           1
Name: app_id, Length: 9136, dtype: int64
2018-06-28 15:53:50,200 - DEBUG - ml_utils.py:607 - [8433 5231 8075 5537 9094 4136 3757 5885 7535 3032  120 8569 8319 8063
 2885 5443 3703  134 4127 8742 7333 8314 6791 8870 1049 2119 2021 7370
 2987 2025 7942 9128 2234 4981 7569 2757 2110 2193 2474  398 5868 8971
 7142 4531  181 7646 2423 2646 5001 6048  818 3745 1447 7500  315 7728
 1606 4790 1916 5054  888 5825 5257 5718 4472 2596 4007 1043 1314 7090
  335 5793 4013 7509 6765 7108 7006 7976 3387 1805 6862 5922 8818 1374
 5664 7795 5878 4198 8184 5731  308 8208 6962 1408 1666 3362  682 3267
 5337 2033 7920 8600 5654 6853 7085 6587 4758 8310  319 7214 6237 6104
 8998 6790 8226 1981 3882 1334 7825 6973  998 4798 1633  372 7791 7512
 2249 8278 1926  347 2289 3660 2586 6079 2055 7088 6881 7398 8893 5039
 2503 7526 6384 5882 1908 6569 4530 1452 1540 2834 2580 4154 8847 2581
 1491  252 4475 5371 5271 1541 8397 2251 3995 3522 1182 6632 8399 4674
  227 3679 4972 1291 2449 4919 2564 6373 4692 5790 7914  256 7931 2551
  803 4329 5330 7014 1977 7130 9044 8980 8529 2698 4580 8284 7257 4266
  891 7124 8272 5313 3912 3829 2246 1970 4976 1407 4761 3681 4992 6144
 6299 4073  928 4220 4668 7932 5490 4551 5519 1747 8593 6248 1703 2487
  124  930 7461 3068 4991 8704 6546 8422 7284 2326 1204 2258   58 4586
 7856  596 2327 3625 7697  489 3601 2015  457 6489 7053 6857 1560  829
 2340  179 2387 7067  312 8643 7457 4644 1193 6206 1108 3463 9085  671
 6221 1016 2373 5124 2388 2907 5194  982 8320 2219 5881 2279  151 4683
 2826 3922 7061 4252 8029 5978  257 3565 5772 8317 5469 1630 3502 1990
 2155 6858 3055 5133 8940 7168 6094 3459 3517 7533 7576 1132 8079 4178
 4292 2579 1497 4351 1782 3448 1201 7849 4548  857 6798 1779 7463 2573
 6633 2905  253 5785  907 4613 1825  362   97 4219 6231  371 3487 7609
 8916 5358 1224 2679 7373 4998 7110 5517 3809 2466 8719 5889 4088 3937
 1519 1093 5254 6330  942 2371 1319 5005 7259 6572 7081 1814 8013 3303
 5980 5229 2979  710 5265 8675 3805 8010 8460 4950 3495 6708 2714 4871
 8205 3665  623 8606 9091 4350 1310 5203 1816 2972 8544 3992 5503 8605
 5116 3076 7888 8249 8093 2737 4892 4355 2752 7141 8758 5249 1693 6261
 1811 4956 8064 4202 1007 1731 2381 5478 3133 6930 6483 6321 5887  307
  894 6678 5475 6192  586 4495 1010 4641 3596   67 5015 5262 6239 7140
 5021 6953 5856 5003 6890 7467 3963 1564 1124 7806 3136 3416 3135 1112
 2949 2680 2130 7248 1522 7860 3252 3531 1293 2134 8018 3752 1052 5712
 7496 8367 2996 5338 2669 2152 5606 8514 4187 6113 7902 3477 1157  369
 5587 1569 1918 2976 7066 3040 4416 3127 5687 8945 7328 3072 1678 3066
 6502 7495 2800 7122 1199  102 2254 3120 3394 5873  863 3188 5576 2389
 7379 3841 2989 1296 2650 2719 7038 8642 5030 5208 8325 4635 3936 6657
 3950 5347 4103 5154 5014 1187 4757 6604  170 1028 5296 6193 1080 5540
 3874 2556 8992 8575 2341 3518 4172 2505 5107 6547 6313 9073  470 8911
 8713 1270 7194  637 2030 3743 8206 8750  205 1618 4307 5870 3862  216
 5122 2457 5757 4207 3000 8591 5983 3138 3670 8482  873 1641 4969 2203
 4334 3756 1901 7539 8475 7857 1620 6280 3242 3358 4407 7769 3259 1117
 3877 5029 4140 3316 1733 3962 6135 4213 8467 1451 5295 3251 1450 3142
 8743 5377 3335 4770 4961 7684 6837 5506 8381 7138 4536 6198 7853  760
 4014  463 1372 6121 7751 4458 3022  199 4775 7117 4227 8281 7650 8341
 7341 7712 3397 2779 2653 6746  603 8238 1168 5477 8677 8782   28 4396
 4538 6446 5197 7382  386 8871 1011 4663 2414 8366 4922 7161 7664 7069
 8547 6307  953 5178 2631 6236 3769 5195 3684 3529 2792 8365 1996 1962
 8574 7517 7567 2755 8405 4076 8423 8296  954 6247 2816 1440 6684 2278
 4741 3606  877 5359  872 4927 4905 2942 6568 5353 8436 1526 6885 9112
 6278 5324   38 5624 5958 2681 4911 5067 7499 3094 8014 3647 7116 8246
 5103 1421 3893 5982 3844  693 9043 1665  233 5553 7273 6525 8038 4005
 4224 4693 6297 4939 5453 4535 7988 2702 3964 4963 6284 6081 4242 4743
 2735 8486 2082 8816 4175 6856 7190 8841 6743 3528 8438 3271 1742 8885
 7149 1706 6750 7877 7441 4408 3446 2144 3008 6212 6246 3183 7790 4342
 4208 2813 8477 5204 4622 2708 8590 7099 8332  107 3585 8453 8751 6002
 9042 5536 7019 7314 4654 2785  549 1548  291 7251 1573 5866 8588 7876
 5955 1572 3286 2483 1566 1279 4479 4888 6605 3158 8933 6047 2253 6071
 8165 1574  653 3204 2544 4519 8141 2018 5258 4264 7565 2160 4272 5149
 7776  688 2004 6233 2177 3418 6794 2300 2470 3400 5344 6846 2320  554
 3179 7866 3475 6243  535 7781 3876 7157 1909 8411 4745 1978 1997 5999
 1936 4984 2353 7366 9021 8784 5550 6812 5578 2847 2809 4373 3146 7596
  654  512 3579 2124 8760 4833 5230 5709 7704 7351 8100 3779 8099 7736
 7611 1106 1900 4243 7383  295 7566 1963 6014 1550 4680 2183 3371 5500
  546 9014 1701 8187 1993 4457 1694 1612  924 4974 7812 6148 2157 4876
 7193 8387 4210  597 7334]
2018-06-28 15:55:59,831 - DEBUG - ml_utils.py:611 - top_10_
2018-06-28 15:55:59,831 - DEBUG - ml_utils.py:613 - [8433 5231 8075 ... 1262  281 7725]
2018-06-28 15:58:44,995 - DEBUG - ml_utils.py:617 - top_25_
2018-06-28 15:58:44,996 - DEBUG - ml_utils.py:619 - [8433 5231 8075 5537 9094 4136 3757 5885 7535 3032  120 8569 8319 8063
 2885 5443 3703  134 4127 8742 7333 8314 6791 8870 1049 2119 2021 7370
 2987 2025 7942 9128 2234 4981 7569 2757 2110 2193 2474  398 5868 8971
 7142 4531  181 7646 2423 2646 5001 6048  818 3745 1447 7500  315 7728
 1606 4790 1916 5054  888 5825 5257 5718 4472 2596 4007 1043 1314 7090
  335 5793 4013 7509 6765 7108 7006 7976 3387 1805 6862 5922 8818 1374
 5664 7795 5878 4198 8184 5731  308 8208 6962 1408 1666 3362  682 3267
 5337 2033 7920 8600 5654 6853 7085 6587 4758 8310  319 7214 6237 6104
 8998 6790 8226 1981 3882 1334 7825 6973  998 4798 1633  372 7791 7512
 2249 8278 1926  347 2289 3660 2586 6079 2055 7088 6881 7398 8893 5039
 2503 7526 6384 5882 1908 6569 4530 1452 1540 2834 2580 4154 8847 2581
 1491  252 4475 5371 5271 1541 8397 2251 3995 3522 1182 6632 8399 4674
  227 3679 4972 1291 2449 4919 2564 6373 4692 5790 7914  256 7931 2551
  803 4329 5330 7014 1977 7130 9044 8980 8529 2698 4580 8284 7257 4266
  891 7124 8272 5313 3912 3829 2246 1970 4976 1407 4761 3681 4992 6144
 6299 4073  928 4220 4668 7932 5490 4551 5519 1747 8593 6248 1703 2487
  124  930 7461 3068 4991 8704 6546 8422 7284 2326 1204 2258   58 4586
 7856  596 2327 3625 7697  489 3601 2015  457 6489 7053 6857 1560  829
 2340  179 2387 7067  312 8643 7457 4644 1193 6206 1108 3463 9085  671
 6221 1016 2373 5124 2388 2907 5194  982 8320 2219 5881 2279  151 4683
 2826 3922 7061 4252 8029 5978  257 3565 5772 8317 5469 1630 3502 1990
 2155 6858 3055 5133 8940 7168 6094 3459 3517 7533 7576 1132 8079 4178
 4292 2579 1497 4351 1782 3448 1201 7849 4548  857 6798 1779 7463 2573
 6633 2905  253 5785  907 4613 1825  362   97 4219 6231  371 3487 7609
 8916 5358 1224 2679 7373 4998 7110 5517 3809 2466 8719 5889 4088 3937
 1519 1093 5254 6330  942 2371 1319 5005 7259 6572 7081 1814 8013 3303
 5980 5229 2979  710 5265 8675 3805 8010 8460 4950 3495 6708 2714 4871
 8205 3665  623 8606 9091 4350 1310 5203 1816 2972 8544 3992 5503 8605
 5116 3076 7888 8249 8093 2737 4892 4355 2752 7141 8758 5249 1693 6261
 1811 4956 8064 4202 1007 1731 2381 5478 3133 6930 6483 6321 5887  307
  894 6678 5475 6192  586 4495 1010 4641 3596   67 5015 5262 6239 7140
 5021 6953 5856 5003 6890 7467 3963 1564 1124 7806 3136 3416 3135 1112
 2949 2680 2130 7248 1522 7860 3252 3531 1293]
2018-06-28 16:00:44,486 - DEBUG - ml_utils.py:623 - top_5_
2018-06-28 16:00:44,486 - DEBUG - ml_utils.py:625 - [8433 5231 8075 ... 6142 9132  988]
2018-06-28 16:03:42,687 - DEBUG - ml_utils.py:629 - top_50_
2018-06-28 16:03:42,688 - DEBUG - ml_utils.py:631 - [8433 5231 8075 5537 9094 4136 3757 5885 7535 3032  120 8569 8319 8063
 2885 5443 3703  134 4127 8742 7333 8314 6791 8870 1049 2119 2021 7370
 2987 2025 7942 9128 2234 4981 7569 2757 2110 2193 2474  398 5868 8971
 7142 4531  181 7646 2423 2646 5001 6048  818 3745 1447 7500  315 7728
 1606 4790 1916 5054  888 5825 5257 5718 4472 2596 4007 1043 1314 7090
  335 5793 4013 7509 6765 7108 7006 7976 3387 1805 6862 5922 8818 1374
 5664 7795 5878 4198 8184 5731  308 8208]
2018-06-28 16:05:40,372 - DEBUG - ml_utils.py:635 - top_1_
2018-06-28 16:05:40,372 - DEBUG - ml_utils.py:637 - [8433 5231 8075 5537 9094 4136 3757 5885 7535 3032  120 8569 8319 8063
 2885 5443 3703  134 4127 8742 7333 8314 6791 8870 1049 2119 2021 7370
 2987 2025 7942 9128 2234 4981 7569 2757 2110 2193 2474  398 5868 8971
 7142 4531  181 7646 2423 2646 5001 6048  818 3745 1447 7500  315 7728
 1606 4790 1916 5054  888 5825 5257 5718 4472 2596 4007 1043 1314 7090
  335 5793 4013 7509 6765 7108 7006 7976 3387 1805 6862 5922 8818 1374
 5664 7795 5878 4198 8184 5731  308 8208 6962 1408 1666 3362  682 3267
 5337 2033 7920 8600 5654 6853 7085 6587 4758 8310  319 7214 6237 6104
 8998 6790 8226 1981 3882 1334 7825 6973  998 4798 1633  372 7791 7512
 2249 8278 1926  347 2289 3660 2586 6079 2055 7088 6881 7398 8893 5039
 2503 7526 6384 5882 1908 6569 4530 1452 1540 2834 2580 4154 8847 2581
 1491  252 4475 5371 5271 1541 8397 2251 3995 3522 1182 6632 8399 4674
  227 3679 4972 1291 2449 4919 2564 6373 4692 5790 7914  256 7931 2551
  803]
2018-06-28 16:07:35,828 - DEBUG - ml_utils.py:641 - top_2_
2018-06-28 16:07:35,828 - DEBUG - ml_utils.py:643 - [8433 5231 8075 ... 4983 5025 6544]
2018-06-28 16:10:00,455 - DEBUG - ml_utils.py:647 - top_15_
2018-06-28 16:10:00,456 - DEBUG - ml_utils.py:649 - [8433 5231 8075 ... 7882  244 7041]
2018-06-28 16:12:29,804 - DEBUG - ml_utils.py:653 - top_20_
2018-06-28 16:12:29,805 - DEBUG - ml_utils.py:655 - [8433 5231 8075 ... 7115 4149 7817]
2018-06-28 16:15:50,236 - DEBUG - ml_utils.py:659 - top_30_
2018-06-28 16:15:50,236 - DEBUG - ml_utils.py:661 - 8433    28690990
5231     1655839
8075     1283649
5537     1021574
9094      838533
4136      662544
3757      610110
5885      537352
7535      484661
3032      421513
120       350509
8569      324961
8319      314461
8063      307451
2885      270931
5443      240762
3703      233257
134       219640
4127      207378
8742      201763
7333      183926
8314      180062
6791      134958
8870      118475
1049      117254
2119      110350
2021      104798
7370      102690
2987       89905
2025       86891
          ...   
3114           1
1237           1
4966           1
5016           1
8176           1
5018           1
5013           1
5011           1
8935           1
3087           1
8173           1
2050           1
8172           1
5002           1
2051           1
1220           1
1222           1
4970           1
2048           1
8182           1
4987           1
3089           1
8191           1
3090           1
4973           1
8190           1
4975           1
8188           1
1233           1
2348           1
Name: app_id, Length: 9136, dtype: int64
2018-06-28 16:15:50,639 - DEBUG - ml_utils.py:601 - 2546    16315441
594      6916012
4251     2906619
4121     1024058
1787     1009141
1792      860333
439       813053
2538      798088
3160      461817
3472      396307
1856      384020
1951      364541
1743      348644
1801      345520
1931      333023
438       292587
2508      292177
4306      284931
198       281584
1746      279984
4388      273081
4036      259523
351       212399
2798      206743
2104      205829
4335      190062
3534      183723
2925      177462
4283      172373
1601      165486
          ...   
4683           1
2552           1
2553           1
3155           1
4233           1
650            1
3747           1
3156           1
4225           1
3466           1
4226           1
2564           1
4433           1
405            1
2577           1
3731           1
2586           1
2844           1
2580           1
400            1
4432           1
4678           1
648            1
1388           1
1391           1
1394           1
3139           1
391            1
1396           1
756            1
Name: site_id, Length: 4842, dtype: int64
2018-06-28 16:15:50,641 - DEBUG - ml_utils.py:607 - [2546  594 4251 4121 1787 1792  439 2538 3160 3472 1856 1951 1743 1801
 1931  438 2508 4306  198 1746 4388 4036  351 2798 2104 4335 3534 2925
 4283 1601 1491 2142 3891 2984  292 2582  415 2773 2611 1542 1066 2983
 3525 3498 4228  722 2400  790  803 1331  432 4809 2207 1609 3643 3723
 4712  637 4651 4217 4172 3489  652  656 4099 2589 1794 3904 1661 4662
 1197 4504  958 2989 2315 2322 3959 3844 4736 2168  909 4400 2526 2280
 4544 2437  243 4371 2270 4080 1912 2261 3253  769  505 4444  489 2378
 3698 2796 4638 4685 4330 3085 2058 3872 4615 2353  394 2234  600  772
  382 1357  514 2968  862  828 2031 3754 4822 3421 3975 3175 2918 3796
 4230 4724 1583 4071 3262 1090 3644 3925  572 1675  172 3304 4626 2727
  537  203  395 2156 2783   66 2737 1339 3146 3189 4375 4570 1075 3359
 3738 3705  335 2238 4250 1334 2719  101 4719  830 2363  954  397 4818
 1948 2541 3854 1270 2250 4800 3334 4317 4006 2696 1495 2890 1289 2183
 4344  618 3028 1433 3630 1471 4715 3448 3728 1274 1100 4022  892 4165
  115  379 1796 4145 4262 3098  738 2343 2748 1082 1337 2930 4443 1333
 3673 3558  465  450  907 1783 1809 2136 3083  758 1201  496 1489 3900
 4665 2682 3036 4574 3690   59   21 2574  675 2244  296 3589  609 3316
 2939 4551 4837 4101 4768   45 2829 3047 3804 3007  579 1777 1420 4223
 4606 4247 1651 1590 1118 2864 1444 1901  778 2496 2206 2419  606  256
 1215 4248 3152   39 1451 3158 4642 2522 2154 2129 1484 2997 3310 1572
 4021 2599 1877 1908 4063 1069  209 1927 4326 1323 4030  612 2421 2887
 2254 4698 1190 2817 3756 2049 2445  945 1040 3736 3281 2771 4834 2742
 2383 3758 3976  151 2663 1067 3050 2632 2931 1412 4733  321 1509 2188
 1208 3021 2453 2211 1671 1016 1627 4213 2394   48 3785 1196 2841 1538
 2908 4455 2511 1171 1522 2596 3478 3699 4449 3777 3104 3745  874 2041
 2476 3615 2413 2274 3053 2561 2078 4827 3468 4613 2525 1267 2635  970
 3841 2083 2530  597  206 4286 4477  799 2194 4745 1711  999 2703 4092
  932 1546 1466 3565 2271  561 1255 4633 4440  928 2025 1762 4289 3275
 1103 1818 4381 3696 2268 4463  280 4192 2132 1728  996  443  469 3619
  161 3191 3399 2602 3997  817  645 1086 4133  701  310 2498 3803 1976
 1419 4203 2940 1629   68 1767 2592 3045 4543 3653 4573 3486 2732 4530
 2782 4441 3285  332 1611 3433 4368 2750 3550  466 2778 4162 1390 4454
 2295 2740 1773 3564 1622 4623 2876 3938 4758 2809 2313 3318 3277 2210
 2040 1373 4756 2660  988 3311 3174  868  624  667  107 3849  972  118
 3706  538  620 3876 2833 3089 2281 3070  273]
2018-06-28 16:17:49,958 - DEBUG - ml_utils.py:611 - top_10_
2018-06-28 16:17:49,958 - DEBUG - ml_utils.py:613 - [2546  594 4251 ...  881 3020 4532]
2018-06-28 16:20:12,678 - DEBUG - ml_utils.py:617 - top_25_
2018-06-28 16:20:12,678 - DEBUG - ml_utils.py:619 - [2546  594 4251 4121 1787 1792  439 2538 3160 3472 1856 1951 1743 1801
 1931  438 2508 4306  198 1746 4388 4036  351 2798 2104 4335 3534 2925
 4283 1601 1491 2142 3891 2984  292 2582  415 2773 2611 1542 1066 2983
 3525 3498 4228  722 2400  790  803 1331  432 4809 2207 1609 3643 3723
 4712  637 4651 4217 4172 3489  652  656 4099 2589 1794 3904 1661 4662
 1197 4504  958 2989 2315 2322 3959 3844 4736 2168  909 4400 2526 2280
 4544 2437  243 4371 2270 4080 1912 2261 3253  769  505 4444  489 2378
 3698 2796 4638 4685 4330 3085 2058 3872 4615 2353  394 2234  600  772
  382 1357  514 2968  862  828 2031 3754 4822 3421 3975 3175 2918 3796
 4230 4724 1583 4071 3262 1090 3644 3925  572 1675  172 3304 4626 2727
  537  203  395 2156 2783   66 2737 1339 3146 3189 4375 4570 1075 3359
 3738 3705  335 2238 4250 1334 2719  101 4719  830 2363  954  397 4818
 1948 2541 3854 1270 2250 4800 3334 4317 4006 2696 1495 2890 1289 2183
 4344  618 3028 1433 3630 1471 4715 3448 3728 1274 1100 4022  892 4165
  115  379 1796 4145 4262 3098  738 2343 2748 1082 1337 2930 4443 1333
 3673 3558  465  450  907 1783 1809 2136 3083  758 1201  496 1489 3900
 4665 2682 3036 4574 3690   59   21 2574  675 2244  296 3589  609 3316
 2939 4551 4837 4101 4768]
2018-06-28 16:22:10,344 - DEBUG - ml_utils.py:623 - top_5_
2018-06-28 16:22:10,345 - DEBUG - ml_utils.py:625 - [2546  594 4251 ... 4053  371  729]
2018-06-28 16:24:47,565 - DEBUG - ml_utils.py:629 - top_50_
2018-06-28 16:24:47,566 - DEBUG - ml_utils.py:631 - [2546  594 4251 4121 1787 1792  439 2538 3160 3472 1856 1951 1743 1801
 1931  438 2508 4306  198 1746 4388 4036  351 2798 2104 4335 3534 2925
 4283 1601 1491 2142 3891 2984  292 2582  415 2773 2611 1542 1066 2983
 3525 3498 4228  722 2400  790  803]
2018-06-28 16:26:44,300 - DEBUG - ml_utils.py:635 - top_1_
2018-06-28 16:26:44,301 - DEBUG - ml_utils.py:637 - [2546  594 4251 4121 1787 1792  439 2538 3160 3472 1856 1951 1743 1801
 1931  438 2508 4306  198 1746 4388 4036  351 2798 2104 4335 3534 2925
 4283 1601 1491 2142 3891 2984  292 2582  415 2773 2611 1542 1066 2983
 3525 3498 4228  722 2400  790  803 1331  432 4809 2207 1609 3643 3723
 4712  637 4651 4217 4172 3489  652  656 4099 2589 1794 3904 1661 4662
 1197 4504  958 2989 2315 2322 3959 3844 4736 2168  909 4400 2526 2280
 4544 2437  243 4371 2270 4080 1912 2261 3253  769  505 4444  489]
2018-06-28 16:28:38,512 - DEBUG - ml_utils.py:641 - top_2_
2018-06-28 16:28:38,513 - DEBUG - ml_utils.py:643 - [2546  594 4251 4121 1787 1792  439 2538 3160 3472 1856 1951 1743 1801
 1931  438 2508 4306  198 1746 4388 4036  351 2798 2104 4335 3534 2925
 4283 1601 1491 2142 3891 2984  292 2582  415 2773 2611 1542 1066 2983
 3525 3498 4228  722 2400  790  803 1331  432 4809 2207 1609 3643 3723
 4712  637 4651 4217 4172 3489  652  656 4099 2589 1794 3904 1661 4662
 1197 4504  958 2989 2315 2322 3959 3844 4736 2168  909 4400 2526 2280
 4544 2437  243 4371 2270 4080 1912 2261 3253  769  505 4444  489 2378
 3698 2796 4638 4685 4330 3085 2058 3872 4615 2353  394 2234  600  772
  382 1357  514 2968  862  828 2031 3754 4822 3421 3975 3175 2918 3796
 4230 4724 1583 4071 3262 1090 3644 3925  572 1675  172 3304 4626 2727
  537  203  395 2156 2783   66 2737 1339 3146 3189 4375 4570 1075 3359
 3738 3705  335 2238 4250 1334 2719  101 4719  830 2363  954  397 4818
 1948 2541 3854 1270 2250 4800 3334 4317 4006 2696 1495 2890 1289 2183
 4344  618 3028 1433 3630 1471 4715 3448 3728 1274 1100 4022  892 4165
  115  379 1796 4145 4262 3098  738 2343 2748 1082 1337 2930 4443 1333
 3673 3558  465  450  907 1783 1809 2136 3083  758 1201  496 1489 3900
 4665 2682 3036 4574 3690   59   21 2574  675 2244  296 3589  609 3316
 2939 4551 4837 4101 4768   45 2829 3047 3804 3007  579 1777 1420 4223
 4606 4247 1651 1590 1118 2864 1444 1901  778 2496 2206 2419  606  256
 1215 4248 3152   39 1451 3158 4642 2522 2154 2129 1484 2997 3310 1572
 4021 2599 1877 1908 4063 1069  209 1927 4326 1323 4030  612 2421 2887
 2254 4698 1190 2817 3756 2049 2445  945 1040 3736 3281 2771 4834 2742
 2383 3758 3976  151 2663 1067 3050 2632 2931 1412 4733  321 1509 2188
 1208 3021 2453 2211 1671 1016 1627 4213 2394   48 3785 1196 2841 1538
 2908 4455 2511 1171 1522 2596 3478 3699 4449 3777 3104 3745  874 2041
 2476 3615 2413 2274 3053 2561 2078 4827 3468 4613 2525 1267 2635  970
 3841 2083 2530  597  206 4286 4477  799 2194 4745 1711  999 2703 4092
  932 1546 1466 3565 2271  561 1255 4633 4440  928 2025 1762 4289 3275
 1103 1818 4381 3696 2268 4463  280 4192 2132 1728  996  443  469 3619
  161 3191 3399 2602 3997  817  645 1086 4133  701  310 2498 3803 1976
 1419 4203 2940 1629   68 1767 2592 3045 4543 3653 4573 3486 2732 4530
 2782 4441 3285  332 1611 3433 4368 2750 3550  466 2778 4162 1390 4454
 2295 2740 1773 3564 1622 4623 2876 3938 4758 2809 2313 3318 3277 2210
 2040 1373 4756 2660  988 3311 3174  868  624  667  107 3849  972  118
 3706  538  620 3876 2833 3089 2281 3070  273 3501 1133 3953 4108 1565
 3416 1191 3708 2099 1251 2571  704 4200 4494 4769  938 3869  123 3322
 1835 2357 3983 2137 1166 1070 2397   62 4340 2759 1375  894 1231 4146
 3226  711  789 1376   77 3556 1727 1258 1281 4153 2077 3636 4553 2328
  672 4128 1772 4814 4497 1036 3961 1138 1788 4110 2330 2843 4239 4143
 4048 2489 4631 1844 1704 2610 3883 1895  625 1898 4541  325 3078  665
 1800  588 4545 2772 4357 2972 3966 1697 1448 1464 2710 1169 1515  989
 3383 3484  736 3361 4348 2554 4522 4197  583 4637 3662 3427  998 2991
 4655 1449 3230 1214 4320 2980 2291 1733 4013  269 3328 1752 3166 3076
 3614 2910 1152  559  235 4033 3726 2006 1439 3718 2120 1849 2872 4374
 1826  965 3110 1168 3826 2021 3274 3171   74 2316  517  975 3741 1235
 3293 3056 4820 2456 4253 4359 2812 2673 3783 3893 1610 3117 2260  110
 2784 2482  136   13 2624 3267 1365  798   17 3214 3336 4402  434  752
  270 1076 2555 3551 4556 3545 2106  104 1514 1200  513 2507 1359  164
 1506   43 2101 3622 3391 3692 2013 3002 3694 2317 3921 2664  962 1562
 1321 3577 3843  519 2521 4333 3081  298  255 3482 3611 1092 1430  100
 1243 1925 1519 1344 2807  906 2227 2915  543 1619   46  627 4003 4831
 3406 4352 2952 4711 1001  811  473 2198 3605 1104  384 3665 2901]
2018-06-28 16:30:46,265 - DEBUG - ml_utils.py:647 - top_15_
2018-06-28 16:30:46,265 - DEBUG - ml_utils.py:649 - [2546  594 4251 4121 1787 1792  439 2538 3160 3472 1856 1951 1743 1801
 1931  438 2508 4306  198 1746 4388 4036  351 2798 2104 4335 3534 2925
 4283 1601 1491 2142 3891 2984  292 2582  415 2773 2611 1542 1066 2983
 3525 3498 4228  722 2400  790  803 1331  432 4809 2207 1609 3643 3723
 4712  637 4651 4217 4172 3489  652  656 4099 2589 1794 3904 1661 4662
 1197 4504  958 2989 2315 2322 3959 3844 4736 2168  909 4400 2526 2280
 4544 2437  243 4371 2270 4080 1912 2261 3253  769  505 4444  489 2378
 3698 2796 4638 4685 4330 3085 2058 3872 4615 2353  394 2234  600  772
  382 1357  514 2968  862  828 2031 3754 4822 3421 3975 3175 2918 3796
 4230 4724 1583 4071 3262 1090 3644 3925  572 1675  172 3304 4626 2727
  537  203  395 2156 2783   66 2737 1339 3146 3189 4375 4570 1075 3359
 3738 3705  335 2238 4250 1334 2719  101 4719  830 2363  954  397 4818
 1948 2541 3854 1270 2250 4800 3334 4317 4006 2696 1495 2890 1289 2183
 4344  618 3028 1433 3630 1471 4715 3448 3728 1274 1100 4022  892 4165
  115  379 1796 4145 4262 3098  738 2343 2748 1082 1337 2930 4443 1333
 3673 3558  465  450  907 1783 1809 2136 3083  758 1201  496 1489 3900
 4665 2682 3036 4574 3690   59   21 2574  675 2244  296 3589  609 3316
 2939 4551 4837 4101 4768   45 2829 3047 3804 3007  579 1777 1420 4223
 4606 4247 1651 1590 1118 2864 1444 1901  778 2496 2206 2419  606  256
 1215 4248 3152   39 1451 3158 4642 2522 2154 2129 1484 2997 3310 1572
 4021 2599 1877 1908 4063 1069  209 1927 4326 1323 4030  612 2421 2887
 2254 4698 1190 2817 3756 2049 2445  945 1040 3736 3281 2771 4834 2742
 2383 3758 3976  151 2663 1067 3050 2632 2931 1412 4733  321 1509 2188
 1208 3021 2453 2211 1671 1016 1627 4213 2394   48 3785 1196 2841 1538
 2908 4455 2511 1171 1522 2596 3478 3699 4449 3777 3104 3745  874 2041
 2476 3615 2413 2274 3053 2561 2078 4827 3468 4613 2525 1267 2635  970
 3841 2083 2530  597  206 4286 4477  799 2194 4745 1711  999 2703 4092
  932 1546 1466 3565 2271  561 1255 4633 4440  928 2025 1762 4289 3275
 1103 1818 4381 3696 2268 4463  280 4192 2132 1728  996  443  469 3619
  161 3191 3399 2602 3997  817  645 1086 4133  701  310 2498 3803 1976
 1419 4203 2940 1629   68 1767 2592 3045 4543 3653 4573 3486 2732 4530
 2782 4441 3285  332 1611 3433 4368 2750 3550  466 2778 4162 1390 4454
 2295 2740 1773 3564 1622 4623 2876 3938 4758 2809 2313 3318 3277 2210
 2040 1373 4756 2660  988 3311 3174  868  624  667  107 3849  972  118
 3706  538  620 3876 2833 3089 2281 3070  273 3501 1133 3953 4108 1565
 3416 1191 3708 2099 1251 2571  704 4200 4494 4769  938 3869  123 3322
 1835 2357 3983 2137 1166 1070 2397   62 4340 2759 1375  894 1231 4146
 3226  711  789 1376   77 3556 1727 1258 1281 4153 2077 3636 4553 2328
  672 4128 1772 4814 4497 1036 3961 1138 1788 4110 2330 2843 4239 4143
 4048 2489 4631 1844 1704 2610 3883 1895  625 1898 4541  325 3078  665
 1800  588 4545 2772 4357 2972 3966 1697 1448 1464 2710 1169 1515  989
 3383 3484  736 3361 4348 2554 4522 4197  583 4637 3662 3427  998 2991
 4655 1449 3230 1214 4320 2980 2291 1733 4013  269 3328 1752 3166 3076
 3614 2910 1152  559  235 4033 3726 2006 1439 3718 2120 1849 2872 4374
 1826  965 3110 1168 3826 2021 3274 3171   74 2316  517  975 3741 1235
 3293 3056 4820 2456 4253 4359 2812 2673 3783 3893 1610 3117 2260  110
 2784 2482  136   13 2624 3267 1365  798   17 3214 3336 4402  434  752
  270 1076 2555 3551 4556 3545 2106  104 1514 1200  513 2507 1359  164
 1506   43 2101 3622 3391 3692 2013 3002 3694 2317 3921 2664  962 1562
 1321 3577 3843  519 2521 4333 3081  298  255 3482 3611 1092 1430  100
 1243 1925 1519 1344 2807  906 2227 2915  543 1619   46  627 4003 4831
 3406 4352 2952 4711 1001  811  473 2198 3605 1104  384 3665 2901 2345
 1237 4725 2588 1517  822 1587  569 4134 4222 1234 2687  119 2202 3685
  777 1641 1830 3875 4580 4012  706 2819 2007  366 1322 3145 1293 1402
 1155 2417 4773 3874 2161 3211 1254 4103 4208  497 1398  697 3356 4138
 3009 3507  786 2314 2061  322 2862 4161 3388 3678 2126 3330 3203 3595
 2723 4747 2752 1596  176 3169 3480  629 2603   75 4418 2926 2891 3831
 2515 3382 3168 1614 4537  525 2591 1295 1432 3890 2341 2661 2467 2321
  195 1503 1393 3442 3179 1717 2044   27 4437  343 1638 4740  617 1549
 1249 3320 3453 1423  527 4648 1474 1222 1928 1816 3217 1300 4716 3735
 4295  744 1204 3350  340  879 4273 3990 4406  155 1454 1404 3210 4397
  856 3543 4751 2226 1315  348  336 2609  494 3290 3910  898 1715 1917
 3234 4707 4189 2480  911 1900  189 4244 3222 2390 2831 2746 2850  250
 3815 3260 3972 1504  986 4735 2693 2369 1202  375 2332 1154 1979 4838
  398  399 1230 3724 4354 3929 2349   54 1291 3201 2340 1804  165 2697
 1701 2735 1805 1355 4590 4783  278 3159 4422 1932 2427 4519  261 4775
 1332 4640 3046 1952 3640 3603 2283 3165 2406 3772  967 3800 3031  532
 2900 2986 3424 3548 1530 4263 1597 4490 1839 1037 4377 1677 3654 4438
 1136  175 3095 4601 1699 2518 3524 3897 4364 1526 2135  208 1306 4612
 4799 3725 2171 1829]
2018-06-28 16:32:57,761 - DEBUG - ml_utils.py:653 - top_20_
2018-06-28 16:32:57,761 - DEBUG - ml_utils.py:655 - [2546  594 4251 ...  319 2627 4705]
2018-06-28 16:35:45,626 - DEBUG - ml_utils.py:659 - top_30_
2018-06-28 16:35:45,627 - DEBUG - ml_utils.py:661 - 2546    16315441
594      6916012
4251     2906619
4121     1024058
1787     1009141
1792      860333
439       813053
2538      798088
3160      461817
3472      396307
1856      384020
1951      364541
1743      348644
1801      345520
1931      333023
438       292587
2508      292177
4306      284931
198       281584
1746      279984
4388      273081
4036      259523
351       212399
2798      206743
2104      205829
4335      190062
3534      183723
2925      177462
4283      172373
1601      165486
          ...   
4683           1
2552           1
2553           1
3155           1
4233           1
650            1
3747           1
3156           1
4225           1
3466           1
4226           1
2564           1
4433           1
405            1
2577           1
3731           1
2586           1
2844           1
2580           1
400            1
4432           1
4678           1
648            1
1388           1
1391           1
1394           1
3139           1
391            1
1396           1
756            1
Name: site_id, Length: 4842, dtype: int64
2018-06-28 16:35:45,876 - DEBUG - ml_utils.py:601 - 265    30209718
76      6067233
393     2060689
205     1283962
294      838560
495      789806
425      694159
19       690517
422      581494
395      335160
507      321779
113      279623
250      233280
202      118475
302       69830
206       65770
152       65235
415       57380
290       26672
8         24330
388       18883
451       15162
380       14568
36        13773
345       11882
293        9554
146        8236
551        7503
143        7204
63         7196
         ...   
121           1
120           1
116           1
218           1
229           1
234           1
288           1
320           1
316           1
315           1
313           1
311           1
309           1
305           1
303           1
297           1
291           1
279           1
238           1
278           1
268           1
263           1
262           1
261           1
259           1
257           1
254           1
252           1
245           1
0             1
Name: app_domain, Length: 580, dtype: int64
2018-06-28 16:35:45,877 - DEBUG - ml_utils.py:607 - [265  76 393 205 294 495 425  19 422 395 507 113 250 202 302 206 152 415
 290   8 388 451 380  36 345 293 146 551 143  63  66  90 153 500 487 360
  18 236  47 525  84 414 197 401 409 221 137 285  35  68 553 554 306 503
 545 399 271 342]
2018-06-28 16:37:39,436 - DEBUG - ml_utils.py:611 - top_10_
2018-06-28 16:37:39,436 - DEBUG - ml_utils.py:613 - [265  76 393 205 294 495 425  19 422 395 507 113 250 202 302 206 152 415
 290   8 388 451 380  36 345 293 146 551 143  63  66  90 153 500 487 360
  18 236  47 525  84 414 197 401 409 221 137 285  35  68 553 554 306 503
 545 399 271 342 528 514 432 461 189 571 301 251 167 321 368  94 496 253
 559 437 362 310 275 419  81 255 298 273 565  28 200 170  15 127 260 128
 348 403  61 154 546 324 556 477 358 405 219 464 136 426 240 204 392 216
 147 440  87 569  80 258 561   7  71 428 282 400 318 188 424 230 499 572
 378 141 194  59  52 256 555 577 435  58 239 317 459 369 566 535 502  96
 454]
2018-06-28 16:39:34,779 - DEBUG - ml_utils.py:617 - top_25_
2018-06-28 16:39:34,779 - DEBUG - ml_utils.py:619 - [265  76 393 205 294 495 425  19 422 395 507 113 250 202 302 206 152 415
 290   8 388 451 380  36 345 293 146 551 143]
2018-06-28 16:41:27,817 - DEBUG - ml_utils.py:623 - top_5_
2018-06-28 16:41:27,818 - DEBUG - ml_utils.py:625 - [265  76 393 205 294 495 425  19 422 395 507 113 250 202 302 206 152 415
 290   8 388 451 380  36 345 293 146 551 143  63  66  90 153 500 487 360
  18 236  47 525  84 414 197 401 409 221 137 285  35  68 553 554 306 503
 545 399 271 342 528 514 432 461 189 571 301 251 167 321 368  94 496 253
 559 437 362 310 275 419  81 255 298 273 565  28 200 170  15 127 260 128
 348 403  61 154 546 324 556 477 358 405 219 464 136 426 240 204 392 216
 147 440  87 569  80 258 561   7  71 428 282 400 318 188 424 230 499 572
 378 141 194  59  52 256 555 577 435  58 239 317 459 369 566 535 502  96
 454 101 557 539  82  77  55 224  64 488 536 524 442 172 448 199 575  83
 453 264 365 413 131 109 156 198 355 494  88 237 222 344   1 144 287 446
 343 212 340 333 242 319 505 416 421 512 227  72 501 308 351 155 353  74
 493 542 328 185 445 249 390 452 225  57 119 481 299 281  43 142 574 277
 431  48 220 456  85 482 408  33 370 397 228 304 509 483 371 213 174 447
 382 139  78 516 518 184  42 105  32 168 165 558  41  73 163 280 443 241
 286 161 520 123  20  44 472  12 226  37 570 330 529  93 438 232 132 300
 283 335   9 182 552 562  92 427 377 430 186 364 193 276  86 269 533 489
 325 243 541 122]
2018-06-28 16:43:25,947 - DEBUG - ml_utils.py:629 - top_50_
2018-06-28 16:43:25,947 - DEBUG - ml_utils.py:631 - [265  76 393 205 294 495]
2018-06-28 16:45:18,708 - DEBUG - ml_utils.py:635 - top_1_
2018-06-28 16:45:18,709 - DEBUG - ml_utils.py:637 - [265  76 393 205 294 495 425  19 422 395 507 113]
2018-06-28 16:47:11,755 - DEBUG - ml_utils.py:641 - top_2_
2018-06-28 16:47:11,755 - DEBUG - ml_utils.py:643 - [265  76 393 205 294 495 425  19 422 395 507 113 250 202 302 206 152 415
 290   8 388 451 380  36 345 293 146 551 143  63  66  90 153 500 487 360
  18 236  47 525  84 414 197 401 409 221 137 285  35  68 553 554 306 503
 545 399 271 342 528 514 432 461 189 571 301 251 167 321 368  94 496 253
 559 437 362 310 275 419  81 255 298 273 565  28 200 170  15]
2018-06-28 16:49:07,791 - DEBUG - ml_utils.py:647 - top_15_
2018-06-28 16:49:07,791 - DEBUG - ml_utils.py:649 - [265  76 393 205 294 495 425  19 422 395 507 113 250 202 302 206 152 415
 290   8 388 451 380  36 345 293 146 551 143  63  66  90 153 500 487 360
  18 236  47 525  84 414 197 401 409 221 137 285  35  68 553 554 306 503
 545 399 271 342 528 514 432 461 189 571 301 251 167 321 368  94 496 253
 559 437 362 310 275 419  81 255 298 273 565  28 200 170  15 127 260 128
 348 403  61 154 546 324 556 477 358 405 219 464 136 426 240 204 392 216
 147 440  87 569  80 258 561   7]
2018-06-28 16:51:02,127 - DEBUG - ml_utils.py:653 - top_20_
2018-06-28 16:51:02,133 - DEBUG - ml_utils.py:655 - [265  76 393 205 294 495 425  19 422 395 507 113 250 202 302 206 152 415
 290   8 388 451 380  36 345 293 146 551 143  63  66  90 153 500 487 360
  18 236  47 525  84 414 197 401 409 221 137 285  35  68 553 554 306 503
 545 399 271 342 528 514 432 461 189 571 301 251 167 321 368  94 496 253
 559 437 362 310 275 419  81 255 298 273 565  28 200 170  15 127 260 128
 348 403  61 154 546 324 556 477 358 405 219 464 136 426 240 204 392 216
 147 440  87 569  80 258 561   7  71 428 282 400 318 188 424 230 499 572
 378 141 194  59  52 256 555 577 435  58 239 317 459 369 566 535 502  96
 454 101 557 539  82  77  55 224  64 488 536 524 442 172 448 199 575  83
 453 264 365 413 131 109 156 198 355 494  88 237 222 344   1 144 287 446
 343 212 340 333 242 319 505 416 421 512 227  72 501 308 351 155 353  74
 493 542 328 185 445 249 390 452 225  57 119 481 299 281  43 142 574 277
 431  48 220 456  85 482 408  33 370 397 228 304 509 483 371 213 174 447
 382 139  78 516 518 184  42 105  32 168 165 558  41  73 163 280 443 241
 286 161 520 123  20  44 472  12 226  37 570 330 529  93 438 232 132 300
 283 335   9 182 552 562  92 427 377 430 186 364 193 276  86 269 533 489
 325 243 541 122 129 396 135  70 195 480 479  53 111 468 209 211 444 407
 272 379 173 126   4  46 455 467 178 475 235 423 530 497  75 162 140 171
 134 201 107 356 374 540 510 394 359  34 410 367 334 296 337 517 433 532
 266 106 274 478  22 521 208 463 138 519 366 179 375 376 384 504 498 420
 429 486 485 177 159 441  27 398 361  10 312 267 247 110 244 284 104 295
 115 117 118  60 341 548 223 550 112  91 531  21 576 474 573 158   6 538
  16 568 491 511 567   5   3 124 527 515  97  11 563  13 560 145  23 289
 347 387 381  39 207 210 307 233 346 217 231 338 314  79  51 323  54 196
 386 389 181 270 248 450 246  29 175 176  67 180  65 578 412 292 411 404]
2018-06-28 16:53:00,296 - DEBUG - ml_utils.py:659 - top_30_
2018-06-28 16:53:00,296 - DEBUG - ml_utils.py:661 - 265    30209718
76      6067233
393     2060689
205     1283962
294      838560
495      789806
425      694159
19       690517
422      581494
395      335160
507      321779
113      279623
250      233280
202      118475
302       69830
206       65770
152       65235
415       57380
290       26672
8         24330
388       18883
451       15162
380       14568
36        13773
345       11882
293        9554
146        8236
551        7503
143        7204
63         7196
         ...   
121           1
120           1
116           1
218           1
229           1
234           1
288           1
320           1
316           1
315           1
313           1
311           1
309           1
305           1
303           1
297           1
291           1
279           1
238           1
278           1
268           1
263           1
262           1
261           1
259           1
257           1
254           1
252           1
245           1
0             1
Name: app_domain, Length: 580, dtype: int64
2018-06-28 16:53:00,627 - DEBUG - ml_utils.py:601 - 0     29047446
4     10447772
29     1911579
21     1763120
34     1447244
30      130270
31       57439
1        56620
17       43689
35       27670
11       24108
20       14757
23       11963
9         6518
5         6084
25        2713
7         2496
22        1796
18        1176
2          425
24         377
8          336
15         324
6          221
13         196
3           32
10          24
27           9
14           7
26           6
16           5
19           3
32           2
33           2
12           1
28           1
Name: app_category, dtype: int64
2018-06-28 16:53:00,628 - DEBUG - ml_utils.py:607 - [ 0  4 29 21]
2018-06-28 16:54:51,692 - DEBUG - ml_utils.py:611 - top_10_
2018-06-28 16:54:51,692 - DEBUG - ml_utils.py:613 - [ 0  4 29 21 34 30 31  1 17]
2018-06-28 16:56:44,204 - DEBUG - ml_utils.py:617 - top_25_
2018-06-28 16:56:44,205 - DEBUG - ml_utils.py:619 - [0 4]
2018-06-28 16:58:35,965 - DEBUG - ml_utils.py:623 - top_5_
2018-06-28 16:58:35,966 - DEBUG - ml_utils.py:625 - [ 0  4 29 21 34 30 31  1 17 35 11 20 23  9  5 25  7 22]
2018-06-28 17:00:28,701 - DEBUG - ml_utils.py:629 - top_50_
2018-06-28 17:00:28,701 - DEBUG - ml_utils.py:631 - [0]
2018-06-28 17:02:21,211 - DEBUG - ml_utils.py:635 - top_1_
2018-06-28 17:02:21,216 - DEBUG - ml_utils.py:637 - [0]
2018-06-28 17:04:13,132 - DEBUG - ml_utils.py:641 - top_2_
2018-06-28 17:04:13,132 - DEBUG - ml_utils.py:643 - [ 0  4 29 21 34 30]
2018-06-28 17:06:05,996 - DEBUG - ml_utils.py:647 - top_15_
2018-06-28 17:06:05,996 - DEBUG - ml_utils.py:649 - [ 0  4 29 21 34 30 31  1]
2018-06-28 17:07:56,785 - DEBUG - ml_utils.py:653 - top_20_
2018-06-28 17:07:56,785 - DEBUG - ml_utils.py:655 - [ 0  4 29 21 34 30 31  1 17 35 11 20 23  9  5 25  7 22 18  2 24  8 15  6
 13]
2018-06-28 17:09:52,141 - DEBUG - ml_utils.py:659 - top_30_
2018-06-28 17:09:52,141 - DEBUG - ml_utils.py:661 - 0     29047446
4     10447772
29     1911579
21     1763120
34     1447244
30      130270
31       57439
1        56620
17       43689
35       27670
11       24108
20       14757
23       11963
9         6518
5         6084
25        2713
7         2496
22        1796
18        1176
2          425
24         377
8          336
15         324
6          221
13         196
3           32
10          24
27           9
14           7
26           6
16           5
19           3
32           2
33           2
12           1
28           1
Name: app_category, dtype: int64
/home/zhijiehuang/github/data/train.csv
Traceback (most recent call last):
  File "encode_cat_features.py", line 48, in <module>
    click_to_csv()
  File "/home/zhijiehuang/github/kaggle-avazu/avazu_code/data_preprocessing.py", line 268, in click_to_csv
    num_features=pd.read_csv(FLAGS.tmp_data_path+'num_features.csv')
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/io/parsers.py", line 709, in parser_f
    return _read(filepath_or_buffer, kwds)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/io/parsers.py", line 455, in _read
    data = parser.read(nrows)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/io/parsers.py", line 1087, in read
    df = DataFrame(col_dict, columns=columns, index=index)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py", line 330, in __init__
    mgr = self._init_dict(data, index, columns, dtype=dtype)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py", line 461, in _init_dict
    return _arrays_to_mgr(arrays, data_names, index, columns, dtype=dtype)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py", line 6173, in _arrays_to_mgr
    return create_block_manager_from_arrays(arrays, arr_names, axes)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 4637, in create_block_manager_from_arrays
    blocks = form_blocks(arrays, names, axes)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 4709, in form_blocks
    int_blocks = _multi_blockify(int_items)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 4778, in _multi_blockify
    values, placement = _stack_arrays(list(tup_block), dtype)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 4821, in _stack_arrays
    stacked = np.empty(shape, dtype=dtype)
MemoryError
2018-06-28 18:37:29,725 - DEBUG - data_preprocessing.py:122 - to add some basic features ...
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py:3643: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self[name] = value
/home/zhijiehuang/github/data/train.csv
Traceback (most recent call last):
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/indexes/base.py", line 2525, in get_loc
    return self._engine.get_loc(key)
  File "pandas/_libs/index.pyx", line 117, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 139, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1265, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1273, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "encode_cat_features.py", line 52, in <module>
    new_expvn=two_features_data_preprocessing(FLAGS.tmp_data_path+file1,FLAGS.tmp_data_path+file2,FLAGS.tmp_data_path+file3)
  File "/home/zhijiehuang/github/kaggle-avazu/avazu_code/data_preprocessing.py", line 125, in two_features_data_preprocessing
    calc_exptv(data1,data2,data3,exptv_vn_list,add_count=True)
  File "/home/zhijiehuang/github/kaggle-avazu/avazu_code/ml/ml_utils.py", line 478, in calc_exptv
    t3['id']=num['id'].values
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py", line 2139, in __getitem__
    return self._getitem_column(key)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py", line 2146, in _getitem_column
    return self._get_item_cache(key)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py", line 1842, in _get_item_cache
    values = self._data.get(item)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 3843, in get
    loc = self.items.get_loc(item)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/indexes/base.py", line 2527, in get_loc
    return self._engine.get_loc(self._maybe_cast_indexer(key))
  File "pandas/_libs/index.pyx", line 117, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 139, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1265, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1273, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'id'
2018-06-28 19:06:05,741 - DEBUG - data_preprocessing.py:235 - (40428967, 24)
2018-06-28 19:06:17,133 - DEBUG - data_preprocessing.py:240 - 0    10000174058809263569
1    10000182526920855428
2    10000554139829213984
3    10001094637809798845
4    10001377041558670745
Name: id, dtype: object
2018-06-28 19:06:17,134 - DEBUG - data_preprocessing.py:241 -                      id
0  10000174058809263569
1  10000182526920855428
2  10000554139829213984
3  10001094637809798845
4  10001377041558670745
2018-06-28 19:06:20,832 - DEBUG - data_preprocessing.py:244 - {'train': 40428967, 'test': 4577464}
2018-06-28 19:06:20,833 - DEBUG - data_preprocessing.py:248 - (4577464, 24)
2018-06-28 19:06:33,799 - DEBUG - data_preprocessing.py:260 - (45006431, 23)
2018-06-28 19:07:25,008 - DEBUG - data_preprocessing.py:104 - (45006431, 28)
2018-06-28 19:07:49,531 - DEBUG - data_preprocessing.py:60 - 2895973
2018-06-28 19:09:00,647 - DEBUG - data_preprocessing.py:62 - 7338655
2018-06-28 19:11:26,456 - DEBUG - data_preprocessing.py:65 - 14015907
2018-06-28 19:13:42,714 - DEBUG - data_preprocessing.py:68 - 14015907
2018-06-28 19:13:56,639 - DEBUG - data_preprocessing.py:98 - 0    37300009
1    37300009
2    37300009
3    37300009
4    37300009
Name: device_id_cnt, dtype: int64
2018-06-28 19:14:21,592 - DEBUG - data_preprocessing.py:98 - 0    79222
1       -1
2       -1
3       65
4       31
Name: device_ip_cnt, dtype: int64
2018-06-28 19:14:48,495 - DEBUG - data_preprocessing.py:98 - 0    114
1     -1
2     -1
3     -1
4     31
Name: uid_cnt, dtype: int64
2018-06-28 19:21:06,139 - DEBUG - data_preprocessing.py:122 - to add some basic features ...
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py:3643: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self[name] = value
2018-06-28 19:31:52,885 - DEBUG - ml_utils.py:490 - C14C17
2018-06-28 19:31:52,887 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 19:31:52,887 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 19:31:52,887 - DEBUG - ml_utils.py:493 - (45006431, 2)
2018-06-28 19:32:43,416 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 19:32:43,677 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 19:32:43,677 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 19:32:51,114 - DEBUG - ml_utils.py:203 -           _key1  click
0           187      0
1           185      0
2           185      0
3           187      0
4           496      0
5           238      0
6           646      0
7           684      0
8           188      1
9           924      0
10          282      0
11          182      0
12          679      0
13          550      0
14          701      0
15          180      0
16          294      0
17          189      0
18         2817      0
19          747      0
20          640      0
21          187      0
22          650      0
23          182      1
24          187      0
25          900      0
26          701      0
27          864      1
28          650      0
29          187      0
...         ...    ...
45006401    544      0
45006402   2359      0
45006403    696      0
45006404   2696      0
45006405   2350      0
45006406   1335      0
45006407   1338      0
45006408   2817      0
45006409   1335      0
45006410   1342      0
45006411   1215      0
45006412    671      0
45006413    941      0
45006414   1338      0
45006415   2028      0
45006416    282      0
45006417   2584      0
45006418    295      0
45006419   1295      0
45006420    610      0
45006421    282      0
45006422    671      0
45006423   2579      0
45006424   1342      0
45006425    864      0
45006426    276      0
45006427   1215      0
45006428    276      0
45006429   2433      0
45006430   1335      0

[45006431 rows x 2 columns]
2018-06-28 19:32:57,963 - DEBUG - ml_utils.py:212 - _key1
0         448
1       28135
2       18541
3       22086
4          10
5           6
6           6
7           4
8           9
9          10
10        253
11        227
12        178
13        187
14        190
15        211
16          0
17         17
18         31
19         20
20         20
21         45
22         56
23         55
24         52
25         17
26          1
27          9
28         13
29         11
        ...  
2855      159
2856      158
2857      130
2858     1204
2859    82004
2860      402
2861       37
2862       25
2863       39
2864       26
2865     3042
2866     3328
2867     2861
2868      118
2869       56
2870       78
2871      576
2872     8284
2873        8
2874      128
2875       30
2876        0
2877      209
2878     1392
2879       54
2880        0
2881     9478
2882       64
2883       64
2884       50
Name: click, Length: 2885, dtype: int64
2018-06-28 19:32:57,965 - DEBUG - ml_utils.py:213 - _key1
0         2026
1        93220
2        75240
3        83365
4          174
5          172
6          159
7          135
8          146
9          173
10        1520
11        1511
12        1437
13        1506
14        1456
15        1538
16          13
17         111
18         122
19         108
20         107
21         297
22         276
23         298
24         293
25         165
26          47
27         123
28         147
29          38
         ...  
2855       710
2856       686
2857       652
2858     13365
2859    651920
2860      4027
2861       233
2862       146
2863       180
2864       178
2865      6844
2866      7228
2867      6693
2868       540
2869       338
2870       376
2871     11047
2872     60815
2873       145
2874       810
2875       666
2876      1205
2877     17106
2878     24248
2879       841
2880        49
2881    128675
2882       555
2883       534
2884       564
Name: click, Length: 2885, dtype: int64
2018-06-28 19:32:58,148 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 19:43:22,109 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 19:43:22,110 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 19:43:22,452 - DEBUG - ml_utils.py:234 - {'exp': array([1.43374489e-01, 1.97910801e-01, 1.97910801e-01, ...,
       3.62683706e-01, 8.90248764e-05, 9.79367816e-02]), 'cnt': array([488107, 514194, 514194, ..., 333337,  17124, 212122])}
2018-06-28 19:43:24,356 - DEBUG - ml_utils.py:490 - C14device_model
2018-06-28 19:43:24,356 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 19:43:24,356 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 19:43:24,356 - DEBUG - ml_utils.py:493 - (45006431, 4)
2018-06-28 19:44:34,712 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 19:44:35,379 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 19:44:35,379 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 19:44:38,761 - DEBUG - ml_utils.py:203 -            _key1  click
0          29508      0
1          26716      0
2          26897      0
3          29705      0
4          99122      0
5          47000      0
6         162445      0
7         182739      0
8          31179      1
9         245471      0
10         65951      0
11         23099      0
12        180867      0
13        116500      0
14        189564      0
15         20220      0
16         73793      0
17         33289      0
18        679460      0
19        199920      0
20        156756      0
21         30674      0
22        165287      0
23         22202      1
24         30425      0
25        230666      0
26        189538      0
27        218097      1
28        166535      0
29         30646      0
...          ...    ...
45006401  115937      0
45006402  563923      0
45006403  186713      0
45006404  656866      0
45006405  555218      0
45006406  354303      0
45006407  355330      0
45006408  679601      0
45006409  354603      0
45006410  356843      0
45006411  318459      0
45006412  179757      0
45006413  250347      0
45006414  355162      0
45006415  489846      0
45006416   66103      0
45006417  608736      0
45006418   74138      0
45006419  348871      0
45006420  146242      0
45006421   66152      0
45006422  179757      0
45006423  607035      0
45006424  356571      0
45006425  217712      0
45006426   64707      0
45006427  318776      0
45006428   64936      0
45006429  583590      0
45006430  354485      0

[45006431 rows x 2 columns]
2018-06-28 19:45:18,091 - DEBUG - ml_utils.py:212 - _key1
0          3
1          0
2          2
3          0
4          0
5          0
6          0
7          2
8          1
9          0
10         0
11         1
12         1
13         4
14         3
15         0
16         4
17         0
18         0
19         0
20         2
21         1
22         3
23         1
24         0
25         1
26         0
27         0
28         1
29         0
          ..
690988     0
690989     1
690990     3
690991     0
690992     1
690993     0
690994    15
690995    13
690996     8
690997     0
690998     5
690999     5
691000     8
691001     1
691002     1
691003     3
691004     0
691005     1
691006     1
691007     1
691008     0
691009     0
691010    12
691011     8
691012    12
691013     2
691014     6
691015     1
691016     1
691017     5
Name: click, Length: 691018, dtype: int64
2018-06-28 19:45:18,096 - DEBUG - ml_utils.py:213 - _key1
0           5
1           2
2          10
3           3
4           1
5           2
6           4
7           3
8           1
9           1
10          4
11          2
12          7
13          8
14          6
15          7
16          9
17          1
18          1
19          1
20          9
21          4
22          6
23         12
24          5
25          3
26          2
27          1
28          1
29          3
         ... 
690988      2
690989      7
690990     36
690991      2
690992      8
690993      4
690994    169
690995     30
690996    127
690997      1
690998     29
690999     37
691000     34
691001      3
691002     18
691003     26
691004      7
691005      3
691006     12
691007     32
691008      8
691009      4
691010    197
691011     25
691012    124
691013     27
691014     46
691015     33
691016     23
691017     23
Name: click, Length: 691018, dtype: int64
2018-06-28 19:45:18,292 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 19:56:43,005 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 19:56:43,005 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 19:56:43,350 - DEBUG - ml_utils.py:234 - {'exp': array([0.16470102, 0.22022394, 0.13365432, ..., 0.32861972, 0.00238709,
       0.08071956]), 'cnt': array([  825, 20912, 91349, ...,   515,   629, 11171])}
2018-06-28 19:56:45,245 - DEBUG - ml_utils.py:490 - C14C21
2018-06-28 19:56:45,245 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 19:56:45,246 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 19:56:45,246 - DEBUG - ml_utils.py:493 - (45006431, 5)
2018-06-28 19:57:48,287 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 19:57:48,732 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 19:57:48,732 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 19:57:50,247 - DEBUG - ml_utils.py:203 -           _key1  click
0           187      0
1           185      0
2           185      0
3           187      0
4           496      0
5           238      0
6           646      0
7           684      0
8           188      1
9           924      0
10          282      0
11          182      0
12          679      0
13          550      0
14          701      0
15          180      0
16          294      0
17          189      0
18         2817      0
19          747      0
20          640      0
21          187      0
22          650      0
23          182      1
24          187      0
25          900      0
26          701      0
27          864      1
28          650      0
29          187      0
...         ...    ...
45006401    544      0
45006402   2359      0
45006403    696      0
45006404   2696      0
45006405   2350      0
45006406   1335      0
45006407   1338      0
45006408   2817      0
45006409   1335      0
45006410   1342      0
45006411   1215      0
45006412    671      0
45006413    941      0
45006414   1338      0
45006415   2028      0
45006416    282      0
45006417   2584      0
45006418    295      0
45006419   1295      0
45006420    610      0
45006421    282      0
45006422    671      0
45006423   2579      0
45006424   1342      0
45006425    864      0
45006426    276      0
45006427   1215      0
45006428    276      0
45006429   2433      0
45006430   1335      0

[45006431 rows x 2 columns]
2018-06-28 19:57:54,955 - DEBUG - ml_utils.py:212 - _key1
0         448
1       28135
2       18541
3       22086
4          10
5           6
6           6
7           4
8           9
9          10
10        253
11        227
12        178
13        187
14        190
15        211
16          0
17         17
18         31
19         20
20         20
21         45
22         56
23         55
24         52
25         17
26          1
27          9
28         13
29         11
        ...  
2855      159
2856      158
2857      130
2858     1204
2859    82004
2860      402
2861       37
2862       25
2863       39
2864       26
2865     3042
2866     3328
2867     2861
2868      118
2869       56
2870       78
2871      576
2872     8284
2873        8
2874      128
2875       30
2876        0
2877      209
2878     1392
2879       54
2880        0
2881     9478
2882       64
2883       64
2884       50
Name: click, Length: 2885, dtype: int64
2018-06-28 19:57:54,956 - DEBUG - ml_utils.py:213 - _key1
0         2026
1        93220
2        75240
3        83365
4          174
5          172
6          159
7          135
8          146
9          173
10        1520
11        1511
12        1437
13        1506
14        1456
15        1538
16          13
17         111
18         122
19         108
20         107
21         297
22         276
23         298
24         293
25         165
26          47
27         123
28         147
29          38
         ...  
2855       710
2856       686
2857       652
2858     13365
2859    651920
2860      4027
2861       233
2862       146
2863       180
2864       178
2865      6844
2866      7228
2867      6693
2868       540
2869       338
2870       376
2871     11047
2872     60815
2873       145
2874       810
2875       666
2876      1205
2877     17106
2878     24248
2879       841
2880        49
2881    128675
2882       555
2883       534
2884       564
Name: click, Length: 2885, dtype: int64
2018-06-28 19:57:55,137 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 20:08:09,144 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 20:08:09,144 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 20:08:09,488 - DEBUG - ml_utils.py:234 - {'exp': array([1.43374489e-01, 1.97910801e-01, 1.97910801e-01, ...,
       3.62683706e-01, 8.90248764e-05, 9.79367816e-02]), 'cnt': array([488107, 514194, 514194, ..., 333337,  17124, 212122])}
2018-06-28 20:08:11,387 - DEBUG - ml_utils.py:490 - C14site_domain
2018-06-28 20:08:11,387 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 20:08:11,387 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 20:08:11,388 - DEBUG - ml_utils.py:493 - (45006431, 6)
2018-06-28 20:09:07,992 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 20:09:08,267 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 20:09:08,267 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 20:09:11,275 - DEBUG - ml_utils.py:203 -            _key1  click
0           8460      0
1           7368      0
2           7368      0
3           8460      0
4          34043      0
5          15800      0
6          50071      0
7          54835      0
8           8992      1
9          81139      0
10         20865      0
11          5770      0
12         54631      0
13         39458      0
14         55949      0
15          4927      0
16         24332      0
17          9522      0
18        188045      0
19         58182      0
20         48669      0
21          8460      0
22         52004      0
23          5770      1
24          8460      0
25         75305      0
26         55928      0
27         70258      1
28         52004      0
29          8460      0
...          ...    ...
45006401   39250      0
45006402  151961      0
45006403   55540      0
45006404  175363      0
45006405  151378      0
45006406  102311      0
45006407  102325      0
45006408  188152      0
45006409  102311      0
45006410  102350      0
45006411   93469      0
45006412   54450      0
45006413   83341      0
45006414  102325      0
45006415  141550      0
45006416   20865      0
45006417  164251      0
45006418   24489      0
45006419  100624      0
45006420   46042      0
45006421   20865      0
45006422   54450      0
45006423  163874      0
45006424  102350      0
45006425   70258      0
45006426   20849      0
45006427   93469      0
45006428   20849      0
45006429  155286      0
45006430  102311      0

[45006431 rows x 2 columns]
2018-06-28 20:09:41,241 - DEBUG - ml_utils.py:212 - _key1
0         1
1         1
2         0
3         0
4         0
5         4
6         1
7         0
8         0
9         1
10        1
11        0
12        2
13        0
14        1
15        0
16        1
17        1
18        0
19        0
20        1
21        0
22        1
23        1
24        0
25        0
26        0
27        7
28        0
29        0
         ..
193561    0
193562    0
193563    0
193564    0
193565    0
193566    1
193567    0
193568    7
193569    0
193570    2
193571    0
193572    0
193573    1
193574    0
193575    0
193576    0
193577    0
193578    0
193579    2
193580    0
193581    0
193582    0
193583    0
193584    0
193585    0
193586    0
193587    0
193588    0
193589    0
193590    2
Name: click, Length: 193591, dtype: int64
2018-06-28 20:09:41,242 - DEBUG - ml_utils.py:213 - _key1
0          1
1          1
2          2
3          2
4          4
5         40
6          3
7          2
8          1
9          1
10         1
11         4
12         5
13         1
14        13
15         2
16         6
17         1
18         3
19         1
20         3
21         1
22        27
23         3
24         1
25         6
26         1
27        31
28         3
29         1
          ..
193561     2
193562     1
193563     3
193564     3
193565     1
193566     1
193567     1
193568    15
193569     5
193570    13
193571     2
193572     6
193573     1
193574     1
193575     1
193576     1
193577     1
193578     2
193579    56
193580     2
193581     2
193582     1
193583     4
193584     1
193585     1
193586     3
193587    20
193588     4
193589     1
193590     2
Name: click, Length: 193591, dtype: int64
2018-06-28 20:09:41,429 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 20:20:05,142 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 20:20:05,142 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 20:20:05,480 - DEBUG - ml_utils.py:234 - {'exp': array([1.52071871e-01, 2.11540620e-01, 2.11540620e-01, ...,
       3.64211003e-01, 8.90248764e-05, 9.70913274e-02]), 'cnt': array([381083, 403844, 403844, ..., 329015,  17124, 209252])}
2018-06-28 20:20:05,631 - DEBUG - ml_utils.py:490 - C17device_model
2018-06-28 20:20:05,631 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 20:20:05,631 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 20:20:05,631 - DEBUG - ml_utils.py:493 - (45006431, 7)
2018-06-28 20:21:09,220 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 20:21:09,482 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 20:21:09,482 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 20:21:11,892 - DEBUG - ml_utils.py:203 -            _key1  click
0          11395      0
1          11861      0
2          12147      0
3          11716      0
4          45201      0
5          27870      0
6          78513      0
7          86638      0
8          11657      1
9         110624      0
10         34745      0
11         13451      0
12         45288      0
13         52829      0
14         84632      0
15         12147      0
16         40413      0
17         12679      0
18        258285      0
19         91390      0
20         76550      0
21         13326      0
22         77211      0
23         12035      1
24         12909      0
25        106638      0
26         84606      0
27         98243      1
28         78901      0
29         13279      0
...          ...    ...
45006401   57756      0
45006402  192330      0
45006403   26899      0
45006404  249236      0
45006405  213732      0
45006406  137458      0
45006407  137777      0
45006408  258483      0
45006409  137991      0
45006410  137962      0
45006411  137537      0
45006412   83590      0
45006413  112995      0
45006414  137465      0
45006415  187610      0
45006416   34897      0
45006417  234178      0
45006418   40876      0
45006419  146744      0
45006420   71833      0
45006421   34946      0
45006422   83590      0
45006423   98107      0
45006424  137457      0
45006425   97819      0
45006426   36377      0
45006427  137991      0
45006428   36646      0
45006429  224576      0
45006430  137777      0

[45006431 rows x 2 columns]
2018-06-28 20:21:16,598 - DEBUG - ml_utils.py:212 - _key1
0            6
1            2
2            2
3            0
4            0
5            2
6            0
7            2
8            1
9            1
10           0
11           1
12           1
13           1
14           4
15           7
16           0
17           6
18           0
19           0
20           0
21           4
22           0
23           1
24           4
25           3
26           0
27           1
28           0
29           0
          ... 
265663       1
265664       5
265665       0
265666       0
265667       1
265668     515
265669       0
265670     335
265671       0
265672       0
265673    1363
265674       0
265675       0
265676       1
265677       3
265678       8
265679       0
265680       1
265681       0
265682      42
265683      35
265684      33
265685       0
265686      10
265687      17
265688       0
265689      13
265690       1
265691       3
265692      11
Name: click, Length: 265693, dtype: int64
2018-06-28 20:21:16,600 - DEBUG - ml_utils.py:213 - _key1
0             9
1             5
2            10
3             5
4             1
5             4
6             5
7             8
8             1
9             1
10            1
11            5
12            3
13            7
14           11
15           13
16            7
17           15
18            1
19            3
20            1
21           13
22            1
23            5
24           10
25           18
26            5
27            3
28            2
29            1
          ...  
265663        1
265664        6
265665        3
265666        1
265667       27
265668    12017
265669        5
265670     4216
265671        2
265672        3
265673    15481
265674        1
265675       12
265676        5
265677       26
265678      102
265679        6
265680       23
265681        9
265682      548
265683       82
265684      374
265685        1
265686       97
265687      124
265688        1
265689       96
265690        4
265691       63
265692       79
Name: click, Length: 265693, dtype: int64
2018-06-28 20:21:16,787 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 20:32:02,608 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 20:32:02,608 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 20:32:02,949 - DEBUG - ml_utils.py:234 - {'exp': array([0.20875504, 0.20945204, 0.12018328, ..., 0.34286822, 0.00120581,
       0.11436016]), 'cnt': array([  8251, 188809, 813402, ...,    989,   1255,  59622])}
2018-06-28 20:32:03,007 - DEBUG - ml_utils.py:490 - C17C21
2018-06-28 20:32:03,007 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 20:32:03,007 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 20:32:03,007 - DEBUG - ml_utils.py:493 - (45006431, 8)
2018-06-28 20:32:46,643 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 20:32:46,922 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 20:32:46,922 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 20:32:48,630 - DEBUG - ml_utils.py:203 -           _key1  click
0            30      0
1            30      0
2            30      0
3            30      0
4            84      0
5            50      0
6           127      0
7           137      0
8            30      1
9           188      0
10           65      0
11           30      0
12           84      0
13           95      0
14          135      0
15           30      0
16           74      0
17           30      0
18          457      0
19          151      0
20          127      0
21           30      0
22          127      0
23           30      1
24           30      0
25          185      0
26          135      0
27          176      1
28          127      0
29           30      0
...         ...    ...
45006401    102      0
45006402    345      0
45006403     49      0
45006404    436      0
45006405    379      0
45006406    230      0
45006407    230      0
45006408    457      0
45006409    230      0
45006410    230      0
45006411    230      0
45006412    133      0
45006413    190      0
45006414    230      0
45006415    336      0
45006416     65      0
45006417    419      0
45006418     75      0
45006419    240      0
45006420    121      0
45006421     65      0
45006422    133      0
45006423    176      0
45006424    230      0
45006425    176      0
45006426     68      0
45006427    230      0
45006428     68      0
45006429    394      0
45006430    230      0

[45006431 rows x 2 columns]
2018-06-28 20:32:50,736 - DEBUG - ml_utils.py:212 - _key1
0         763
1          45
2        1246
3       13258
4          88
5       52787
6         208
7          66
8          61
9        1005
10       1552
11      32692
12       5291
13          0
14        248
15       5023
16       1541
17        171
18      16763
19        167
20         28
21          0
22      13286
23       4685
24       1204
25        459
26        293
27       4272
28         72
29       2448
        ...  
444         0
445         0
446         0
447         0
448         0
449         0
450      1126
451    236460
452     44870
453     21112
454     20837
455      2365
456      1892
457     23229
458     70771
459     15247
460      9031
461         0
462      2252
463     82406
464      8411
465      9231
466       252
467      2558
468         8
469       128
470       239
471      1446
472      9478
473       178
Name: click, Length: 474, dtype: int64
2018-06-28 20:32:50,738 - DEBUG - ml_utils.py:213 - _key1
0        3089
1         959
2        8968
3      131948
4         448
5      246629
6        1164
7         676
8        2009
9       13159
10      11868
11     235367
12      21877
13          3
14       1225
15      14299
16       8013
17       1338
18      60937
19       2260
20        120
21          1
22      46707
23      26007
24      13365
25       7148
26       2881
27       7213
28       1502
29      52314
        ...  
444     81228
445     17531
446     36402
447      3104
448     10356
449     22318
450     16510
451    978248
452    200194
453    102637
454    163820
455     14595
456     12694
457    123436
458    315976
459     81995
460     63135
461        36
462     11513
463    655947
464     61552
465     20765
466      1254
467     44890
468       145
469       810
470     18977
471     25138
472    128675
473      1653
Name: click, Length: 474, dtype: int64
2018-06-28 20:32:50,913 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 20:44:19,788 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 20:44:19,788 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 20:44:20,134 - DEBUG - ml_utils.py:234 - {'exp': array([1.85574477e-01, 1.85574477e-01, 1.85574477e-01, ...,
       3.61303001e-01, 4.42233629e-05, 1.32930508e-01]), 'cnt': array([4611516, 4611516, 4611516, ...,  664276,   34482, 1206158])}
2018-06-28 20:44:20,192 - DEBUG - ml_utils.py:490 - C17site_domain
2018-06-28 20:44:20,192 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 20:44:20,192 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 20:44:20,192 - DEBUG - ml_utils.py:493 - (45006431, 9)
2018-06-28 20:45:22,801 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 20:45:23,068 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 20:45:23,069 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 20:45:25,557 - DEBUG - ml_utils.py:203 -           _key1  click
0          3293      0
1          3293      0
2          3293      0
3          3293      0
4         16536      0
5          9781      0
6         24534      0
7         26705      0
8          3293      1
9         35212      0
10        13332      0
11         3293      0
12        16529      0
13        17923      0
14        26454      0
15         3293      0
16        15480      0
17         3293      0
18        74996      0
19        28060      0
20        25345      0
21         3293      0
22        25345      0
23         3293      1
24         3293      0
25        33500      0
26        26430      0
27        31732      1
28        25345      0
29         3293      0
...         ...    ...
45006401  20407      0
45006402  55080      0
45006403   8762      0
45006404  67729      0
45006405  60196      0
45006406  40445      0
45006407  40445      0
45006408  75186      0
45006409  40445      0
45006410  40445      0
45006411  40445      0
45006412  26281      0
45006413  35965      0
45006414  40445      0
45006415  54183      0
45006416  13332      0
45006417  64243      0
45006418  15676      0
45006419  43073      0
45006420  23642      0
45006421  13332      0
45006422  26281      0
45006423  31732      0
45006424  40445      0
45006425  31732      0
45006426  13341      0
45006427  40445      0
45006428  13341      0
45006429  61564      0
45006430  40445      0

[45006431 rows x 2 columns]
2018-06-28 20:45:29,028 - DEBUG - ml_utils.py:212 - _key1
0        1
1        1
2        0
3        0
4        1
5        6
6        1
7        0
8        0
9        0
10       1
11       1
12       0
13       0
14       2
15       0
16       1
17       0
18       1
19       1
20       1
21       1
22       1
23       0
24       1
25       1
26       0
27       0
28       0
29       8
        ..
79324    1
79325    0
79326    0
79327    1
79328    0
79329    0
79330    0
79331    0
79332    0
79333    0
79334    9
79335    0
79336    0
79337    0
79338    0
79339    0
79340    0
79341    0
79342    0
79343    1
79344    5
79345    0
79346    0
79347    0
79348    0
79349    1
79350    0
79351    2
79352    0
79353    0
Name: click, Length: 79354, dtype: int64
2018-06-28 20:45:29,030 - DEBUG - ml_utils.py:213 - _key1
0          1
1          2
2          2
3          2
4          9
5         52
6          3
7          2
8          1
9          1
10         1
11         1
12         1
13         5
14         5
15         1
16        14
17         2
18         8
19         1
20         4
21         2
22         4
23         1
24        28
25         3
26         1
27         6
28         1
29        34
        ... 
79324      1
79325      1
79326     18
79327      1
79328      1
79329      1
79330      1
79331      3
79332      1
79333      6
79334    143
79335      1
79336      2
79337      4
79338      1
79339      5
79340      1
79341     17
79342      1
79343      4
79344     19
79345     48
79346      1
79347      1
79348      5
79349      2
79350      1
79351      4
79352      1
79353      3
Name: click, Length: 79354, dtype: int64
2018-06-28 20:45:29,281 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 20:55:35,837 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 20:55:35,837 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 20:55:36,176 - DEBUG - ml_utils.py:234 - {'exp': array([1.98957994e-01, 1.98957994e-01, 1.98957994e-01, ...,
       3.62794912e-01, 4.42233629e-05, 1.31991635e-01]), 'cnt': array([3609830, 3609830, 3609830, ...,  655483,   34482, 1180887])}
2018-06-28 20:55:36,297 - DEBUG - ml_utils.py:490 - C21device_model
2018-06-28 20:55:36,297 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 20:55:36,298 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 20:55:36,298 - DEBUG - ml_utils.py:493 - (45006431, 10)
2018-06-28 20:56:32,901 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 20:56:33,182 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 20:56:33,182 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 20:56:35,688 - DEBUG - ml_utils.py:203 -           _key1  click
0         86486      0
1         87133      0
2         87522      0
3         86924      0
4         20564      0
5          8925      0
6         21729      0
7         43509      0
8         86846      1
9         40529      0
10        54663      0
11        89309      0
12        20756      0
13        64172      0
14        63563      0
15        87522      0
16        52207      0
17        88269      0
18        52523      0
19        75476      0
20        19413      0
21        89138      0
22        20185      0
23        87370      1
24        88579      0
25         9229      0
26        63188      0
27        76299      1
28        22188      0
29        89072      0
...         ...    ...
45006401  74559      0
45006402  37794      0
45006403    938      0
45006404  42395      0
45006405  41522      0
45006406  34357      0
45006407  36066      0
45006408  53283      0
45006409  37015      0
45006410  36900      0
45006411  34774      0
45006412  75346      0
45006413  75726      0
45006414  34390      0
45006415  35421      0
45006416  55571      0
45006417  13760      0
45006418  41240      0
45006419  44705      0
45006420  76154      0
45006421  55972      0
45006422  75346      0
45006423  75913      0
45006424  34354      0
45006425  75122      0
45006426  54553      0
45006427  37015      0
45006428  55419      0
45006429  83331      0
45006430  36066      0

[45006431 rows x 2 columns]
2018-06-28 20:56:39,560 - DEBUG - ml_utils.py:212 - _key1
0          0
1          0
2          0
3          0
4          2
5          0
6         19
7         20
8         11
9          3
10         1
11         8
12        10
13         0
14         2
15         0
16         3
17         0
18       197
19         4
20         3
21         0
22         0
23         2
24         2
25         0
26       386
27         5
28         0
29         0
        ... 
97527      0
97528     25
97529      2
97530      5
97531      1
97532      6
97533      0
97534     54
97535      0
97536      2
97537      0
97538      4
97539      3
97540      8
97541     13
97542     57
97543     13
97544      6
97545      0
97546    132
97547      0
97548    384
97549      2
97550      4
97551      9
97552     13
97553      0
97554    355
97555     16
97556      0
Name: click, Length: 97557, dtype: int64
2018-06-28 20:56:39,562 - DEBUG - ml_utils.py:213 - _key1
0           5
1           1
2           4
3           1
4           6
5           3
6         221
7         142
8         118
9          27
10         17
11        135
12         36
13          1
14          4
15          1
16         73
17          2
18       2007
19        122
20         18
21          4
22          1
23          6
24         41
25          9
26       3102
27        140
28          1
29          2
         ... 
97527      23
97528     199
97529      46
97530      11
97531      11
97532      21
97533       1
97534     386
97535       1
97536      61
97537       8
97538      39
97539      17
97540      81
97541      41
97542     427
97543     118
97544      35
97545       6
97546     864
97547      15
97548    3341
97549      30
97550      29
97551     115
97552      77
97553       5
97554    2104
97555     158
97556       2
Name: click, Length: 97557, dtype: int64
2018-06-28 20:56:39,748 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 21:06:53,556 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 21:06:53,556 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 21:06:53,900 - DEBUG - ml_utils.py:234 - {'exp': array([0.20427056, 0.20919538, 0.11798817, ..., 0.34146831, 0.01398826,
       0.12546307]), 'cnt': array([  8496, 189055, 836341, ...,   2677,  59506, 147161])}
2018-06-28 21:06:53,958 - DEBUG - ml_utils.py:490 - C21site_domain
2018-06-28 21:06:53,958 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 21:06:53,958 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 21:06:53,958 - DEBUG - ml_utils.py:493 - (45006431, 11)
2018-06-28 21:07:38,536 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 21:07:38,802 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 21:07:38,802 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 21:07:41,132 - DEBUG - ml_utils.py:203 -           _key1  click
0         35139      0
1         35139      0
2         35139      0
3         35139      0
4          6865      0
5          2476      0
6          6220      0
7         15428      0
8         35139      1
9         16905      0
10        23618      0
11        35139      0
12         6785      0
13        26541      0
14        26118      0
15        35139      0
16        21979      0
17        35139      0
18        20299      0
19        31091      0
20         7201      0
21        35139      0
22         7201      0
23        35139      1
24        35139      0
25         2547      0
26        26053      0
27        31091      1
28         7201      0
29        35139      0
...         ...    ...
45006401  31091      0
45006402  12874      0
45006403    226      0
45006404  17807      0
45006405  16905      0
45006406  13221      0
45006407  13221      0
45006408  22644      0
45006409  13221      0
45006410  13221      0
45006411  13221      0
45006412  31091      0
45006413  31091      0
45006414  13221      0
45006415  12874      0
45006416  23618      0
45006417   3878      0
45006418  16905      0
45006419  16905      0
45006420  31091      0
45006421  23618      0
45006422  31091      0
45006423  31091      0
45006424  13221      0
45006425  31091      0
45006426  23616      0
45006427  13221      0
45006428  23616      0
45006429  33567      0
45006430  13221      0

[45006431 rows x 2 columns]
2018-06-28 21:07:43,733 - DEBUG - ml_utils.py:212 - _key1
0          1
1          0
2          2
3          2
4          0
5          2
6          0
7          0
8          0
9          0
10         0
11         1
12         0
13         0
14         0
15         0
16         0
17         0
18         0
19         0
20         0
21         3
22         0
23         0
24         0
25         0
26         0
27         0
28         0
29         1
        ... 
39000      0
39001      1
39002      1
39003      0
39004      0
39005      0
39006      0
39007      0
39008      0
39009     51
39010      0
39011      2
39012      4
39013     12
39014      0
39015      0
39016      2
39017     13
39018      0
39019      1
39020      0
39021      0
39022      0
39023      1
39024    156
39025      1
39026      0
39027     15
39028      1
39029      0
Name: click, Length: 39030, dtype: int64
2018-06-28 21:07:43,734 - DEBUG - ml_utils.py:213 - _key1
0          4
1          1
2         70
3        135
4         21
5          2
6          2
7          1
8         26
9         11
10         6
11       187
12        29
13        14
14         3
15         1
16         3
17        21
18        14
19         1
20         5
21       127
22         1
23         1
24         2
25         1
26         1
27         1
28         2
29         5
        ... 
39000      4
39001      1
39002      7
39003      1
39004      1
39005      1
39006     58
39007      3
39008      1
39009    628
39010      1
39011      2
39012      7
39013    134
39014      1
39015      1
39016      3
39017     29
39018     11
39019      2
39020      1
39021      1
39022      1
39023      4
39024    512
39025      2
39026      1
39027    205
39028     27
39029      1
Name: click, Length: 39030, dtype: int64
2018-06-28 21:07:43,924 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 21:18:35,426 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 21:18:35,426 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 21:18:35,770 - DEBUG - ml_utils.py:234 - {'exp': array([0.19880926, 0.19880926, 0.19880926, ..., 0.38996688, 0.02663984,
       0.15641745]), 'cnt': array([3618798, 3618798, 3618798, ...,  954157, 2192515, 2137223])}
2018-06-28 21:18:35,887 - DEBUG - ml_utils.py:490 - site_domaindevice_model
2018-06-28 21:18:35,887 - DEBUG - ml_utils.py:491 - (45006431, 1)
2018-06-28 21:18:35,887 - DEBUG - ml_utils.py:492 - (45006431, 1)
2018-06-28 21:18:35,888 - DEBUG - ml_utils.py:493 - (45006431, 12)
2018-06-28 21:19:23,523 - DEBUG - ml_utils.py:499 - (45006431,)
2018-06-28 21:19:23,791 - DEBUG - ml_utils.py:194 - 0.15253522324398483
2018-06-28 21:19:23,792 - DEBUG - ml_utils.py:199 - [ True  True  True ...  True  True  True]
2018-06-28 21:19:27,404 - DEBUG - ml_utils.py:203 -            _key1  click
0         357762      0
1         358221      0
2         358495      0
3         358083      0
4         189410      0
5         267524      0
6          12119      0
7         159386      0
8         358026      1
9         282778      0
10        158786      0
11        359824      0
12        169729      0
13        267084      0
14        286594      0
15        358495      0
16        207594      0
17        359042      0
18         15931      0
19        286866      0
20        291817      0
21        359694      0
22        292033      0
23        358383      1
24        359276      0
25        286249      0
26        158296      0
27        288802      1
28        292588      0
29        359643      0
...          ...    ...
45006401  284731      0
45006402  289533      0
45006403  282839      0
45006404  355163      0
45006405  284236      0
45006406  357654      0
45006407  358728      0
45006408  289314      0
45006409  359335      0
45006410  359265      0
45006411  357922      0
45006412  286594      0
45006413  287411      0
45006414  357672      0
45006415  285017      0
45006416  159827      0
45006417   96892      0
45006418  283820      0
45006419  288902      0
45006420  288414      0
45006421  160276      0
45006422  286594      0
45006423  287804      0
45006424  357653      0
45006425  286078      0
45006426  143338      0
45006427  359335      0
45006428  144346      0
45006429  282632      0
45006430  358728      0

[45006431 rows x 2 columns]
2018-06-28 21:19:33,447 - DEBUG - ml_utils.py:212 - _key1
0         0
1         0
2         0
3         0
4         0
5         0
6         0
7         1
8         0
9         0
10        0
11        0
12        0
13        1
14        0
15        0
16        0
17        0
18        4
19        0
20        0
21        0
22        0
23        0
24        0
25        2
26        0
27        2
28        1
29        0
         ..
387205    0
387206    0
387207    0
387208    0
387209    1
387210    0
387211    0
387212    0
387213    0
387214    0
387215    0
387216    1
387217    0
387218    2
387219    0
387220    0
387221    0
387222    1
387223    0
387224    0
387225    0
387226    0
387227    0
387228    0
387229    3
387230    0
387231    0
387232    0
387233    0
387234    0
Name: click, Length: 387235, dtype: int64
2018-06-28 21:19:33,448 - DEBUG - ml_utils.py:213 - _key1
0          2
1          1
2          1
3          6
4          3
5          1
6          2
7          1
8          1
9          1
10         3
11         2
12         1
13         1
14         1
15         1
16         2
17         2
18         6
19         1
20         1
21         1
22         1
23         2
24         1
25         4
26         1
27         6
28         5
29         1
          ..
387205     1
387206     2
387207     6
387208     2
387209     2
387210     1
387211     3
387212     5
387213    11
387214     1
387215     1
387216    11
387217     4
387218     8
387219     1
387220     1
387221     1
387222     3
387223     2
387224     3
387225     2
387226     3
387227     7
387228     1
387229    13
387230     5
387231    17
387232     3
387233     1
387234     1
Name: click, Length: 387235, dtype: int64
2018-06-28 21:19:33,704 - DEBUG - ml_utils.py:220 - (45006431,)
2018-06-28 21:30:00,877 - DEBUG - ml_utils.py:224 - (45006431,)
2018-06-28 21:30:00,878 - DEBUG - ml_utils.py:225 - (45006431,)
2018-06-28 21:30:01,220 - DEBUG - ml_utils.py:234 - {'exp': array([0.19944088, 0.17387313, 0.11967506, ..., 0.34825252, 0.01409663,
       0.15977715]), 'cnt': array([  10497,  380023, 1029574, ...,    1120,   63092,  225764])}
2018-06-28 21:36:27,640 - DEBUG - ml_utils.py:510 - ['/data/one_day.joblib_dat']
2018-06-28 21:37:02,701 - DEBUG - ml_utils.py:527 - C14C17
2018-06-28 21:37:03,245 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:37:03,245 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:37:05,876 - DEBUG - ml_utils.py:527 - C14device_model
2018-06-28 21:37:06,418 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:37:06,418 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:37:14,094 - DEBUG - ml_utils.py:527 - C14C21
2018-06-28 21:37:14,639 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:37:14,639 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:37:22,987 - DEBUG - ml_utils.py:527 - C14site_domain
2018-06-28 21:37:23,552 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:37:23,552 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:37:38,566 - DEBUG - ml_utils.py:527 - C17device_model
2018-06-28 21:37:39,111 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:37:39,111 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:38:15,721 - DEBUG - ml_utils.py:527 - C17C21
2018-06-28 21:38:17,482 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:38:17,482 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:38:42,056 - DEBUG - ml_utils.py:527 - C17site_domain
2018-06-28 21:38:44,215 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:38:44,216 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:39:02,983 - DEBUG - ml_utils.py:527 - C21device_model
2018-06-28 21:39:05,242 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:39:05,242 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:39:40,221 - DEBUG - ml_utils.py:527 - C21site_domain
2018-06-28 21:39:40,764 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:39:40,764 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
2018-06-28 21:40:32,785 - DEBUG - ml_utils.py:527 - site_domaindevice_model
2018-06-28 21:40:33,326 - DEBUG - ml_utils.py:534 - (45006431,)
2018-06-28 21:40:33,326 - DEBUG - ml_utils.py:535 - [ True  True  True ...  True  True  True]
/home/zhijiehuang/github/data/train.csv
1
1
1
1
1
1
1
1
1
1
