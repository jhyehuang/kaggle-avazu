2018-07-10 16:22:30,161 - DEBUG - ffm.py:48 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 16:22:30,161 - DEBUG - ffm.py:50 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 7.81 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.38 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461877            0.456102            0.830113               19.95
[32m[ [0m  20%[32m      ][0m     2            0.457680            0.455521            0.830113               19.40
[32m[ [0m  30%[32m      ][0m     3            0.456009            0.457497            0.830113               19.29
[32m[ [0m  40%[32m      ][0m     4            0.455999            0.455952            0.830113               19.67
[32m[ [0m  50%[32m      ][0m     5            0.455962            0.455940            0.830113               19.84
[32m[ [0m  60%[32m      ][0m     6            0.455907            0.455896            0.830113               19.76
[32m[ [0m  70%[32m      ][0m     7            0.455923            0.455988            0.830113               19.22
[32m[ [0m  80%[32m      ][0m     8            0.455958            0.455936            0.830113               19.18
[32m[ [0m  90%[32m      ][0m     9            0.455947            0.455920            0.830113               19.54
[32m[ [0m 100%[32m      ][0m    10            0.455921            0.455909            0.830113               19.68
[32m[1m[ ACTION     ] Early-stopping at epoch 2[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.76 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 207.19 (sec)[0m
2018-07-10 16:25:57,352 - DEBUG - ffm.py:56 - to save validation predictions ...
Traceback (most recent call last):
  File "ffm.py", line 86, in <module>
    done()
  File "ffm.py", line 59, in done
    logging.debug(ffm_model.weights)        
AttributeError: 'XLearn' object has no attribute 'weights'
2018-07-10 16:27:24,793 - DEBUG - ffm.py:48 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 16:27:24,794 - DEBUG - ffm.py:50 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 7.77 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.39 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461918            0.456093            0.830113               20.22
[32m[ [0m  20%[32m      ][0m     2            0.457637            0.455220            0.830113               19.59
[32m[ [0m  30%[32m      ][0m     3            0.456074            0.457454            0.830113               19.38
[32m[ [0m  40%[32m      ][0m     4            0.455995            0.455985            0.830113               19.09
[32m[ [0m  50%[32m      ][0m     5            0.455966            0.455933            0.830113               19.20
[32m[ [0m  60%[32m      ][0m     6            0.455910            0.455954            0.830113               19.36
[32m[ [0m  70%[32m      ][0m     7            0.455924            0.455994            0.830113               19.22
[32m[1m[ ACTION     ] Early-stopping at epoch 2[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.63 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 147.57 (sec)[0m
2018-07-10 16:29:52,361 - DEBUG - ffm.py:56 - to save validation predictions ...
Traceback (most recent call last):
  File "ffm.py", line 86, in <module>
    done()
  File "ffm.py", line 59, in done
    logging.debug(ffm_model.weights)        
AttributeError: 'XLearn' object has no attribute 'weights'
2018-07-10 16:31:26,375 - DEBUG - ffm.py:48 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 16:31:26,375 - DEBUG - ffm.py:50 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 7.84 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.39 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461914            0.456097            0.830113               20.34
[32m[ [0m  20%[32m      ][0m     2            0.457586            0.454995            0.830113               19.38
[32m[ [0m  30%[32m      ][0m     3            0.456088            0.457436            0.830113               19.80
[32m[ [0m  40%[32m      ][0m     4            0.455994            0.455999            0.830113               20.36
[32m[ [0m  50%[32m      ][0m     5            0.455968            0.455905            0.830113               19.32
[32m[ [0m  60%[32m      ][0m     6            0.455908            0.455898            0.830113               19.26
[32m[ [0m  70%[32m      ][0m     7            0.455921            0.455975            0.830113               19.19
[32m[ [0m  80%[32m      ][0m     8            0.455958            0.455929            0.830113               19.31
[32m[ [0m  90%[32m      ][0m     9            0.455946            0.455938            0.830113               19.49
[32m[ [0m 100%[32m      ][0m    10            0.455918            0.455927            0.830113               19.54
[32m[1m[ ACTION     ] Early-stopping at epoch 2[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.86 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 207.78 (sec)[0m
2018-07-10 16:34:54,156 - DEBUG - ffm.py:56 - to save validation predictions ...
2018-07-10 16:34:54,156 - DEBUG - ffm.py:59 - <xlearn.xlearn.XLearn object at 0x7f7085060f98>
2018-07-10 16:34:54,156 - DEBUG - ffm.py:48 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 16:34:54,156 - DEBUG - ffm.py:67 - È¢ÑÊµã
Traceback (most recent call last):
  File "ffm.py", line 87, in <module>
    done(False)
  File "ffm.py", line 68, in done
    ffm_model.setTest(test_save)  # Test data
UnboundLocalError: local variable 'ffm_model' referenced before assignment
2018-07-10 16:36:43,711 - DEBUG - ffm.py:49 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 16:36:43,711 - DEBUG - ffm.py:51 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 7.83 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.39 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461913            0.456093            0.830113               19.82
[32m[ [0m  20%[32m      ][0m     2            0.457663            0.455575            0.830113               19.41
[32m[ [0m  30%[32m      ][0m     3            0.456050            0.457486            0.830113               20.07
[32m[ [0m  40%[32m      ][0m     4            0.455993            0.456010            0.830113               19.53
[32m[ [0m  50%[32m      ][0m     5            0.455965            0.455926            0.830113               19.33
[32m[ [0m  60%[32m      ][0m     6            0.455911            0.455918            0.830113               19.61
[32m[ [0m  70%[32m      ][0m     7            0.455919            0.455986            0.830113               19.44
[32m[ [0m  80%[32m      ][0m     8            0.455958            0.455953            0.830113               19.86
[32m[ [0m  90%[32m      ][0m     9            0.455947            0.455932            0.830113               19.56
[32m[ [0m 100%[32m      ][0m    10            0.455917            0.455921            0.830113               19.54
[32m[1m[ ACTION     ] Early-stopping at epoch 2[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.59 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 207.71 (sec)[0m
2018-07-10 16:40:11,422 - DEBUG - ffm.py:56 - to save validation predictions ...
2018-07-10 16:40:11,422 - DEBUG - ffm.py:59 - <xlearn.xlearn.XLearn object at 0x7f5a6833a630>
2018-07-10 16:40:11,422 - DEBUG - ffm.py:49 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 16:40:11,422 - DEBUG - ffm.py:67 - È¢ÑÊµã
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.25 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mTime cost for reading problem: 14.87 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.195368
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 17.93 (sec)[0m
2018-07-10 16:40:29,354 - DEBUG - ffm.py:73 - <xlearn.xlearn.XLearn object at 0x7f5a6833a630>
2018-07-10 17:02:33,619 - DEBUG - ffm.py:49 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:02:33,620 - DEBUG - ffm.py:67 - È¢ÑÊµã
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.24 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.53 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.195368
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 4.61 (sec)[0m
2018-07-10 17:02:38,454 - DEBUG - ffm.py:74 - <xlearn.xlearn.XLearn object at 0x7fe67725b7f0>
2018-07-10 17:02:41,581 - DEBUG - ffm.py:76 - ------------------------------
2018-07-10 17:02:41,696 - DEBUG - ffm.py:78 - (4577464, 1)
2018-07-10 17:02:42,499 - DEBUG - ffm.py:80 - (4577464,)
2018-07-10 17:03:14,898 - DEBUG - ffm.py:49 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:03:14,898 - DEBUG - ffm.py:51 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 42.63 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.39 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461901            0.458376            0.830169               23.09
[32m[ [0m  20%[32m      ][0m     2            0.457713            0.454336            0.830169               22.06
[32m[ [0m  30%[32m      ][0m     3            0.455989            0.454291            0.830169               21.60
[32m[ [0m  40%[32m      ][0m     4            0.456006            0.458978            0.830169               21.75
[32m[ [0m  50%[32m      ][0m     5            0.455970            0.458939            0.830169               21.99
[32m[ [0m  60%[32m      ][0m     6            0.455919            0.458937            0.830169               22.14
[32m[ [0m  70%[32m      ][0m     7            0.455916            0.458820            0.830169               21.98
[32m[ [0m  80%[32m      ][0m     8            0.455964            0.458833            0.830169               22.01
[32m[ [0m  90%[32m      ][0m     9            0.455949            0.458777            0.830169               22.86
[32m[ [0m 100%[32m      ][0m    10            0.455924            0.458776            0.830169               22.46
[32m[1m[ ACTION     ] Early-stopping at epoch 3[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.67 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 268.48 (sec)[0m
2018-07-10 17:07:43,378 - DEBUG - ffm.py:56 - to save validation predictions ...
2018-07-10 17:07:43,378 - DEBUG - ffm.py:59 - <xlearn.xlearn.XLearn object at 0x7f9b6f462160>
2018-07-10 17:07:43,378 - DEBUG - ffm.py:49 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:07:43,378 - DEBUG - ffm.py:67 - È¢ÑÊµã
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.25 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.53 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.200086
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 4.58 (sec)[0m
2018-07-10 17:07:48,153 - DEBUG - ffm.py:74 - <xlearn.xlearn.XLearn object at 0x7f9b6f462160>
2018-07-10 17:07:51,266 - DEBUG - ffm.py:76 - ------------------------------
2018-07-10 17:07:51,380 - DEBUG - ffm.py:78 - (4577464, 1)
2018-07-10 17:07:52,240 - DEBUG - ffm.py:80 - (4577464,)
2018-07-10 17:27:41,069 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:27:41,069 - DEBUG - ffm.py:54 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 12.39 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 448.12 MB
[32m[------------] [0mTime cost for model initial: 0.33 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.456969            0.456387            0.830169               13.04
[32m[ [0m  20%[32m      ][0m     2            0.453968            0.456804            0.830169               13.00
[32m[ [0m  30%[32m      ][0m     3            0.452355            0.457364            0.830169               13.22
[32m[1m[ ACTION     ] Early-stopping at epoch 1[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 1.60 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 53.97 (sec)[0m
2018-07-10 17:28:35,041 - DEBUG - ffm.py:59 - to save validation predictions ...
2018-07-10 17:28:35,041 - DEBUG - ffm.py:62 - <xlearn.xlearn.XLearn object at 0x7fe2684277f0>
2018-07-10 17:28:35,041 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:28:35,041 - DEBUG - ffm.py:70 - È¢ÑÊµã
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.17 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.53 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.191189
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 4.32 (sec)[0m
2018-07-10 17:28:39,561 - DEBUG - ffm.py:77 - <xlearn.xlearn.XLearn object at 0x7fe2684277f0>
2018-07-10 17:28:42,746 - DEBUG - ffm.py:79 - ------------------------------
2018-07-10 17:28:42,860 - DEBUG - ffm.py:81 - (4577464, 1)
2018-07-10 17:28:43,709 - DEBUG - ffm.py:83 - (4577464,)
2018-07-10 17:31:35,668 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:31:35,668 - DEBUG - ffm.py:54 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 12.39 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 448.12 MB
[32m[------------] [0mTime cost for model initial: 0.33 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.456270            0.455969            0.830169               13.35
[32m[ [0m  20%[32m      ][0m     2            0.455733            0.455697            0.830169               13.65
[32m[ [0m  30%[32m      ][0m     3            0.455473            0.455570            0.830169               13.09
[32m[ [0m  40%[32m      ][0m     4            0.455273            0.455463            0.830169               13.35
[32m[ [0m  50%[32m      ][0m     5            0.455110            0.455418            0.830169               13.13
[32m[ [0m  60%[32m      ][0m     6            0.454983            0.455459            0.830169               13.18
[32m[ [0m  70%[32m      ][0m     7            0.454860            0.455453            0.830169               13.19
[32m[ [0m  80%[32m      ][0m     8            0.454759            0.455667            0.830169               13.33
[32m[ [0m  90%[32m      ][0m     9            0.454634            0.455481            0.830169               13.86
[32m[ [0m 100%[32m      ][0m    10            0.454547            0.455507            0.830169               13.16
[32m[1m[ ACTION     ] Early-stopping at epoch 5[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 1.15 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 147.92 (sec)[0m
2018-07-10 17:34:03,586 - DEBUG - ffm.py:59 - to save validation predictions ...
2018-07-10 17:34:03,586 - DEBUG - ffm.py:62 - <xlearn.xlearn.XLearn object at 0x7f16ed7f5198>
2018-07-10 17:34:03,586 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:34:03,586 - DEBUG - ffm.py:70 - È¢ÑÊµã
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.17 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.54 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.211198
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 4.29 (sec)[0m
2018-07-10 17:34:08,068 - DEBUG - ffm.py:77 - <xlearn.xlearn.XLearn object at 0x7f16ed7f5198>
2018-07-10 17:34:11,194 - DEBUG - ffm.py:79 - ------------------------------
2018-07-10 17:34:11,308 - DEBUG - ffm.py:81 - (4577464, 1)
2018-07-10 17:34:12,157 - DEBUG - ffm.py:83 - (4577464,)
2018-07-10 17:39:03,714 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:39:03,714 - DEBUG - ffm.py:54 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 12.52 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 224.06 MB
[32m[------------] [0mTime cost for model initial: 0.28 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.456753            0.456115            0.830169                9.11
[32m[ [0m  20%[32m      ][0m     2            0.456370            0.457408            0.830169                9.22
[32m[ [0m  30%[32m      ][0m     3            0.456114            0.457980            0.830169                9.39
[32m[ [0m  40%[32m      ][0m     4            0.455882            0.456292            0.830169                9.03
[32m[ [0m  50%[32m      ][0m     5            0.455656            0.456041            0.830169                9.34
[32m[ [0m  60%[32m      ][0m     6            0.455471            0.456050            0.830169                9.08
[32m[ [0m  70%[32m      ][0m     7            0.455310            0.456258            0.830169                8.95
[32m[ [0m  80%[32m      ][0m     8            0.455148            0.456696            0.830169                9.08
[32m[ [0m  90%[32m      ][0m     9            0.454996            0.456233            0.830169                9.14
[32m[ [0m 100%[32m      ][0m    10            0.454859            0.457565            0.830169                9.08
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 0.30 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 104.56 (sec)[0m
2018-07-10 17:40:48,278 - DEBUG - ffm.py:60 - to save validation predictions ...
2018-07-10 17:40:48,278 - DEBUG - ffm.py:63 - <xlearn.xlearn.XLearn object at 0x7fb539854160>
2018-07-10 17:40:48,278 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 17:40:48,278 - DEBUG - ffm.py:71 - È¢ÑÊµã
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.09 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.53 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.170833
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 3.86 (sec)[0m
2018-07-10 17:40:52,333 - DEBUG - ffm.py:78 - <xlearn.xlearn.XLearn object at 0x7fb539854160>
2018-07-10 17:40:55,479 - DEBUG - ffm.py:80 - ------------------------------
2018-07-10 17:40:55,592 - DEBUG - ffm.py:82 - (4577464, 1)
2018-07-10 17:40:56,441 - DEBUG - ffm.py:84 - (4577464,)
2018-07-10 20:49:00,916 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-10 20:49:00,916 - DEBUG - ffm.py:54 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 37300011
[32m[------------] [0mNumber of Field: 100
[32m[------------] [0mTime cost for reading problem: 116.01 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
2018-07-16 11:43:02,893 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-16 11:43:02,894 - DEBUG - ffm.py:54 - ÂºÄÂßãËÆ≠ÁªÉ
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 59
[32m[------------] [0mNumber of Field: 40
[32m[------------] [0mTime cost for reading problem: 18.77 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 111.32 KB
[32m[------------] [0mTime cost for model initial: 0.00 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.047103            0.415788               68.16
[32m[ [0m  20%[32m      ][0m     2            0.015732            0.415788               68.55
[32m[ [0m  30%[32m      ][0m     3            0.015732            0.415788               68.81
[32m[ [0m  40%[32m      ][0m     4            0.015732            0.415788               68.30
[32m[ [0m  50%[32m      ][0m     5            0.015732            0.415788               68.09
[32m[ [0m  60%[32m      ][0m     6            0.015732            0.415788               68.37
[32m[ [0m  70%[32m      ][0m     7            0.015732            0.415788               68.40
[32m[ [0m  80%[32m      ][0m     8            0.015732            0.415788               68.35
[32m[ [0m  90%[32m      ][0m     9            0.015732            0.415788               67.99
[32m[ [0m 100%[32m      ][0m    10            0.015732            0.415788               68.22
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 0.00 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 702.05 (sec)[0m
2018-07-16 11:54:44,941 - DEBUG - ffm.py:60 - to save validation predictions ...
2018-07-16 11:54:44,941 - DEBUG - ffm.py:64 - <xlearn.xlearn.XLearn object at 0x7f14eb7e23c8>
2018-07-16 11:54:44,941 - DEBUG - ffm.py:52 - ËÆæÁΩÆÂèÇÊï∞
2018-07-16 11:54:44,941 - DEBUG - ffm.py:79 - È¢ÑÊµã
Info: 
 Model: ffm
 Loss: cross-entropy
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 59
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 40
[32m[------------] [0mTime cost for loading model: 0.00 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 4.68 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.015749
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 7.50 (sec)[0m
2018-07-16 11:54:52,657 - DEBUG - ffm.py:86 - <xlearn.xlearn.XLearn object at 0x7f14eb7e23c8>
2018-07-16 11:54:55,668 - DEBUG - ffm.py:88 - ------------------------------
2018-07-16 11:54:55,783 - DEBUG - ffm.py:90 - (4577464, 1)
2018-07-16 11:54:56,640 - DEBUG - ffm.py:92 - (4577464,)
Info: 
 Model: ffm
 Loss: cross-entropy
2018-07-16 14:03:08,307 - DEBUG - lgbm.py:36 - ËÆæÁΩÆÂèÇÊï∞
2018-07-16 14:03:08,307 - DEBUG - lgbm.py:326 - ËÆæÁΩÆÂèÇÊï∞
2018-07-16 14:03:13,281 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 13)
2018-07-16 14:03:13,281 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 5)
2018-07-16 14:03:13,696 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 18)
2018-07-16 14:03:13,696 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂0.41498470306396484
2018-07-16 14:03:36,589 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 18)
2018-07-16 14:03:36,589 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 57)
2018-07-16 14:03:38,370 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 75)
2018-07-16 14:03:38,370 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂1.7805366516113281
2018-07-16 14:04:16,783 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 75)
2018-07-16 14:04:16,783 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 79)
2018-07-16 14:04:24,104 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 154)
2018-07-16 14:04:24,105 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂7.3213043212890625
2018-07-16 14:06:11,463 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 154)
2018-07-16 14:06:11,464 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 156)
2018-07-16 14:06:26,344 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 310)
2018-07-16 14:06:26,344 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂14.880600929260254
2018-07-16 14:06:36,909 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 310)
2018-07-16 14:06:36,909 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 40)
2018-07-16 14:06:44,510 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 350)
2018-07-16 14:06:44,510 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂7.601315259933472
2018-07-16 14:06:44,809 - DEBUG - data_preprocessing.py:629 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'xgb_basis30', 'xgb_basis31', 'xgb_basis32', 'xgb_basis33',
       'xgb_basis34', 'xgb_basis35', 'xgb_basis36', 'xgb_basis37',
       'xgb_basis38', 'xgb_basis39'],
      dtype='object', length=350)
2018-07-16 14:06:44,810 - DEBUG - data_preprocessing.py:633 - (5320904, 350)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-16 14:07:49,733 - DEBUG - data_preprocessing.py:647 -            C1    C14   C17  C21  device_conn_type  device_ip  device_model  \
2909117  1005  20363  2333  157                 0    1808376          5075   

         device_type  app_or_web  app_site_id     ...       xgb_basis30  \
2909117            1           1         9513     ...              1208   

         xgb_basis31  xgb_basis32  xgb_basis33  xgb_basis34  xgb_basis35  \
2909117         1255         1317         1374         1414         1473   

         xgb_basis36  xgb_basis37  xgb_basis38  xgb_basis39  
2909117         1504         1540         1595         1641  

[1 rows x 349 columns]
2018-07-16 14:07:49,841 - DEBUG - data_preprocessing.py:648 - 2909117    0
Name: click, dtype: int64
2018-07-16 14:07:49,853 - DEBUG - lgbm.py:331 - CV:x
2018-07-16 14:07:49,854 - DEBUG - lgbm.py:84 - ‰∫§ÂèâÈ™åËØÅ
2018-07-16 14:07:49,854 - DEBUG - lgbm.py:314 - {'boosting_type': 'gbdt', 'objective': 'binary', 'metric': ['auc', 'binary_logloss'], 'device': 'gpu', 'gpu_platform_id': -1, 'gpu_device_id': -1, 'num_trees': 300}
2018-07-16 14:07:49,872 - DEBUG - lgbm.py:334 - ÂºÄÂßãËÆ≠ÁªÉ
[LightGBM] [Info] Number of positive: 462785, number of negative: 4326028
[LightGBM] [Info] This is the GPU trainer!!
[LightGBM] [Info] Total Bins 61800
[LightGBM] [Info] Number of data: 4788813, number of used features: 348
[LightGBM] [Info] Using GPU Device: GeForce GTX 1070 Ti, Vendor: NVIDIA Corporation
[LightGBM] [Info] Compiling OpenCL Kernel with 256 bins...
[LightGBM] [Info] GPU programs have been built
[LightGBM] [Info] Size of histogram bin entry: 12
[LightGBM] [Info] 346 dense feature groups (1589.30 MB) transfered to GPU in 0.952937 secs. 1 sparse feature groups
[LightGBM] [Info] [binary:BoostFromScore]: pavg=0.096639 -> initscore=-2.235142
[LightGBM] [Info] Start training from score -2.235142
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/engine.py:102: UserWarning: Found `num_trees` in params. Will use it instead of argument
  warnings.warn("Found `{}` in params. Will use it instead of argument".format(alias))
2018-07-16 14:13:17,067 - DEBUG - lgbm.py:350 - to save validation predictions ...
2018-07-16 14:13:17,099 - DEBUG - lgbm.py:352 - ['/data/1-100-lgbm.model.joblib_dat']
2018-07-16 14:13:17,099 - DEBUG - lgbm.py:357 - È™åËØÅ
2018-07-16 14:13:20,162 - DEBUG - lgbm.py:360 - log_loss:
2018-07-16 14:13:20,397 - DEBUG - lgbm.py:361 - 0.29826305369206624
2018-07-16 14:13:25,270 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 13)
2018-07-16 14:13:25,270 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 5)
2018-07-16 14:13:25,514 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 18)
2018-07-16 14:13:25,514 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂0.24385499954223633
2018-07-16 14:13:44,647 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 18)
2018-07-16 14:13:44,647 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 57)
2018-07-16 14:13:46,411 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 75)
2018-07-16 14:13:46,411 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂1.7641353607177734
2018-07-16 14:14:22,761 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 75)
2018-07-16 14:14:22,761 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 79)
2018-07-16 14:14:28,943 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 154)
2018-07-16 14:14:28,943 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂6.181918382644653
2018-07-16 14:16:17,228 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 154)
2018-07-16 14:16:17,228 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 156)
2018-07-16 14:16:32,018 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 310)
2018-07-16 14:16:32,018 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂14.790148496627808
2018-07-16 14:16:42,803 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 310)
2018-07-16 14:16:42,803 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 40)
2018-07-16 14:16:50,355 - DEBUG - data_preprocessing.py:235 - ÁªìÊûú.shape:(5320904, 350)
2018-07-16 14:16:50,355 - DEBUG - data_preprocessing.py:236 - ËÄóÊó∂7.552399396896362
2018-07-16 14:16:50,666 - DEBUG - data_preprocessing.py:629 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'xgb_basis30', 'xgb_basis31', 'xgb_basis32', 'xgb_basis33',
       'xgb_basis34', 'xgb_basis35', 'xgb_basis36', 'xgb_basis37',
       'xgb_basis38', 'xgb_basis39'],
      dtype='object', length=350)
2018-07-16 14:16:50,674 - DEBUG - data_preprocessing.py:633 - (5320904, 350)
2018-07-16 14:18:48,640 - DEBUG - data_preprocessing.py:647 -            C1    C14   C17  C21  device_conn_type  device_ip  device_model  \
2909117  1005  19950  1800   23                 0    1101276          4352   

         device_type  app_or_web  app_site_id     ...       xgb_basis30  \
2909117            1           1         8019     ...              1168   

         xgb_basis31  xgb_basis32  xgb_basis33  xgb_basis34  xgb_basis35  \
2909117         1218         1260         1310         1336         1396   

         xgb_basis36  xgb_basis37  xgb_basis38  xgb_basis39  
2909117         1426         1479         1540         1594  

[1 rows x 349 columns]
2018-07-16 14:18:48,663 - DEBUG - data_preprocessing.py:648 - 2909117    0
Name: click, dtype: int64
2018-07-16 14:18:48,669 - DEBUG - lgbm.py:331 - CV:x
2018-07-16 14:18:48,669 - DEBUG - lgbm.py:84 - ‰∫§ÂèâÈ™åËØÅ
2018-07-16 14:18:48,670 - DEBUG - lgbm.py:314 - {'boosting_type': 'gbdt', 'objective': 'binary', 'metric': ['auc', 'binary_logloss'], 'device': 'gpu', 'gpu_platform_id': -1, 'gpu_device_id': -1, 'verbose': 1}
2018-07-16 14:18:48,677 - DEBUG - lgbm.py:334 - ÂºÄÂßãËÆ≠ÁªÉ
(5320904, 350)
[1]	valid_0's binary_logloss: 0.305221	valid_0's auc: 0.83433
Training until validation scores don't improve for 60 rounds.
[2]	valid_0's binary_logloss: 0.307572	valid_0's auc: 0.835704
[3]	valid_0's binary_logloss: 0.296694	valid_0's auc: 0.836082
[4]	valid_0's binary_logloss: 0.296965	valid_0's auc: 0.837504
[5]	valid_0's binary_logloss: 0.299931	valid_0's auc: 0.839181
[6]	valid_0's binary_logloss: 0.302372	valid_0's auc: 0.838995
[7]	valid_0's binary_logloss: 0.299193	valid_0's auc: 0.839101
[8]	valid_0's binary_logloss: 0.300296	valid_0's auc: 0.838783
[9]	valid_0's binary_logloss: 0.300541	valid_0's auc: 0.838621
[10]	valid_0's binary_logloss: 0.295068	valid_0's auc: 0.838552
[11]	valid_0's binary_logloss: 0.29531	valid_0's auc: 0.838953
[12]	valid_0's binary_logloss: 0.298262	valid_0's auc: 0.839261
[13]	valid_0's binary_logloss: 0.294838	valid_0's auc: 0.838648
[14]	valid_0's binary_logloss: 0.302886	valid_0's auc: 0.839066
[15]	valid_0's binary_logloss: 0.289669	valid_0's auc: 0.838337
[16]	valid_0's binary_logloss: 0.300245	valid_0's auc: 0.83807
[17]	valid_0's binary_logloss: 0.29079	valid_0's auc: 0.837394
[18]	valid_0's binary_logloss: 0.295387	valid_0's auc: 0.837348
[19]	valid_0's binary_logloss: 0.302348	valid_0's auc: 0.837605
[20]	valid_0's binary_logloss: 0.297038	valid_0's auc: 0.837084
[21]	valid_0's binary_logloss: 0.294642	valid_0's auc: 0.83725
[22]	valid_0's binary_logloss: 0.294022	valid_0's auc: 0.836387
[23]	valid_0's binary_logloss: 0.298091	valid_0's auc: 0.836586
[24]	valid_0's binary_logloss: 0.291524	valid_0's auc: 0.836443
[25]	valid_0's binary_logloss: 0.302673	valid_0's auc: 0.836507
[26]	valid_0's binary_logloss: 0.3091	valid_0's auc: 0.836372
[27]	valid_0's binary_logloss: 0.298172	valid_0's auc: 0.836029
[28]	valid_0's binary_logloss: 0.304688	valid_0's auc: 0.836334
[29]	valid_0's binary_logloss: 0.294956	valid_0's auc: 0.836281
[30]	valid_0's binary_logloss: 0.309723	valid_0's auc: 0.83623
[31]	valid_0's binary_logloss: 0.293517	valid_0's auc: 0.835998
[32]	valid_0's binary_logloss: 0.294362	valid_0's auc: 0.835451
[33]	valid_0's binary_logloss: 0.299314	valid_0's auc: 0.836432
[34]	valid_0's binary_logloss: 0.328229	valid_0's auc: 0.835821
[35]	valid_0's binary_logloss: 0.306391	valid_0's auc: 0.835618
[36]	valid_0's binary_logloss: 0.30242	valid_0's auc: 0.834939
[37]	valid_0's binary_logloss: 0.300354	valid_0's auc: 0.835228
[38]	valid_0's binary_logloss: 0.324491	valid_0's auc: 0.83492
[39]	valid_0's binary_logloss: 0.304302	valid_0's auc: 0.833871
[40]	valid_0's binary_logloss: 0.309267	valid_0's auc: 0.833986
[41]	valid_0's binary_logloss: 0.323394	valid_0's auc: 0.834673
[42]	valid_0's binary_logloss: 0.316604	valid_0's auc: 0.834323
[43]	valid_0's binary_logloss: 0.323465	valid_0's auc: 0.83432
[44]	valid_0's binary_logloss: 0.32642	valid_0's auc: 0.834143
[45]	valid_0's binary_logloss: 0.315528	valid_0's auc: 0.833443
[46]	valid_0's binary_logloss: 0.34102	valid_0's auc: 0.833323
[47]	valid_0's binary_logloss: 0.313816	valid_0's auc: 0.83309
[48]	valid_0's binary_logloss: 0.309641	valid_0's auc: 0.833193
[49]	valid_0's binary_logloss: 0.313865	valid_0's auc: 0.833246
[50]	valid_0's binary_logloss: 0.318719	valid_0's auc: 0.833196
[51]	valid_0's binary_logloss: 0.314304	valid_0's auc: 0.832997
[52]	valid_0's binary_logloss: 0.312826	valid_0's auc: 0.83312
[53]	valid_0's binary_logloss: 0.311603	valid_0's auc: 0.833074
[54]	valid_0's binary_logloss: 0.319158	valid_0's auc: 0.833183
[55]	valid_0's binary_logloss: 0.340312	valid_0's auc: 0.833632
[56]	valid_0's binary_logloss: 0.338685	valid_0's auc: 0.833255
[57]	valid_0's binary_logloss: 0.34548	valid_0's auc: 0.833534
[58]	valid_0's binary_logloss: 0.344348	valid_0's auc: 0.83306
[59]	valid_0's binary_logloss: 0.337409	valid_0's auc: 0.83249
[60]	valid_0's binary_logloss: 0.336177	valid_0's auc: 0.832414
[61]	valid_0's binary_logloss: 0.352579	valid_0's auc: 0.83269
[62]	valid_0's binary_logloss: 0.341011	valid_0's auc: 0.832167
[63]	valid_0's binary_logloss: 0.335626	valid_0's auc: 0.831962
[64]	valid_0's binary_logloss: 0.37278	valid_0's auc: 0.831074
[65]	valid_0's binary_logloss: 0.345381	valid_0's auc: 0.83194
[66]	valid_0's binary_logloss: 0.342475	valid_0's auc: 0.831492
[67]	valid_0's binary_logloss: 0.341505	valid_0's auc: 0.831117
[68]	valid_0's binary_logloss: 0.380673	valid_0's auc: 0.830532
[69]	valid_0's binary_logloss: 0.347612	valid_0's auc: 0.831671
[70]	valid_0's binary_logloss: 0.344231	valid_0's auc: 0.831378
[71]	valid_0's binary_logloss: 0.339533	valid_0's auc: 0.831533
[72]	valid_0's binary_logloss: 0.340813	valid_0's auc: 0.831729
Early stopping, best iteration is:
[12]	valid_0's binary_logloss: 0.298262	valid_0's auc: 0.839261
(5320904, 350)
Traceback (most recent call last):
  File "lgbm.py", line 395, in <module>
    done()
  File "lgbm.py", line 347, in done
    early_stopping_rounds=60) # Êó©ÂÅúÁ≥ªÊï∞
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/engine.py", line 183, in train
    booster = Booster(params=params, train_set=train_set)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py", line 1307, in __init__
    train_set.construct().handle,
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py", line 860, in construct
    categorical_feature=self.categorical_feature, params=self.params)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py", line 652, in _lazy_init
    data, feature_name, categorical_feature, self.pandas_categorical = _data_from_pandas(data, feature_name, categorical_feature, self.pandas_categorical)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py", line 274, in _data_from_pandas
    data = data.values.astype('float')
MemoryError
