2018-07-10 16:22:30,161 - DEBUG - ffm.py:48 - 设置参数
2018-07-10 16:22:30,161 - DEBUG - ffm.py:50 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 7.81 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.38 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461877            0.456102            0.830113               19.95
[32m[ [0m  20%[32m      ][0m     2            0.457680            0.455521            0.830113               19.40
[32m[ [0m  30%[32m      ][0m     3            0.456009            0.457497            0.830113               19.29
[32m[ [0m  40%[32m      ][0m     4            0.455999            0.455952            0.830113               19.67
[32m[ [0m  50%[32m      ][0m     5            0.455962            0.455940            0.830113               19.84
[32m[ [0m  60%[32m      ][0m     6            0.455907            0.455896            0.830113               19.76
[32m[ [0m  70%[32m      ][0m     7            0.455923            0.455988            0.830113               19.22
[32m[ [0m  80%[32m      ][0m     8            0.455958            0.455936            0.830113               19.18
[32m[ [0m  90%[32m      ][0m     9            0.455947            0.455920            0.830113               19.54
[32m[ [0m 100%[32m      ][0m    10            0.455921            0.455909            0.830113               19.68
[32m[1m[ ACTION     ] Early-stopping at epoch 2[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.76 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 207.19 (sec)[0m
2018-07-10 16:25:57,352 - DEBUG - ffm.py:56 - to save validation predictions ...
Traceback (most recent call last):
  File "ffm.py", line 86, in <module>
    done()
  File "ffm.py", line 59, in done
    logging.debug(ffm_model.weights)        
AttributeError: 'XLearn' object has no attribute 'weights'
2018-07-10 16:27:24,793 - DEBUG - ffm.py:48 - 设置参数
2018-07-10 16:27:24,794 - DEBUG - ffm.py:50 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 7.77 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.39 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461918            0.456093            0.830113               20.22
[32m[ [0m  20%[32m      ][0m     2            0.457637            0.455220            0.830113               19.59
[32m[ [0m  30%[32m      ][0m     3            0.456074            0.457454            0.830113               19.38
[32m[ [0m  40%[32m      ][0m     4            0.455995            0.455985            0.830113               19.09
[32m[ [0m  50%[32m      ][0m     5            0.455966            0.455933            0.830113               19.20
[32m[ [0m  60%[32m      ][0m     6            0.455910            0.455954            0.830113               19.36
[32m[ [0m  70%[32m      ][0m     7            0.455924            0.455994            0.830113               19.22
[32m[1m[ ACTION     ] Early-stopping at epoch 2[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.63 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 147.57 (sec)[0m
2018-07-10 16:29:52,361 - DEBUG - ffm.py:56 - to save validation predictions ...
Traceback (most recent call last):
  File "ffm.py", line 86, in <module>
    done()
  File "ffm.py", line 59, in done
    logging.debug(ffm_model.weights)        
AttributeError: 'XLearn' object has no attribute 'weights'
2018-07-10 16:31:26,375 - DEBUG - ffm.py:48 - 设置参数
2018-07-10 16:31:26,375 - DEBUG - ffm.py:50 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 7.84 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.39 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461914            0.456097            0.830113               20.34
[32m[ [0m  20%[32m      ][0m     2            0.457586            0.454995            0.830113               19.38
[32m[ [0m  30%[32m      ][0m     3            0.456088            0.457436            0.830113               19.80
[32m[ [0m  40%[32m      ][0m     4            0.455994            0.455999            0.830113               20.36
[32m[ [0m  50%[32m      ][0m     5            0.455968            0.455905            0.830113               19.32
[32m[ [0m  60%[32m      ][0m     6            0.455908            0.455898            0.830113               19.26
[32m[ [0m  70%[32m      ][0m     7            0.455921            0.455975            0.830113               19.19
[32m[ [0m  80%[32m      ][0m     8            0.455958            0.455929            0.830113               19.31
[32m[ [0m  90%[32m      ][0m     9            0.455946            0.455938            0.830113               19.49
[32m[ [0m 100%[32m      ][0m    10            0.455918            0.455927            0.830113               19.54
[32m[1m[ ACTION     ] Early-stopping at epoch 2[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.86 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 207.78 (sec)[0m
2018-07-10 16:34:54,156 - DEBUG - ffm.py:56 - to save validation predictions ...
2018-07-10 16:34:54,156 - DEBUG - ffm.py:59 - <xlearn.xlearn.XLearn object at 0x7f7085060f98>
2018-07-10 16:34:54,156 - DEBUG - ffm.py:48 - 设置参数
2018-07-10 16:34:54,156 - DEBUG - ffm.py:67 - 预测
Traceback (most recent call last):
  File "ffm.py", line 87, in <module>
    done(False)
  File "ffm.py", line 68, in done
    ffm_model.setTest(test_save)  # Test data
UnboundLocalError: local variable 'ffm_model' referenced before assignment
2018-07-10 16:36:43,711 - DEBUG - ffm.py:49 - 设置参数
2018-07-10 16:36:43,711 - DEBUG - ffm.py:51 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 7.83 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.39 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461913            0.456093            0.830113               19.82
[32m[ [0m  20%[32m      ][0m     2            0.457663            0.455575            0.830113               19.41
[32m[ [0m  30%[32m      ][0m     3            0.456050            0.457486            0.830113               20.07
[32m[ [0m  40%[32m      ][0m     4            0.455993            0.456010            0.830113               19.53
[32m[ [0m  50%[32m      ][0m     5            0.455965            0.455926            0.830113               19.33
[32m[ [0m  60%[32m      ][0m     6            0.455911            0.455918            0.830113               19.61
[32m[ [0m  70%[32m      ][0m     7            0.455919            0.455986            0.830113               19.44
[32m[ [0m  80%[32m      ][0m     8            0.455958            0.455953            0.830113               19.86
[32m[ [0m  90%[32m      ][0m     9            0.455947            0.455932            0.830113               19.56
[32m[ [0m 100%[32m      ][0m    10            0.455917            0.455921            0.830113               19.54
[32m[1m[ ACTION     ] Early-stopping at epoch 2[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.59 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 207.71 (sec)[0m
2018-07-10 16:40:11,422 - DEBUG - ffm.py:56 - to save validation predictions ...
2018-07-10 16:40:11,422 - DEBUG - ffm.py:59 - <xlearn.xlearn.XLearn object at 0x7f5a6833a630>
2018-07-10 16:40:11,422 - DEBUG - ffm.py:49 - 设置参数
2018-07-10 16:40:11,422 - DEBUG - ffm.py:67 - 预测
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.25 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mTime cost for reading problem: 14.87 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.195368
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 17.93 (sec)[0m
2018-07-10 16:40:29,354 - DEBUG - ffm.py:73 - <xlearn.xlearn.XLearn object at 0x7f5a6833a630>
2018-07-10 17:02:33,619 - DEBUG - ffm.py:49 - 设置参数
2018-07-10 17:02:33,620 - DEBUG - ffm.py:67 - 预测
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691017
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.24 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.53 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.195368
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 4.61 (sec)[0m
2018-07-10 17:02:38,454 - DEBUG - ffm.py:74 - <xlearn.xlearn.XLearn object at 0x7fe67725b7f0>
2018-07-10 17:02:41,581 - DEBUG - ffm.py:76 - ------------------------------
2018-07-10 17:02:41,696 - DEBUG - ffm.py:78 - (4577464, 1)
2018-07-10 17:02:42,499 - DEBUG - ffm.py:80 - (4577464,)
2018-07-10 17:03:14,898 - DEBUG - ffm.py:49 - 设置参数
2018-07-10 17:03:14,898 - DEBUG - ffm.py:51 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 42.63 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 672.19 MB
[32m[------------] [0mTime cost for model initial: 0.39 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.461901            0.458376            0.830169               23.09
[32m[ [0m  20%[32m      ][0m     2            0.457713            0.454336            0.830169               22.06
[32m[ [0m  30%[32m      ][0m     3            0.455989            0.454291            0.830169               21.60
[32m[ [0m  40%[32m      ][0m     4            0.456006            0.458978            0.830169               21.75
[32m[ [0m  50%[32m      ][0m     5            0.455970            0.458939            0.830169               21.99
[32m[ [0m  60%[32m      ][0m     6            0.455919            0.458937            0.830169               22.14
[32m[ [0m  70%[32m      ][0m     7            0.455916            0.458820            0.830169               21.98
[32m[ [0m  80%[32m      ][0m     8            0.455964            0.458833            0.830169               22.01
[32m[ [0m  90%[32m      ][0m     9            0.455949            0.458777            0.830169               22.86
[32m[ [0m 100%[32m      ][0m    10            0.455924            0.458776            0.830169               22.46
[32m[1m[ ACTION     ] Early-stopping at epoch 3[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 2.67 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 268.48 (sec)[0m
2018-07-10 17:07:43,378 - DEBUG - ffm.py:56 - to save validation predictions ...
2018-07-10 17:07:43,378 - DEBUG - ffm.py:59 - <xlearn.xlearn.XLearn object at 0x7f9b6f462160>
2018-07-10 17:07:43,378 - DEBUG - ffm.py:49 - 设置参数
2018-07-10 17:07:43,378 - DEBUG - ffm.py:67 - 预测
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.25 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.53 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.200086
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 4.58 (sec)[0m
2018-07-10 17:07:48,153 - DEBUG - ffm.py:74 - <xlearn.xlearn.XLearn object at 0x7f9b6f462160>
2018-07-10 17:07:51,266 - DEBUG - ffm.py:76 - ------------------------------
2018-07-10 17:07:51,380 - DEBUG - ffm.py:78 - (4577464, 1)
2018-07-10 17:07:52,240 - DEBUG - ffm.py:80 - (4577464,)
2018-07-10 17:27:41,069 - DEBUG - ffm.py:52 - 设置参数
2018-07-10 17:27:41,069 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 12.39 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 448.12 MB
[32m[------------] [0mTime cost for model initial: 0.33 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.456969            0.456387            0.830169               13.04
[32m[ [0m  20%[32m      ][0m     2            0.453968            0.456804            0.830169               13.00
[32m[ [0m  30%[32m      ][0m     3            0.452355            0.457364            0.830169               13.22
[32m[1m[ ACTION     ] Early-stopping at epoch 1[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 1.60 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 53.97 (sec)[0m
2018-07-10 17:28:35,041 - DEBUG - ffm.py:59 - to save validation predictions ...
2018-07-10 17:28:35,041 - DEBUG - ffm.py:62 - <xlearn.xlearn.XLearn object at 0x7fe2684277f0>
2018-07-10 17:28:35,041 - DEBUG - ffm.py:52 - 设置参数
2018-07-10 17:28:35,041 - DEBUG - ffm.py:70 - 预测
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.17 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.53 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.191189
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 4.32 (sec)[0m
2018-07-10 17:28:39,561 - DEBUG - ffm.py:77 - <xlearn.xlearn.XLearn object at 0x7fe2684277f0>
2018-07-10 17:28:42,746 - DEBUG - ffm.py:79 - ------------------------------
2018-07-10 17:28:42,860 - DEBUG - ffm.py:81 - (4577464, 1)
2018-07-10 17:28:43,709 - DEBUG - ffm.py:83 - (4577464,)
2018-07-10 17:31:35,668 - DEBUG - ffm.py:52 - 设置参数
2018-07-10 17:31:35,668 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 12.39 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 448.12 MB
[32m[------------] [0mTime cost for model initial: 0.33 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.456270            0.455969            0.830169               13.35
[32m[ [0m  20%[32m      ][0m     2            0.455733            0.455697            0.830169               13.65
[32m[ [0m  30%[32m      ][0m     3            0.455473            0.455570            0.830169               13.09
[32m[ [0m  40%[32m      ][0m     4            0.455273            0.455463            0.830169               13.35
[32m[ [0m  50%[32m      ][0m     5            0.455110            0.455418            0.830169               13.13
[32m[ [0m  60%[32m      ][0m     6            0.454983            0.455459            0.830169               13.18
[32m[ [0m  70%[32m      ][0m     7            0.454860            0.455453            0.830169               13.19
[32m[ [0m  80%[32m      ][0m     8            0.454759            0.455667            0.830169               13.33
[32m[ [0m  90%[32m      ][0m     9            0.454634            0.455481            0.830169               13.86
[32m[ [0m 100%[32m      ][0m    10            0.454547            0.455507            0.830169               13.16
[32m[1m[ ACTION     ] Early-stopping at epoch 5[0m
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 1.15 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 147.92 (sec)[0m
2018-07-10 17:34:03,586 - DEBUG - ffm.py:59 - to save validation predictions ...
2018-07-10 17:34:03,586 - DEBUG - ffm.py:62 - <xlearn.xlearn.XLearn object at 0x7f16ed7f5198>
2018-07-10 17:34:03,586 - DEBUG - ffm.py:52 - 设置参数
2018-07-10 17:34:03,586 - DEBUG - ffm.py:70 - 预测
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.17 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.54 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.211198
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 4.29 (sec)[0m
2018-07-10 17:34:08,068 - DEBUG - ffm.py:77 - <xlearn.xlearn.XLearn object at 0x7f16ed7f5198>
2018-07-10 17:34:11,194 - DEBUG - ffm.py:79 - ------------------------------
2018-07-10 17:34:11,308 - DEBUG - ffm.py:81 - (4577464, 1)
2018-07-10 17:34:12,157 - DEBUG - ffm.py:83 - (4577464,)
2018-07-10 17:39:03,714 - DEBUG - ffm.py:52 - 设置参数
2018-07-10 17:39:03,714 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of Field: 21
[32m[------------] [0mTime cost for reading problem: 12.52 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 224.06 MB
[32m[------------] [0mTime cost for model initial: 0.28 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss       Test Accuarcy     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.456753            0.456115            0.830169                9.11
[32m[ [0m  20%[32m      ][0m     2            0.456370            0.457408            0.830169                9.22
[32m[ [0m  30%[32m      ][0m     3            0.456114            0.457980            0.830169                9.39
[32m[ [0m  40%[32m      ][0m     4            0.455882            0.456292            0.830169                9.03
[32m[ [0m  50%[32m      ][0m     5            0.455656            0.456041            0.830169                9.34
[32m[ [0m  60%[32m      ][0m     6            0.455471            0.456050            0.830169                9.08
[32m[ [0m  70%[32m      ][0m     7            0.455310            0.456258            0.830169                8.95
[32m[ [0m  80%[32m      ][0m     8            0.455148            0.456696            0.830169                9.08
[32m[ [0m  90%[32m      ][0m     9            0.454996            0.456233            0.830169                9.14
[32m[ [0m 100%[32m      ][0m    10            0.454859            0.457565            0.830169                9.08
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 0.30 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 104.56 (sec)[0m
2018-07-10 17:40:48,278 - DEBUG - ffm.py:60 - to save validation predictions ...
2018-07-10 17:40:48,278 - DEBUG - ffm.py:63 - <xlearn.xlearn.XLearn object at 0x7fb539854160>
2018-07-10 17:40:48,278 - DEBUG - ffm.py:52 - 设置参数
2018-07-10 17:40:48,278 - DEBUG - ffm.py:71 - 预测
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 691018
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 21
[32m[------------] [0mTime cost for loading model: 0.09 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 1.53 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.170833
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 3.86 (sec)[0m
2018-07-10 17:40:52,333 - DEBUG - ffm.py:78 - <xlearn.xlearn.XLearn object at 0x7fb539854160>
2018-07-10 17:40:55,479 - DEBUG - ffm.py:80 - ------------------------------
2018-07-10 17:40:55,592 - DEBUG - ffm.py:82 - (4577464, 1)
2018-07-10 17:40:56,441 - DEBUG - ffm.py:84 - (4577464,)
2018-07-10 20:49:00,916 - DEBUG - ffm.py:52 - 设置参数
2018-07-10 20:49:00,916 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 37300011
[32m[------------] [0mNumber of Field: 100
[32m[------------] [0mTime cost for reading problem: 116.01 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
2018-07-16 11:43:02,893 - DEBUG - ffm.py:52 - 设置参数
2018-07-16 11:43:02,894 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 59
[32m[------------] [0mNumber of Field: 40
[32m[------------] [0mTime cost for reading problem: 18.77 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 111.32 KB
[32m[------------] [0mTime cost for model initial: 0.00 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.047103            0.415788               68.16
[32m[ [0m  20%[32m      ][0m     2            0.015732            0.415788               68.55
[32m[ [0m  30%[32m      ][0m     3            0.015732            0.415788               68.81
[32m[ [0m  40%[32m      ][0m     4            0.015732            0.415788               68.30
[32m[ [0m  50%[32m      ][0m     5            0.015732            0.415788               68.09
[32m[ [0m  60%[32m      ][0m     6            0.015732            0.415788               68.37
[32m[ [0m  70%[32m      ][0m     7            0.015732            0.415788               68.40
[32m[ [0m  80%[32m      ][0m     8            0.015732            0.415788               68.35
[32m[ [0m  90%[32m      ][0m     9            0.015732            0.415788               67.99
[32m[ [0m 100%[32m      ][0m    10            0.015732            0.415788               68.22
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 0.00 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 702.05 (sec)[0m
2018-07-16 11:54:44,941 - DEBUG - ffm.py:60 - to save validation predictions ...
2018-07-16 11:54:44,941 - DEBUG - ffm.py:64 - <xlearn.xlearn.XLearn object at 0x7f14eb7e23c8>
2018-07-16 11:54:44,941 - DEBUG - ffm.py:52 - 设置参数
2018-07-16 11:54:44,941 - DEBUG - ffm.py:79 - 预测
Info: 
 Model: ffm
 Loss: cross-entropy
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 59
[32m[------------] [0mNumber of K: 4
[32m[------------] [0mNumber of field: 40
[32m[------------] [0mTime cost for loading model: 0.00 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mTime cost for reading problem: 4.68 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.015749
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 7.50 (sec)[0m
2018-07-16 11:54:52,657 - DEBUG - ffm.py:86 - <xlearn.xlearn.XLearn object at 0x7f14eb7e23c8>
2018-07-16 11:54:55,668 - DEBUG - ffm.py:88 - ------------------------------
2018-07-16 11:54:55,783 - DEBUG - ffm.py:90 - (4577464, 1)
2018-07-16 11:54:56,640 - DEBUG - ffm.py:92 - (4577464,)
Info: 
 Model: ffm
 Loss: cross-entropy
2018-07-16 14:03:08,307 - DEBUG - lgbm.py:36 - 设置参数
2018-07-16 14:03:08,307 - DEBUG - lgbm.py:326 - 设置参数
2018-07-16 14:03:13,281 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 13)
2018-07-16 14:03:13,281 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 5)
2018-07-16 14:03:13,696 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 18)
2018-07-16 14:03:13,696 - DEBUG - data_preprocessing.py:236 - 耗时0.41498470306396484
2018-07-16 14:03:36,589 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 18)
2018-07-16 14:03:36,589 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 57)
2018-07-16 14:03:38,370 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 75)
2018-07-16 14:03:38,370 - DEBUG - data_preprocessing.py:236 - 耗时1.7805366516113281
2018-07-16 14:04:16,783 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 75)
2018-07-16 14:04:16,783 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 79)
2018-07-16 14:04:24,104 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 154)
2018-07-16 14:04:24,105 - DEBUG - data_preprocessing.py:236 - 耗时7.3213043212890625
2018-07-16 14:06:11,463 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 154)
2018-07-16 14:06:11,464 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 156)
2018-07-16 14:06:26,344 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 310)
2018-07-16 14:06:26,344 - DEBUG - data_preprocessing.py:236 - 耗时14.880600929260254
2018-07-16 14:06:36,909 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 310)
2018-07-16 14:06:36,909 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 40)
2018-07-16 14:06:44,510 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 350)
2018-07-16 14:06:44,510 - DEBUG - data_preprocessing.py:236 - 耗时7.601315259933472
2018-07-16 14:06:44,809 - DEBUG - data_preprocessing.py:629 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'xgb_basis30', 'xgb_basis31', 'xgb_basis32', 'xgb_basis33',
       'xgb_basis34', 'xgb_basis35', 'xgb_basis36', 'xgb_basis37',
       'xgb_basis38', 'xgb_basis39'],
      dtype='object', length=350)
2018-07-16 14:06:44,810 - DEBUG - data_preprocessing.py:633 - (5320904, 350)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-16 14:07:49,733 - DEBUG - data_preprocessing.py:647 -            C1    C14   C17  C21  device_conn_type  device_ip  device_model  \
2909117  1005  20363  2333  157                 0    1808376          5075   

         device_type  app_or_web  app_site_id     ...       xgb_basis30  \
2909117            1           1         9513     ...              1208   

         xgb_basis31  xgb_basis32  xgb_basis33  xgb_basis34  xgb_basis35  \
2909117         1255         1317         1374         1414         1473   

         xgb_basis36  xgb_basis37  xgb_basis38  xgb_basis39  
2909117         1504         1540         1595         1641  

[1 rows x 349 columns]
2018-07-16 14:07:49,841 - DEBUG - data_preprocessing.py:648 - 2909117    0
Name: click, dtype: int64
2018-07-16 14:07:49,853 - DEBUG - lgbm.py:331 - CV:x
2018-07-16 14:07:49,854 - DEBUG - lgbm.py:84 - 交叉验证
2018-07-16 14:07:49,854 - DEBUG - lgbm.py:314 - {'boosting_type': 'gbdt', 'objective': 'binary', 'metric': ['auc', 'binary_logloss'], 'device': 'gpu', 'gpu_platform_id': -1, 'gpu_device_id': -1, 'num_trees': 300}
2018-07-16 14:07:49,872 - DEBUG - lgbm.py:334 - 开始训练
[LightGBM] [Info] Number of positive: 462785, number of negative: 4326028
[LightGBM] [Info] This is the GPU trainer!!
[LightGBM] [Info] Total Bins 61800
[LightGBM] [Info] Number of data: 4788813, number of used features: 348
[LightGBM] [Info] Using GPU Device: GeForce GTX 1070 Ti, Vendor: NVIDIA Corporation
[LightGBM] [Info] Compiling OpenCL Kernel with 256 bins...
[LightGBM] [Info] GPU programs have been built
[LightGBM] [Info] Size of histogram bin entry: 12
[LightGBM] [Info] 346 dense feature groups (1589.30 MB) transfered to GPU in 0.952937 secs. 1 sparse feature groups
[LightGBM] [Info] [binary:BoostFromScore]: pavg=0.096639 -> initscore=-2.235142
[LightGBM] [Info] Start training from score -2.235142
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/engine.py:102: UserWarning: Found `num_trees` in params. Will use it instead of argument
  warnings.warn("Found `{}` in params. Will use it instead of argument".format(alias))
2018-07-16 14:13:17,067 - DEBUG - lgbm.py:350 - to save validation predictions ...
2018-07-16 14:13:17,099 - DEBUG - lgbm.py:352 - ['/data/1-100-lgbm.model.joblib_dat']
2018-07-16 14:13:17,099 - DEBUG - lgbm.py:357 - 验证
2018-07-16 14:13:20,162 - DEBUG - lgbm.py:360 - log_loss:
2018-07-16 14:13:20,397 - DEBUG - lgbm.py:361 - 0.29826305369206624
2018-07-16 14:13:25,270 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 13)
2018-07-16 14:13:25,270 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 5)
2018-07-16 14:13:25,514 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 18)
2018-07-16 14:13:25,514 - DEBUG - data_preprocessing.py:236 - 耗时0.24385499954223633
2018-07-16 14:13:44,647 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 18)
2018-07-16 14:13:44,647 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 57)
2018-07-16 14:13:46,411 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 75)
2018-07-16 14:13:46,411 - DEBUG - data_preprocessing.py:236 - 耗时1.7641353607177734
2018-07-16 14:14:22,761 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 75)
2018-07-16 14:14:22,761 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 79)
2018-07-16 14:14:28,943 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 154)
2018-07-16 14:14:28,943 - DEBUG - data_preprocessing.py:236 - 耗时6.181918382644653
2018-07-16 14:16:17,228 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 154)
2018-07-16 14:16:17,228 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 156)
2018-07-16 14:16:32,018 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 310)
2018-07-16 14:16:32,018 - DEBUG - data_preprocessing.py:236 - 耗时14.790148496627808
2018-07-16 14:16:42,803 - DEBUG - data_preprocessing.py:231 - data1.shape:(5320904, 310)
2018-07-16 14:16:42,803 - DEBUG - data_preprocessing.py:232 - data2.shape:(5320904, 40)
2018-07-16 14:16:50,355 - DEBUG - data_preprocessing.py:235 - 结果.shape:(5320904, 350)
2018-07-16 14:16:50,355 - DEBUG - data_preprocessing.py:236 - 耗时7.552399396896362
2018-07-16 14:16:50,666 - DEBUG - data_preprocessing.py:629 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'xgb_basis30', 'xgb_basis31', 'xgb_basis32', 'xgb_basis33',
       'xgb_basis34', 'xgb_basis35', 'xgb_basis36', 'xgb_basis37',
       'xgb_basis38', 'xgb_basis39'],
      dtype='object', length=350)
2018-07-16 14:16:50,674 - DEBUG - data_preprocessing.py:633 - (5320904, 350)
2018-07-16 14:18:48,640 - DEBUG - data_preprocessing.py:647 -            C1    C14   C17  C21  device_conn_type  device_ip  device_model  \
2909117  1005  19950  1800   23                 0    1101276          4352   

         device_type  app_or_web  app_site_id     ...       xgb_basis30  \
2909117            1           1         8019     ...              1168   

         xgb_basis31  xgb_basis32  xgb_basis33  xgb_basis34  xgb_basis35  \
2909117         1218         1260         1310         1336         1396   

         xgb_basis36  xgb_basis37  xgb_basis38  xgb_basis39  
2909117         1426         1479         1540         1594  

[1 rows x 349 columns]
2018-07-16 14:18:48,663 - DEBUG - data_preprocessing.py:648 - 2909117    0
Name: click, dtype: int64
2018-07-16 14:18:48,669 - DEBUG - lgbm.py:331 - CV:x
2018-07-16 14:18:48,669 - DEBUG - lgbm.py:84 - 交叉验证
2018-07-16 14:18:48,670 - DEBUG - lgbm.py:314 - {'boosting_type': 'gbdt', 'objective': 'binary', 'metric': ['auc', 'binary_logloss'], 'device': 'gpu', 'gpu_platform_id': -1, 'gpu_device_id': -1, 'verbose': 1}
2018-07-16 14:18:48,677 - DEBUG - lgbm.py:334 - 开始训练
(5320904, 350)
[1]	valid_0's binary_logloss: 0.305221	valid_0's auc: 0.83433
Training until validation scores don't improve for 60 rounds.
[2]	valid_0's binary_logloss: 0.307572	valid_0's auc: 0.835704
[3]	valid_0's binary_logloss: 0.296694	valid_0's auc: 0.836082
[4]	valid_0's binary_logloss: 0.296965	valid_0's auc: 0.837504
[5]	valid_0's binary_logloss: 0.299931	valid_0's auc: 0.839181
[6]	valid_0's binary_logloss: 0.302372	valid_0's auc: 0.838995
[7]	valid_0's binary_logloss: 0.299193	valid_0's auc: 0.839101
[8]	valid_0's binary_logloss: 0.300296	valid_0's auc: 0.838783
[9]	valid_0's binary_logloss: 0.300541	valid_0's auc: 0.838621
[10]	valid_0's binary_logloss: 0.295068	valid_0's auc: 0.838552
[11]	valid_0's binary_logloss: 0.29531	valid_0's auc: 0.838953
[12]	valid_0's binary_logloss: 0.298262	valid_0's auc: 0.839261
[13]	valid_0's binary_logloss: 0.294838	valid_0's auc: 0.838648
[14]	valid_0's binary_logloss: 0.302886	valid_0's auc: 0.839066
[15]	valid_0's binary_logloss: 0.289669	valid_0's auc: 0.838337
[16]	valid_0's binary_logloss: 0.300245	valid_0's auc: 0.83807
[17]	valid_0's binary_logloss: 0.29079	valid_0's auc: 0.837394
[18]	valid_0's binary_logloss: 0.295387	valid_0's auc: 0.837348
[19]	valid_0's binary_logloss: 0.302348	valid_0's auc: 0.837605
[20]	valid_0's binary_logloss: 0.297038	valid_0's auc: 0.837084
[21]	valid_0's binary_logloss: 0.294642	valid_0's auc: 0.83725
[22]	valid_0's binary_logloss: 0.294022	valid_0's auc: 0.836387
[23]	valid_0's binary_logloss: 0.298091	valid_0's auc: 0.836586
[24]	valid_0's binary_logloss: 0.291524	valid_0's auc: 0.836443
[25]	valid_0's binary_logloss: 0.302673	valid_0's auc: 0.836507
[26]	valid_0's binary_logloss: 0.3091	valid_0's auc: 0.836372
[27]	valid_0's binary_logloss: 0.298172	valid_0's auc: 0.836029
[28]	valid_0's binary_logloss: 0.304688	valid_0's auc: 0.836334
[29]	valid_0's binary_logloss: 0.294956	valid_0's auc: 0.836281
[30]	valid_0's binary_logloss: 0.309723	valid_0's auc: 0.83623
[31]	valid_0's binary_logloss: 0.293517	valid_0's auc: 0.835998
[32]	valid_0's binary_logloss: 0.294362	valid_0's auc: 0.835451
[33]	valid_0's binary_logloss: 0.299314	valid_0's auc: 0.836432
[34]	valid_0's binary_logloss: 0.328229	valid_0's auc: 0.835821
[35]	valid_0's binary_logloss: 0.306391	valid_0's auc: 0.835618
[36]	valid_0's binary_logloss: 0.30242	valid_0's auc: 0.834939
[37]	valid_0's binary_logloss: 0.300354	valid_0's auc: 0.835228
[38]	valid_0's binary_logloss: 0.324491	valid_0's auc: 0.83492
[39]	valid_0's binary_logloss: 0.304302	valid_0's auc: 0.833871
[40]	valid_0's binary_logloss: 0.309267	valid_0's auc: 0.833986
[41]	valid_0's binary_logloss: 0.323394	valid_0's auc: 0.834673
[42]	valid_0's binary_logloss: 0.316604	valid_0's auc: 0.834323
[43]	valid_0's binary_logloss: 0.323465	valid_0's auc: 0.83432
[44]	valid_0's binary_logloss: 0.32642	valid_0's auc: 0.834143
[45]	valid_0's binary_logloss: 0.315528	valid_0's auc: 0.833443
[46]	valid_0's binary_logloss: 0.34102	valid_0's auc: 0.833323
[47]	valid_0's binary_logloss: 0.313816	valid_0's auc: 0.83309
[48]	valid_0's binary_logloss: 0.309641	valid_0's auc: 0.833193
[49]	valid_0's binary_logloss: 0.313865	valid_0's auc: 0.833246
[50]	valid_0's binary_logloss: 0.318719	valid_0's auc: 0.833196
[51]	valid_0's binary_logloss: 0.314304	valid_0's auc: 0.832997
[52]	valid_0's binary_logloss: 0.312826	valid_0's auc: 0.83312
[53]	valid_0's binary_logloss: 0.311603	valid_0's auc: 0.833074
[54]	valid_0's binary_logloss: 0.319158	valid_0's auc: 0.833183
[55]	valid_0's binary_logloss: 0.340312	valid_0's auc: 0.833632
[56]	valid_0's binary_logloss: 0.338685	valid_0's auc: 0.833255
[57]	valid_0's binary_logloss: 0.34548	valid_0's auc: 0.833534
[58]	valid_0's binary_logloss: 0.344348	valid_0's auc: 0.83306
[59]	valid_0's binary_logloss: 0.337409	valid_0's auc: 0.83249
[60]	valid_0's binary_logloss: 0.336177	valid_0's auc: 0.832414
[61]	valid_0's binary_logloss: 0.352579	valid_0's auc: 0.83269
[62]	valid_0's binary_logloss: 0.341011	valid_0's auc: 0.832167
[63]	valid_0's binary_logloss: 0.335626	valid_0's auc: 0.831962
[64]	valid_0's binary_logloss: 0.37278	valid_0's auc: 0.831074
[65]	valid_0's binary_logloss: 0.345381	valid_0's auc: 0.83194
[66]	valid_0's binary_logloss: 0.342475	valid_0's auc: 0.831492
[67]	valid_0's binary_logloss: 0.341505	valid_0's auc: 0.831117
[68]	valid_0's binary_logloss: 0.380673	valid_0's auc: 0.830532
[69]	valid_0's binary_logloss: 0.347612	valid_0's auc: 0.831671
[70]	valid_0's binary_logloss: 0.344231	valid_0's auc: 0.831378
[71]	valid_0's binary_logloss: 0.339533	valid_0's auc: 0.831533
[72]	valid_0's binary_logloss: 0.340813	valid_0's auc: 0.831729
Early stopping, best iteration is:
[12]	valid_0's binary_logloss: 0.298262	valid_0's auc: 0.839261
(5320904, 350)
Traceback (most recent call last):
  File "lgbm.py", line 395, in <module>
    done()
  File "lgbm.py", line 347, in done
    early_stopping_rounds=60) # 早停系数
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/engine.py", line 183, in train
    booster = Booster(params=params, train_set=train_set)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py", line 1307, in __init__
    train_set.construct().handle,
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py", line 860, in construct
    categorical_feature=self.categorical_feature, params=self.params)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py", line 652, in _lazy_init
    data, feature_name, categorical_feature, self.pandas_categorical = _data_from_pandas(data, feature_name, categorical_feature, self.pandas_categorical)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py", line 274, in _data_from_pandas
    data = data.values.astype('float')
MemoryError
2018-07-17 09:31:52,847 - DEBUG - data_preprocessing.py:231 - data1.shape:(200000, 13)
2018-07-17 09:31:52,847 - DEBUG - data_preprocessing.py:232 - data2.shape:(10641809, 5)
2018-07-17 09:31:53,747 - DEBUG - data_preprocessing.py:235 - 结果.shape:(10641809, 18)
2018-07-17 09:31:53,747 - DEBUG - data_preprocessing.py:236 - 耗时0.8995561599731445
2018-07-17 09:32:29,331 - DEBUG - data_preprocessing.py:231 - data1.shape:(10641809, 18)
2018-07-17 09:32:29,331 - DEBUG - data_preprocessing.py:232 - data2.shape:(10641809, 57)
2018-07-17 09:32:32,296 - DEBUG - data_preprocessing.py:235 - 结果.shape:(10641809, 75)
2018-07-17 09:32:32,296 - DEBUG - data_preprocessing.py:236 - 耗时2.9647939205169678
2018-07-17 09:33:47,720 - DEBUG - data_preprocessing.py:231 - data1.shape:(10641809, 75)
2018-07-17 09:33:47,720 - DEBUG - data_preprocessing.py:232 - data2.shape:(10641809, 79)
2018-07-17 09:34:00,423 - DEBUG - data_preprocessing.py:235 - 结果.shape:(10641809, 154)
2018-07-17 09:34:00,424 - DEBUG - data_preprocessing.py:236 - 耗时12.703796148300171
2018-07-17 09:43:47,560 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 09:43:47,560 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 09:43:47,576 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 09:43:47,576 - DEBUG - data_preprocessing.py:238 - 耗时0.015913963317871094
2018-07-17 09:43:48,174 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 09:43:48,174 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 09:43:48,248 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 09:43:48,248 - DEBUG - data_preprocessing.py:238 - 耗时0.07377171516418457
2018-07-17 09:43:49,603 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 09:43:49,603 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 09:43:49,856 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 09:43:49,856 - DEBUG - data_preprocessing.py:238 - 耗时0.2527940273284912
2018-07-17 09:43:54,492 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 09:43:54,492 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 09:43:55,006 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 09:43:55,006 - DEBUG - data_preprocessing.py:238 - 耗时0.5141761302947998
2018-07-17 09:43:55,018 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 09:43:55,018 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
the shape of train_image: (200000, 309)
(160000, 309)
(40000, 309)
Traceback (most recent call last):
  File "PCA_fea.py", line 102, in <module>
    tmp = n_component_analysis(n, X_train_part, y_train_part, X_val, y_val)
TypeError: n_component_analysis() takes 3 positional arguments but 5 were given
2018-07-17 09:44:59,699 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 09:44:59,699 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 09:44:59,715 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 09:44:59,715 - DEBUG - data_preprocessing.py:238 - 耗时0.0158693790435791
2018-07-17 09:45:00,395 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 09:45:00,396 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 09:45:00,469 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 09:45:00,469 - DEBUG - data_preprocessing.py:238 - 耗时0.0731048583984375
2018-07-17 09:45:01,822 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 09:45:01,822 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 09:45:02,076 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 09:45:02,076 - DEBUG - data_preprocessing.py:238 - 耗时0.2537992000579834
2018-07-17 09:45:06,708 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 09:45:06,709 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 09:45:07,224 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 09:45:07,224 - DEBUG - data_preprocessing.py:238 - 耗时0.5150377750396729
2018-07-17 09:45:07,235 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 09:45:07,236 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
the shape of train_image: (200000, 309)
(160000, 309)
(40000, 309)
PCA begin with n_components: 0.7
xgb begin
Traceback (most recent call last):
  File "PCA_fea.py", line 102, in <module>
    tmp = n_component_analysis(n, X_train_part, y_train_part)
  File "PCA_fea.py", line 85, in n_component_analysis
    dtrain_predprob = xgb1.predict_proba(X_train_pca)[:,1]
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/sklearn.py", line 587, in predict_proba
    ntree_limit=ntree_limit)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 1142, in predict
    self._validate_features(data)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 1400, in _validate_features
    data.feature_names))
ValueError: feature_names mismatch: ['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip', 'device_model', 'device_type', 'app_or_web', 'app_site_id', 'app_site_model', 'app_site_model_aw', 'dev_ip_app_site', 'one_day', 'one_day_hour', 'day_hour_prev', 'day_hour_next', 'is_work_day', 'C15', 'C16', 'C18', 'C19', 'C20', 'app_category', 'app_domain', 'app_id', 'banner_pos', 'device_id', 'hour', 'site_category', 'site_domain', 'site_id', 'uid', 'uid_time', 'device_id_cnt', 'device_ip_cnt', 'uid_cnt', 'uid_time_cnt', 'top_10_app_id', 'top_25_app_id', 'top_5_app_id', 'top_50_app_id', 'top_1_app_id', 'top_2_app_id', 'top_15_app_id', 'top_20_app_id', 'top_30_app_id', 'top_10_site_id', 'top_25_site_id', 'top_5_site_id', 'top_50_site_id', 'top_1_site_id', 'top_2_site_id', 'top_15_site_id', 'top_20_site_id', 'top_30_site_id', 'top_10_app_domain', 'top_25_app_domain', 'top_5_app_domain', 'top_50_app_domain', 'top_1_app_domain', 'top_2_app_domain', 'top_15_app_domain', 'top_20_app_domain', 'top_30_app_domain', 'top_10_app_category', 'top_25_app_category', 'top_5_app_category', 'top_50_app_category', 'top_1_app_category', 'top_2_app_category', 'top_15_app_category', 'top_20_app_category', 'top_30_app_category', 'app_or_webC14', '_key1', 'app_or_webC21', 'app_or_webdevice_conn_type', 'app_or_webdevice_ip', 'app_or_webC1', 'app_or_webdevice_model', 'app_or_webdev_ip_app_site', 'app_or_webdevice_type', 'app_or_webapp_site_model', 'app_or_webapp_site_model_aw', 'app_or_webapp_site_id', 'app_or_webC17', 'device_ipC14', 'device_ipC21', 'device_ipdevice_conn_type', 'device_ipC1', 'device_ipdevice_model', 'device_ipdev_ip_app_site', 'device_ipdevice_type', 'device_ipapp_site_model', 'device_ipapp_site_model_aw', 'device_ipapp_site_id', 'device_ipC17', 'app_site_idC21', 'app_site_idC14', 'app_site_iddevice_conn_type', 'app_site_idC1', 'app_site_iddevice_model', 'app_site_iddev_ip_app_site', 'app_site_idC17', 'app_site_idapp_site_model', 'app_site_idapp_site_model_aw', 'app_site_iddevice_type', 'device_modelC21', 'device_modelC14', 'device_modeldevice_conn_type', 'device_modelC1', 'device_modelC17', 'device_modeldev_ip_app_site', 'device_modelapp_site_model', 'device_modelapp_site_model_aw', 'device_modeldevice_type', 'app_site_modelC21', 'app_site_modelC14', 'app_site_modeldevice_conn_type', 'app_site_modelC1', 'app_site_modelC17', 'app_site_modeldev_ip_app_site', 'app_site_modelapp_site_model_aw', 'app_site_modeldevice_type', 'C1C21', 'C1C14', 'C1device_conn_type', 'C1C17', 'C1dev_ip_app_site', 'C1app_site_model_aw', 'C1device_type', 'C14C21', 'C14device_conn_type', 'C14C17', 'C14dev_ip_app_site', 'C14app_site_model_aw', 'C14device_type', 'C17C21', 'C17device_conn_type', 'C17dev_ip_app_site', 'C17app_site_model_aw', 'C17device_type', 'C21app_site_model_aw', 'C21dev_ip_app_site', 'C21device_conn_type', 'C21device_type', 'device_typeapp_site_model_aw', 'device_typedev_ip_app_site', 'device_typedevice_conn_type', 'device_conn_typeapp_site_model_aw', 'device_conn_typedev_ip_app_site', 'app_site_model_awdev_ip_app_site'] ['f0', 'f1', 'f2', 'f3']
expected C18, top_5_app_domain, dev_ip_app_site, device_ipdevice_conn_type, device_modelC21, top_30_app_id, banner_pos, app_site_idC1, device_ipC1, C15, device_typedevice_conn_type, app_domain, C14C17, device_conn_typeapp_site_model_aw, top_1_app_id, C21device_conn_type, top_25_app_domain, app_or_webapp_site_model_aw, C21, top_30_app_domain, top_2_app_id, app_site_model_aw, app_site_model_awdev_ip_app_site, top_2_app_domain, app_or_webdev_ip_app_site, app_or_web, C21dev_ip_app_site, C14dev_ip_app_site, app_or_webC1, C1app_site_model_aw, top_10_app_category, device_id, app_site_modelC14, C17dev_ip_app_site, app_site_modelC21, top_30_site_id, top_5_app_category, C1, top_20_app_id, app_site_idC17, device_modeldevice_conn_type, device_modelapp_site_model_aw, device_typeapp_site_model_aw, C16, app_site_iddevice_type, top_15_site_id, app_site_iddevice_model, app_site_modelapp_site_model_aw, C14device_type, app_site_idC21, site_id, app_category, app_site_id, C1device_conn_type, one_day_hour, app_or_webdevice_ip, site_domain, top_20_site_id, app_site_idC14, device_ipapp_site_id, top_15_app_domain, app_or_webapp_site_model, one_day, top_15_app_category, C1C21, app_site_iddev_ip_app_site, C17app_site_model_aw, uid, top_50_app_category, top_25_app_category, is_work_day, app_site_modeldevice_conn_type, C1device_type, device_ipdevice_type, top_2_app_category, day_hour_next, device_ipC21, top_15_app_id, device_conn_typedev_ip_app_site, C21device_type, top_1_app_domain, C17device_conn_type, site_category, device_modelapp_site_model, top_25_app_id, C17C21, app_site_idapp_site_model, top_50_app_domain, device_modelC1, top_5_site_id, app_site_modelC1, app_site_idapp_site_model_aw, device_typedev_ip_app_site, device_ipapp_site_model_aw, app_or_webC17, day_hour_prev, top_1_site_id, device_modelC17, C17device_type, top_1_app_category, app_site_modeldevice_type, top_5_app_id, app_or_webdevice_conn_type, app_or_webdevice_type, top_20_app_category, C1dev_ip_app_site, device_ip, top_50_app_id, C14C21, C14app_site_model_aw, device_ipdevice_model, app_site_model, top_30_app_category, C20, app_or_webdevice_model, hour, uid_time_cnt, app_site_modelC17, device_modelC14, app_or_webC14, app_or_webC21, top_10_site_id, device_model, device_ip_cnt, device_conn_type, C19, C17, _key1, uid_cnt, top_50_site_id, app_site_iddevice_conn_type, app_site_modeldev_ip_app_site, device_type, app_or_webapp_site_id, C14device_conn_type, top_25_site_id, device_ipdev_ip_app_site, device_ipC17, top_10_app_id, C1C14, uid_time, C1C17, top_20_app_domain, device_ipC14, C14, top_2_site_id, top_10_app_domain, app_id, device_modeldev_ip_app_site, device_modeldevice_type, C21app_site_model_aw, device_ipapp_site_model, device_id_cnt in input data
training data did not have the following fields: f1, f3, f0, f2
2018-07-17 09:59:18,521 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 09:59:18,521 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 09:59:18,537 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 09:59:18,537 - DEBUG - data_preprocessing.py:238 - 耗时0.01593756675720215
2018-07-17 09:59:19,231 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 09:59:19,231 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 09:59:19,304 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 09:59:19,304 - DEBUG - data_preprocessing.py:238 - 耗时0.07259082794189453
2018-07-17 09:59:20,667 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 09:59:20,668 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 09:59:20,923 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 09:59:20,923 - DEBUG - data_preprocessing.py:238 - 耗时0.25507092475891113
2018-07-17 09:59:25,510 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 09:59:25,510 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 09:59:26,019 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 09:59:26,019 - DEBUG - data_preprocessing.py:238 - 耗时0.5092051029205322
2018-07-17 09:59:26,031 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 09:59:26,032 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
2018-07-17 09:59:26,482 - DEBUG - PCA_fea.py:53 - the shape of train_image: (200000, 309)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-17 09:59:27,186 - DEBUG - PCA_fea.py:68 - (160000, 309)
2018-07-17 09:59:27,186 - DEBUG - PCA_fea.py:69 - (40000, 309)
2018-07-17 09:59:27,187 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7
2018-07-17 09:59:33,558 - DEBUG - PCA_fea.py:87 - xgb begin
[09:59:34] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[09:59:34] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[09:59:35] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[09:59:48] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 09:59:48,851 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
Traceback (most recent call last):
  File "PCA_fea.py", line 143, in <module>
    tmp = n_component_analysis(n, X_train_part, y_train_part,X_val, y_val)
  File "PCA_fea.py", line 129, in n_component_analysis
    accuracy = alg.score(train_predprob[:,1], y_val)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/base.py", line 349, in score
    return accuracy_score(y, self.predict(X), sample_weight=sample_weight)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/sklearn.py", line 556, in predict
    test_dmatrix = DMatrix(data, missing=self.missing, nthread=self.n_jobs)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 334, in __init__
    self._init_from_npy2d(data, missing, nthread)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 402, in _init_from_npy2d
    raise ValueError('Input numpy.ndarray must be 2 dimensional')
ValueError: Input numpy.ndarray must be 2 dimensional
2018-07-17 10:02:11,212 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 10:02:11,212 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 10:02:11,228 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 10:02:11,228 - DEBUG - data_preprocessing.py:238 - 耗时0.015880584716796875
2018-07-17 10:02:11,846 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 10:02:11,846 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 10:02:11,919 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 10:02:11,919 - DEBUG - data_preprocessing.py:238 - 耗时0.07288551330566406
2018-07-17 10:02:13,264 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 10:02:13,264 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 10:02:13,517 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 10:02:13,517 - DEBUG - data_preprocessing.py:238 - 耗时0.25296545028686523
2018-07-17 10:02:18,041 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 10:02:18,041 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 10:02:18,552 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 10:02:18,552 - DEBUG - data_preprocessing.py:238 - 耗时0.5111658573150635
2018-07-17 10:02:18,564 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 10:02:18,564 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
2018-07-17 10:02:19,017 - DEBUG - PCA_fea.py:53 - the shape of train_image: (200000, 309)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-17 10:02:19,720 - DEBUG - PCA_fea.py:68 - (160000, 309)
2018-07-17 10:02:19,720 - DEBUG - PCA_fea.py:69 - (40000, 309)
2018-07-17 10:02:19,720 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7
2018-07-17 10:02:26,022 - DEBUG - PCA_fea.py:87 - xgb begin
[10:02:27] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:02:27] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:02:27] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:02:40] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:02:41,144 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
Traceback (most recent call last):
  File "PCA_fea.py", line 143, in <module>
    tmp = n_component_analysis(n, X_train_part, y_train_part,X_val, y_val)
  File "PCA_fea.py", line 129, in n_component_analysis
    accuracy = alg.score(train_predprob, y_val)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/base.py", line 349, in score
    return accuracy_score(y, self.predict(X), sample_weight=sample_weight)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/sklearn.py", line 559, in predict
    ntree_limit=ntree_limit)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 1142, in predict
    self._validate_features(data)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 1400, in _validate_features
    data.feature_names))
ValueError: feature_names mismatch: ['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'f10', 'f11', 'f12', 'f13', 'f14', 'f15', 'f16', 'f17', 'f18', 'f19', 'f20', 'f21', 'f22', 'f23', 'f24', 'f25', 'f26', 'f27', 'f28', 'f29', 'f30', 'f31', 'f32', 'f33', 'f34', 'f35', 'f36', 'f37', 'f38', 'f39', 'f40', 'f41', 'f42', 'f43', 'f44', 'f45', 'f46', 'f47', 'f48', 'f49', 'f50', 'f51', 'f52', 'f53', 'f54', 'f55', 'f56', 'f57', 'f58', 'f59', 'f60', 'f61', 'f62', 'f63', 'f64', 'f65', 'f66', 'f67', 'f68', 'f69', 'f70', 'f71', 'f72', 'f73', 'f74', 'f75', 'f76', 'f77', 'f78', 'f79', 'f80', 'f81', 'f82', 'f83', 'f84', 'f85', 'f86', 'f87', 'f88', 'f89', 'f90', 'f91', 'f92', 'f93', 'f94', 'f95', 'f96', 'f97', 'f98', 'f99', 'f100', 'f101', 'f102', 'f103', 'f104', 'f105', 'f106', 'f107', 'f108', 'f109', 'f110', 'f111', 'f112', 'f113', 'f114', 'f115', 'f116', 'f117', 'f118', 'f119', 'f120', 'f121', 'f122', 'f123', 'f124', 'f125', 'f126', 'f127', 'f128', 'f129', 'f130', 'f131', 'f132', 'f133', 'f134', 'f135', 'f136', 'f137', 'f138', 'f139', 'f140', 'f141', 'f142', 'f143', 'f144', 'f145', 'f146', 'f147', 'f148', 'f149', 'f150', 'f151', 'f152', 'f153', 'f154', 'f155', 'f156', 'f157', 'f158', 'f159', 'f160', 'f161', 'f162', 'f163', 'f164', 'f165', 'f166', 'f167', 'f168', 'f169', 'f170', 'f171', 'f172', 'f173', 'f174', 'f175', 'f176', 'f177', 'f178', 'f179', 'f180', 'f181', 'f182', 'f183', 'f184', 'f185', 'f186', 'f187', 'f188', 'f189', 'f190', 'f191', 'f192', 'f193', 'f194', 'f195', 'f196', 'f197', 'f198', 'f199', 'f200', 'f201', 'f202', 'f203', 'f204', 'f205', 'f206', 'f207', 'f208', 'f209', 'f210', 'f211', 'f212', 'f213', 'f214', 'f215', 'f216', 'f217', 'f218', 'f219', 'f220', 'f221', 'f222', 'f223', 'f224', 'f225', 'f226', 'f227', 'f228', 'f229', 'f230', 'f231', 'f232', 'f233', 'f234', 'f235', 'f236', 'f237', 'f238', 'f239', 'f240', 'f241', 'f242', 'f243', 'f244', 'f245', 'f246', 'f247', 'f248', 'f249', 'f250', 'f251', 'f252', 'f253', 'f254', 'f255', 'f256', 'f257', 'f258', 'f259', 'f260', 'f261', 'f262', 'f263', 'f264', 'f265', 'f266', 'f267', 'f268', 'f269', 'f270', 'f271', 'f272', 'f273', 'f274', 'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283', 'f284', 'f285', 'f286', 'f287', 'f288', 'f289', 'f290', 'f291', 'f292', 'f293', 'f294', 'f295', 'f296', 'f297', 'f298', 'f299', 'f300', 'f301', 'f302', 'f303', 'f304', 'f305', 'f306', 'f307', 'f308'] ['f0', 'f1']
expected f297, f120, f198, f64, f140, f9, f238, f72, f199, f302, f34, f7, f184, f281, f76, f277, f78, f206, f292, f23, f26, f122, f169, f245, f303, f12, f103, f243, f53, f84, f189, f168, f235, f81, f275, f267, f214, f274, f82, f77, f132, f144, f48, f229, f50, f212, f218, f68, f298, f128, f291, f306, f46, f208, f29, f263, f131, f299, f92, f118, f266, f153, f288, f66, f130, f269, f284, f24, f224, f300, f241, f115, f183, f14, f207, f232, f191, f179, f124, f52, f80, f282, f63, f11, f226, f19, f185, f133, f295, f250, f197, f71, f152, f54, f57, f90, f102, f109, f135, f196, f173, f126, f136, f74, f216, f271, f210, f123, f258, f260, f256, f205, f223, f65, f35, f304, f91, f248, f253, f163, f308, f231, f156, f4, f190, f60, f192, f147, f178, f259, f22, f20, f177, f40, f195, f101, f149, f61, f270, f87, f273, f236, f172, f143, f67, f242, f227, f290, f112, f225, f239, f246, f276, f10, f265, f121, f201, f69, f148, f146, f174, f237, f96, f161, f116, f141, f249, f279, f261, f264, f58, f166, f39, f18, f162, f94, f70, f176, f167, f285, f55, f100, f2, f215, f228, f75, f95, f73, f305, f8, f25, f110, f200, f97, f86, f113, f293, f272, f21, f93, f151, f182, f294, f217, f79, f150, f62, f221, f5, f30, f244, f204, f99, f98, f51, f137, f138, f181, f27, f157, f59, f117, f175, f160, f186, f170, f268, f13, f119, f44, f37, f307, f36, f45, f56, f47, f155, f255, f213, f230, f251, f280, f145, f219, f139, f129, f234, f287, f42, f114, f220, f164, f247, f158, f202, f127, f254, f6, f171, f252, f222, f301, f107, f142, f85, f125, f43, f211, f89, f193, f159, f104, f108, f33, f257, f154, f105, f111, f31, f88, f187, f134, f165, f209, f32, f286, f3, f38, f16, f188, f180, f240, f296, f15, f49, f289, f106, f278, f83, f283, f17, f41, f28, f194, f203, f233, f262 in input data
2018-07-17 10:08:55,037 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 10:08:55,037 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 10:08:55,053 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 10:08:55,053 - DEBUG - data_preprocessing.py:238 - 耗时0.015972614288330078
2018-07-17 10:08:55,655 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 10:08:55,655 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 10:08:55,728 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 10:08:55,728 - DEBUG - data_preprocessing.py:238 - 耗时0.07259321212768555
2018-07-17 10:08:57,071 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 10:08:57,071 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 10:08:57,325 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 10:08:57,325 - DEBUG - data_preprocessing.py:238 - 耗时0.25395822525024414
2018-07-17 10:09:01,901 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 10:09:01,901 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 10:09:02,415 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 10:09:02,416 - DEBUG - data_preprocessing.py:238 - 耗时0.5142226219177246
2018-07-17 10:09:02,427 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 10:09:02,428 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
2018-07-17 10:09:02,879 - DEBUG - PCA_fea.py:53 - the shape of train_image: (200000, 309)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-17 10:09:03,583 - DEBUG - PCA_fea.py:68 - (160000, 309)
2018-07-17 10:09:03,583 - DEBUG - PCA_fea.py:69 - (40000, 309)
2018-07-17 10:09:03,584 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7
2018-07-17 10:09:10,026 - DEBUG - PCA_fea.py:87 - xgb begin
[10:09:11] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:09:11] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:09:11] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:09:24] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:09:25,124 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:09:25,139 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7107142857142856
2018-07-17 10:09:31,564 - DEBUG - PCA_fea.py:87 - xgb begin
[10:09:32] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:09:32] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:09:32] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:09:45] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:09:46,685 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:09:46,700 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7214285714285714
2018-07-17 10:09:53,121 - DEBUG - PCA_fea.py:87 - xgb begin
[10:09:54] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:09:54] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:09:54] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:10:07] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:10:08,123 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:10:08,138 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7321428571428571
2018-07-17 10:10:14,584 - DEBUG - PCA_fea.py:87 - xgb begin
[10:10:15] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:10:15] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:10:15] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:10:28] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:10:29,612 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:10:29,627 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7428571428571428
2018-07-17 10:10:36,110 - DEBUG - PCA_fea.py:87 - xgb begin
[10:10:37] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:10:37] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:10:37] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:10:50] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:10:51,049 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:10:51,064 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7535714285714286
2018-07-17 10:10:57,521 - DEBUG - PCA_fea.py:87 - xgb begin
[10:10:58] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:10:58] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:10:58] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:11:11] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:11:12,563 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:11:12,579 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7642857142857142
2018-07-17 10:11:19,019 - DEBUG - PCA_fea.py:87 - xgb begin
[10:11:20] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:11:20] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:11:20] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:11:33] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:11:33,945 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:11:33,960 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7749999999999999
2018-07-17 10:11:40,377 - DEBUG - PCA_fea.py:87 - xgb begin
[10:11:41] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:11:41] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:11:41] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:11:54] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:11:55,366 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:11:55,381 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7857142857142857
2018-07-17 10:12:01,872 - DEBUG - PCA_fea.py:87 - xgb begin
[10:12:02] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:12:03] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:12:03] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:12:16] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:12:16,805 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:12:16,820 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7964285714285714
2018-07-17 10:12:23,331 - DEBUG - PCA_fea.py:87 - xgb begin
[10:12:24] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:12:24] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:12:24] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:12:37] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:12:38,292 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:12:38,307 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.8071428571428572
2018-07-17 10:12:44,728 - DEBUG - PCA_fea.py:87 - xgb begin
[10:12:45] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:12:45] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:12:45] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:12:58] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:12:59,659 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:12:59,675 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.8178571428571428
2018-07-17 10:13:06,180 - DEBUG - PCA_fea.py:87 - xgb begin
[10:13:07] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:13:07] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:13:07] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:13:20] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:13:21,139 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:13:21,154 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.8285714285714285
2018-07-17 10:13:27,559 - DEBUG - PCA_fea.py:87 - xgb begin
[10:13:28] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:13:28] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:13:28] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:13:41] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:13:42,559 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:13:42,575 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.8392857142857143
2018-07-17 10:13:48,985 - DEBUG - PCA_fea.py:87 - xgb begin
[10:13:50] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:13:50] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:13:50] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:14:03] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:14:03,945 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:14:03,960 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.85
2018-07-17 10:14:10,372 - DEBUG - PCA_fea.py:87 - xgb begin
[10:14:11] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:14:11] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:14:11] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:14:24] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:14:25,513 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
2018-07-17 10:21:31,243 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 10:21:31,243 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 10:21:31,259 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 10:21:31,259 - DEBUG - data_preprocessing.py:238 - 耗时0.016529321670532227
2018-07-17 10:21:31,892 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 10:21:31,893 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 10:21:31,966 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 10:21:31,966 - DEBUG - data_preprocessing.py:238 - 耗时0.07385659217834473
2018-07-17 10:21:33,348 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 10:21:33,348 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 10:21:33,607 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 10:21:33,607 - DEBUG - data_preprocessing.py:238 - 耗时0.2591073513031006
2018-07-17 10:21:38,307 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 10:21:38,307 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 10:21:38,830 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 10:21:38,830 - DEBUG - data_preprocessing.py:238 - 耗时0.5232493877410889
2018-07-17 10:21:38,842 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 10:21:38,842 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
2018-07-17 10:21:39,302 - DEBUG - PCA_fea.py:53 - the shape of train_image: (200000, 309)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-17 10:21:40,018 - DEBUG - PCA_fea.py:68 - (160000, 309)
2018-07-17 10:21:40,019 - DEBUG - PCA_fea.py:69 - (40000, 309)
2018-07-17 10:21:40,019 - DEBUG - PCA_fea.py:80 - PCA begin with n_components: 0.7
2018-07-17 10:21:46,465 - DEBUG - PCA_fea.py:87 - xgb begin
[10:21:47] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7588MB remaining.
[10:21:47] Allocated 4MB on [0] GeForce GTX 1070 Ti, 7582MB remaining.
[10:21:47] Allocated 108MB on [0] GeForce GTX 1070 Ti, 7472MB remaining.
[10:22:00] Allocated 94MB on [0] GeForce GTX 1070 Ti, 7378MB remaining.
2018-07-17 10:22:01,538 - DEBUG - PCA_fea.py:113 - 0.06258482291485662
Traceback (most recent call last):
  File "PCA_fea.py", line 143, in <module>
    tmp = n_component_analysis(n, X_train_part, y_train_part,X_val, y_val)
  File "PCA_fea.py", line 129, in n_component_analysis
    accuracy = alg.score(train_predprob, y_val)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/base.py", line 349, in score
    return accuracy_score(y, self.predict(X), sample_weight=sample_weight)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/sklearn.py", line 559, in predict
    ntree_limit=ntree_limit)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 1142, in predict
    self._validate_features(data)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 1400, in _validate_features
    data.feature_names))
ValueError: feature_names mismatch: ['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'f10', 'f11', 'f12', 'f13', 'f14', 'f15', 'f16', 'f17', 'f18', 'f19', 'f20', 'f21', 'f22', 'f23', 'f24', 'f25', 'f26', 'f27', 'f28', 'f29', 'f30', 'f31', 'f32', 'f33', 'f34', 'f35', 'f36', 'f37', 'f38', 'f39', 'f40', 'f41', 'f42', 'f43', 'f44', 'f45', 'f46', 'f47', 'f48', 'f49', 'f50', 'f51', 'f52', 'f53', 'f54', 'f55', 'f56', 'f57', 'f58', 'f59', 'f60', 'f61', 'f62', 'f63', 'f64', 'f65', 'f66', 'f67', 'f68', 'f69', 'f70', 'f71', 'f72', 'f73', 'f74', 'f75', 'f76', 'f77', 'f78', 'f79', 'f80', 'f81', 'f82', 'f83', 'f84', 'f85', 'f86', 'f87', 'f88', 'f89', 'f90', 'f91', 'f92', 'f93', 'f94', 'f95', 'f96', 'f97', 'f98', 'f99', 'f100', 'f101', 'f102', 'f103', 'f104', 'f105', 'f106', 'f107', 'f108', 'f109', 'f110', 'f111', 'f112', 'f113', 'f114', 'f115', 'f116', 'f117', 'f118', 'f119', 'f120', 'f121', 'f122', 'f123', 'f124', 'f125', 'f126', 'f127', 'f128', 'f129', 'f130', 'f131', 'f132', 'f133', 'f134', 'f135', 'f136', 'f137', 'f138', 'f139', 'f140', 'f141', 'f142', 'f143', 'f144', 'f145', 'f146', 'f147', 'f148', 'f149', 'f150', 'f151', 'f152', 'f153', 'f154', 'f155', 'f156', 'f157', 'f158', 'f159', 'f160', 'f161', 'f162', 'f163', 'f164', 'f165', 'f166', 'f167', 'f168', 'f169', 'f170', 'f171', 'f172', 'f173', 'f174', 'f175', 'f176', 'f177', 'f178', 'f179', 'f180', 'f181', 'f182', 'f183', 'f184', 'f185', 'f186', 'f187', 'f188', 'f189', 'f190', 'f191', 'f192', 'f193', 'f194', 'f195', 'f196', 'f197', 'f198', 'f199', 'f200', 'f201', 'f202', 'f203', 'f204', 'f205', 'f206', 'f207', 'f208', 'f209', 'f210', 'f211', 'f212', 'f213', 'f214', 'f215', 'f216', 'f217', 'f218', 'f219', 'f220', 'f221', 'f222', 'f223', 'f224', 'f225', 'f226', 'f227', 'f228', 'f229', 'f230', 'f231', 'f232', 'f233', 'f234', 'f235', 'f236', 'f237', 'f238', 'f239', 'f240', 'f241', 'f242', 'f243', 'f244', 'f245', 'f246', 'f247', 'f248', 'f249', 'f250', 'f251', 'f252', 'f253', 'f254', 'f255', 'f256', 'f257', 'f258', 'f259', 'f260', 'f261', 'f262', 'f263', 'f264', 'f265', 'f266', 'f267', 'f268', 'f269', 'f270', 'f271', 'f272', 'f273', 'f274', 'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283', 'f284', 'f285', 'f286', 'f287', 'f288', 'f289', 'f290', 'f291', 'f292', 'f293', 'f294', 'f295', 'f296', 'f297', 'f298', 'f299', 'f300', 'f301', 'f302', 'f303', 'f304', 'f305', 'f306', 'f307', 'f308'] ['f0', 'f1']
expected f15, f111, f129, f92, f219, f268, f28, f167, f290, f211, f197, f164, f252, f299, f109, f275, f277, f234, f105, f170, f199, f47, f48, f259, f40, f177, f148, f195, f256, f67, f27, f238, f85, f186, f117, f62, f21, f126, f64, f250, f149, f182, f184, f51, f273, f169, f267, f95, f45, f291, f270, f301, f127, f35, f230, f58, f106, f77, f276, f39, f305, f225, f237, f114, f295, f138, f262, f213, f18, f60, f185, f233, f94, f121, f43, f152, f74, f293, f178, f221, f14, f200, f298, f147, f154, f55, f80, f5, f166, f251, f16, f162, f101, f139, f42, f131, f132, f192, f100, f99, f103, f222, f2, f217, f53, f98, f263, f32, f76, f89, f4, f141, f107, f187, f248, f243, f183, f83, f284, f90, f37, f247, f102, f264, f288, f307, f241, f188, f260, f272, f57, f145, f287, f255, f31, f228, f146, f174, f223, f294, f253, f179, f122, f88, f44, f120, f136, f257, f269, f261, f173, f75, f116, f96, f224, f38, f232, f30, f133, f280, f153, f11, f208, f108, f86, f207, f65, f87, f231, f34, f23, f297, f61, f203, f193, f249, f119, f158, f266, f59, f206, f202, f308, f190, f292, f104, f54, f24, f63, f130, f157, f180, f198, f143, f156, f229, f171, f218, f56, f70, f245, f151, f214, f168, f216, f72, f278, f220, f212, f285, f52, f73, f196, f163, f296, f115, f150, f165, f71, f303, f160, f175, f209, f191, f289, f189, f33, f125, f144, f36, f304, f13, f10, f161, f283, f306, f239, f181, f7, f172, f235, f6, f82, f204, f254, f159, f242, f142, f134, f140, f110, f81, f215, f282, f258, f41, f302, f155, f69, f84, f244, f20, f118, f97, f68, f271, f274, f123, f9, f112, f124, f135, f17, f240, f26, f46, f286, f78, f8, f300, f194, f19, f226, f236, f281, f29, f210, f137, f66, f93, f201, f246, f265, f49, f12, f22, f91, f128, f205, f176, f79, f113, f25, f279, f3, f227, f50 in input data
2018-07-17 10:23:55,121 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 10:23:55,121 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 10:23:55,137 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 10:23:55,137 - DEBUG - data_preprocessing.py:238 - 耗时0.015979528427124023
2018-07-17 10:23:55,735 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 10:23:55,735 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 10:23:55,809 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 10:23:55,809 - DEBUG - data_preprocessing.py:238 - 耗时0.07372474670410156
2018-07-17 10:23:57,189 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 10:23:57,189 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 10:23:57,445 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 10:23:57,445 - DEBUG - data_preprocessing.py:238 - 耗时0.25615572929382324
2018-07-17 10:24:02,061 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 10:24:02,061 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 10:24:02,578 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 10:24:02,578 - DEBUG - data_preprocessing.py:238 - 耗时0.5173242092132568
2018-07-17 10:24:02,590 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 10:24:02,591 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
2018-07-17 10:24:03,044 - DEBUG - PCA_fea.py:53 - the shape of train_image: (200000, 309)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-17 10:24:03,754 - DEBUG - PCA_fea.py:68 - (160000, 309)
2018-07-17 10:24:03,754 - DEBUG - PCA_fea.py:69 - (40000, 309)
2018-07-17 10:24:11,013 - DEBUG - PCA_fea.py:169 - 5
2018-07-17 10:24:11,013 - DEBUG - PCA_fea.py:175 - [0.3036095  0.20327776 0.13752796 0.08573196 0.07657412]
2018-07-17 10:24:11,429 - DEBUG - PCA_fea.py:192 - (200000, 5)
2018-07-17 10:27:11,270 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 10:27:11,270 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 10:27:11,286 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 10:27:11,286 - DEBUG - data_preprocessing.py:238 - 耗时0.016220808029174805
2018-07-17 10:27:11,991 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 10:27:11,991 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 10:27:12,065 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 10:27:12,065 - DEBUG - data_preprocessing.py:238 - 耗时0.07346439361572266
2018-07-17 10:27:13,447 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 10:27:13,448 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 10:27:13,702 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 10:27:13,702 - DEBUG - data_preprocessing.py:238 - 耗时0.2541956901550293
2018-07-17 10:27:18,374 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 10:27:18,375 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 10:27:18,887 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 10:27:18,887 - DEBUG - data_preprocessing.py:238 - 耗时0.5121519565582275
2018-07-17 10:27:18,898 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 10:27:18,899 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
2018-07-17 10:27:19,351 - DEBUG - PCA_fea.py:53 - the shape of train_image: (200000, 309)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-17 10:27:20,060 - DEBUG - PCA_fea.py:68 - (160000, 309)
2018-07-17 10:27:20,060 - DEBUG - PCA_fea.py:69 - (40000, 309)
2018-07-17 10:27:27,017 - DEBUG - PCA_fea.py:169 - 5
2018-07-17 10:27:27,017 - DEBUG - PCA_fea.py:175 - [0.3036095  0.20327776 0.13752796 0.08573196 0.07657412]
2018-07-17 10:27:27,431 - DEBUG - PCA_fea.py:192 - (200000, 5)
2018-07-17 10:27:52,663 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 13)
2018-07-17 10:27:52,663 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 5)
2018-07-17 10:27:52,679 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 18)
2018-07-17 10:27:52,679 - DEBUG - data_preprocessing.py:238 - 耗时0.015912771224975586
2018-07-17 10:27:53,399 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 18)
2018-07-17 10:27:53,399 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 57)
2018-07-17 10:27:53,470 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 75)
2018-07-17 10:27:53,470 - DEBUG - data_preprocessing.py:238 - 耗时0.07114434242248535
2018-07-17 10:27:54,829 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 75)
2018-07-17 10:27:54,829 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 79)
2018-07-17 10:27:55,085 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 154)
2018-07-17 10:27:55,086 - DEBUG - data_preprocessing.py:238 - 耗时0.25612974166870117
2018-07-17 10:27:59,668 - DEBUG - data_preprocessing.py:233 - data1.shape:(200000, 154)
2018-07-17 10:27:59,669 - DEBUG - data_preprocessing.py:234 - data2.shape:(200000, 156)
2018-07-17 10:28:00,185 - DEBUG - data_preprocessing.py:237 - 结果.shape:(200000, 310)
2018-07-17 10:28:00,186 - DEBUG - data_preprocessing.py:238 - 耗时0.5168697834014893
2018-07-17 10:28:00,197 - DEBUG - data_preprocessing.py:1017 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'exptv_device_typedev_ip_app_site', 'cnttv_device_typedev_ip_app_site',
       'exptv_device_typedevice_conn_type',
       'cnttv_device_typedevice_conn_type',
       'exptv_device_conn_typeapp_site_model_aw',
       'cnttv_device_conn_typeapp_site_model_aw',
       'exptv_device_conn_typedev_ip_app_site',
       'cnttv_device_conn_typedev_ip_app_site',
       'exptv_app_site_model_awdev_ip_app_site',
       'cnttv_app_site_model_awdev_ip_app_site'],
      dtype='object', length=310)
2018-07-17 10:28:00,198 - DEBUG - data_preprocessing.py:1019 - (200000, 310)
2018-07-17 10:28:00,649 - DEBUG - PCA_fea.py:53 - the shape of train_image: (200000, 309)
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-17 10:28:01,354 - DEBUG - PCA_fea.py:68 - (160000, 309)
2018-07-17 10:28:01,354 - DEBUG - PCA_fea.py:69 - (40000, 309)
2018-07-17 10:28:08,329 - DEBUG - PCA_fea.py:169 - 6
2018-07-17 10:28:08,329 - DEBUG - PCA_fea.py:175 - [0.3036095  0.20327776 0.13752796 0.08573196 0.07657412 0.05033152]
2018-07-17 10:28:08,741 - DEBUG - PCA_fea.py:192 - (200000, 6)
Traceback (most recent call last):
  File "PCA_fea.py", line 193, in <module>
    logging.debug(X_train_pca.head(5))
AttributeError: 'numpy.ndarray' object has no attribute 'head'
2018-07-18 15:35:11,401 - DEBUG - data_preprocessing.py:234 - data1.shape:(6064345, 13)
2018-07-18 15:35:11,401 - DEBUG - data_preprocessing.py:235 - data2.shape:(6064345, 5)
2018-07-18 15:35:11,885 - DEBUG - data_preprocessing.py:238 - 结果.shape:(6064345, 18)
2018-07-18 15:35:11,885 - DEBUG - data_preprocessing.py:239 - 耗时0.48340797424316406
2018-07-18 15:35:33,038 - DEBUG - data_preprocessing.py:234 - data1.shape:(6064345, 18)
2018-07-18 15:35:33,038 - DEBUG - data_preprocessing.py:235 - data2.shape:(6064345, 57)
2018-07-18 15:35:35,067 - DEBUG - data_preprocessing.py:238 - 结果.shape:(6064345, 75)
2018-07-18 15:35:35,067 - DEBUG - data_preprocessing.py:239 - 耗时2.028822660446167
2018-07-18 15:36:18,143 - DEBUG - data_preprocessing.py:234 - data1.shape:(6064345, 75)
2018-07-18 15:36:18,143 - DEBUG - data_preprocessing.py:235 - data2.shape:(6064345, 79)
2018-07-18 15:36:26,300 - DEBUG - data_preprocessing.py:238 - 结果.shape:(6064345, 154)
2018-07-18 15:36:26,300 - DEBUG - data_preprocessing.py:239 - 耗时8.157424688339233
2018-07-18 15:36:50,811 - DEBUG - data_preprocessing.py:234 - data1.shape:(6064345, 154)
2018-07-18 15:36:50,811 - DEBUG - data_preprocessing.py:235 - data2.shape:(6064345, 60)
2018-07-18 15:37:05,007 - DEBUG - data_preprocessing.py:238 - 结果.shape:(6064345, 214)
2018-07-18 15:37:05,008 - DEBUG - data_preprocessing.py:239 - 耗时14.196110725402832
2018-07-18 15:37:05,233 - DEBUG - data_preprocessing.py:520 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'xgb_basis50', 'xgb_basis51', 'xgb_basis52', 'xgb_basis53',
       'xgb_basis54', 'xgb_basis55', 'xgb_basis56', 'xgb_basis57',
       'xgb_basis58', 'xgb_basis59'],
      dtype='object', length=214)
2018-07-18 15:37:05,234 - DEBUG - data_preprocessing.py:522 - (6064345, 214)
[15:39:58] Allocated 2309MB on [0] GeForce GTX 1070 Ti, 5277MB remaining.
[15:40:00] Allocated 162MB on [0] GeForce GTX 1070 Ti, 5161MB remaining.
[15:40:00] Allocated 49MB on [0] GeForce GTX 1070 Ti, 5111MB remaining.
[15:44:45] Allocated 990MB on [0] GeForce GTX 1070 Ti, 3999MB remaining.
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-18 15:44:56,224 - DEBUG - xgb.py:147 - 0.388694814671163
2018-07-18 15:44:56,462 - DEBUG - xgb.py:194 - fin:to save validation predictions ...
2018-07-18 15:44:56,523 - DEBUG - xgb.py:196 - ['/data/xgboost.cv_fin.model.joblib_dat']
(6064345, 214)
2018-07-18 15:46:40,757 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 13)
2018-07-18 15:46:40,758 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 5)
2018-07-18 15:46:41,119 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 18)
2018-07-18 15:46:41,119 - DEBUG - data_preprocessing.py:239 - 耗时0.36139583587646484
2018-07-18 15:46:55,781 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 18)
2018-07-18 15:46:55,781 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 57)
2018-07-18 15:46:57,307 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 75)
2018-07-18 15:46:57,307 - DEBUG - data_preprocessing.py:239 - 耗时1.5266571044921875
2018-07-18 15:47:29,311 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 75)
2018-07-18 15:47:29,311 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 79)
2018-07-18 15:47:35,585 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 154)
2018-07-18 15:47:35,585 - DEBUG - data_preprocessing.py:239 - 耗时6.2733776569366455
2018-07-18 15:47:48,498 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 154)
2018-07-18 15:47:48,498 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 60)
2018-07-18 15:47:59,291 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 214)
2018-07-18 15:47:59,291 - DEBUG - data_preprocessing.py:239 - 耗时10.793178081512451
2018-07-18 15:47:59,448 - DEBUG - data_preprocessing.py:540 - (4577464, 214)
(4577464, 213)
Traceback (most recent call last):
  File "xgb.py", line 223, in <module>
    done(False)
  File "xgb.py", line 207, in done
    dtrain_predprob = xgb1.predict_proba(X_test)[:,1]
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/sklearn.py", line 587, in predict_proba
    ntree_limit=ntree_limit)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 1142, in predict
    self._validate_features(data)
  File "/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/xgboost-0.72-py3.6.egg/xgboost/core.py", line 1400, in _validate_features
    data.feature_names))
ValueError: feature_names mismatch: ['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip', 'device_model', 'device_type', 'app_or_web', 'app_site_id', 'app_site_model', 'app_site_model_aw', 'dev_ip_app_site', 'one_day', 'one_day_hour', 'day_hour_prev', 'day_hour_next', 'is_work_day', 'C15', 'C16', 'C18', 'C19', 'C20', 'app_category', 'app_domain', 'app_id', 'banner_pos', 'device_id', 'hour', 'site_category', 'site_domain', 'site_id', 'uid', 'uid_time', 'device_id_cnt', 'device_ip_cnt', 'uid_cnt', 'uid_time_cnt', 'top_10_app_id', 'top_25_app_id', 'top_5_app_id', 'top_50_app_id', 'top_1_app_id', 'top_2_app_id', 'top_15_app_id', 'top_20_app_id', 'top_30_app_id', 'top_10_site_id', 'top_25_site_id', 'top_5_site_id', 'top_50_site_id', 'top_1_site_id', 'top_2_site_id', 'top_15_site_id', 'top_20_site_id', 'top_30_site_id', 'top_10_app_domain', 'top_25_app_domain', 'top_5_app_domain', 'top_50_app_domain', 'top_1_app_domain', 'top_2_app_domain', 'top_15_app_domain', 'top_20_app_domain', 'top_30_app_domain', 'top_10_app_category', 'top_25_app_category', 'top_5_app_category', 'top_50_app_category', 'top_1_app_category', 'top_2_app_category', 'top_15_app_category', 'top_20_app_category', 'top_30_app_category', 'app_or_webC14', '_key1', 'app_or_webC21', 'app_or_webdevice_conn_type', 'app_or_webdevice_ip', 'app_or_webC1', 'app_or_webdevice_model', 'app_or_webdev_ip_app_site', 'app_or_webdevice_type', 'app_or_webapp_site_model', 'app_or_webapp_site_model_aw', 'app_or_webapp_site_id', 'app_or_webC17', 'device_ipC14', 'device_ipC21', 'device_ipdevice_conn_type', 'device_ipC1', 'device_ipdevice_model', 'device_ipdev_ip_app_site', 'device_ipdevice_type', 'device_ipapp_site_model', 'device_ipapp_site_model_aw', 'device_ipapp_site_id', 'device_ipC17', 'app_site_idC21', 'app_site_idC14', 'app_site_iddevice_conn_type', 'app_site_idC1', 'app_site_iddevice_model', 'app_site_iddev_ip_app_site', 'app_site_idC17', 'app_site_idapp_site_model', 'app_site_idapp_site_model_aw', 'app_site_iddevice_type', 'device_modelC21', 'device_modelC14', 'device_modeldevice_conn_type', 'device_modelC1', 'device_modelC17', 'device_modeldev_ip_app_site', 'device_modelapp_site_model', 'device_modelapp_site_model_aw', 'device_modeldevice_type', 'app_site_modelC21', 'app_site_modelC14', 'app_site_modeldevice_conn_type', 'app_site_modelC1', 'app_site_modelC17', 'app_site_modeldev_ip_app_site', 'app_site_modelapp_site_model_aw', 'app_site_modeldevice_type', 'C1C21', 'C1C14', 'C1device_conn_type', 'C1C17', 'C1dev_ip_app_site', 'C1app_site_model_aw', 'C1device_type', 'C14C21', 'C14device_conn_type', 'C14C17', 'C14dev_ip_app_site', 'C14app_site_model_aw', 'C14device_type', 'C17C21', 'C17device_conn_type', 'C17dev_ip_app_site', 'C17app_site_model_aw', 'C17device_type', 'C21app_site_model_aw', 'C21dev_ip_app_site', 'C21device_conn_type', 'C21device_type', 'device_typeapp_site_model_aw', 'device_typedev_ip_app_site', 'device_typedevice_conn_type', 'device_conn_typeapp_site_model_aw', 'device_conn_typedev_ip_app_site', 'app_site_model_awdev_ip_app_site', 'xgb_basis0', 'xgb_basis1', 'xgb_basis2', 'xgb_basis3', 'xgb_basis4', 'xgb_basis5', 'xgb_basis6', 'xgb_basis7', 'xgb_basis8', 'xgb_basis9', 'xgb_basis10', 'xgb_basis11', 'xgb_basis12', 'xgb_basis13', 'xgb_basis14', 'xgb_basis15', 'xgb_basis16', 'xgb_basis17', 'xgb_basis18', 'xgb_basis19', 'xgb_basis20', 'xgb_basis21', 'xgb_basis22', 'xgb_basis23', 'xgb_basis24', 'xgb_basis25', 'xgb_basis26', 'xgb_basis27', 'xgb_basis28', 'xgb_basis29', 'xgb_basis30', 'xgb_basis31', 'xgb_basis32', 'xgb_basis33', 'xgb_basis34', 'xgb_basis35', 'xgb_basis36', 'xgb_basis37', 'xgb_basis38', 'xgb_basis39', 'xgb_basis40', 'xgb_basis41', 'xgb_basis42', 'xgb_basis43', 'xgb_basis44', 'xgb_basis45', 'xgb_basis46', 'xgb_basis47', 'xgb_basis48', 'xgb_basis49', 'xgb_basis50', 'xgb_basis51', 'xgb_basis52', 'xgb_basis53', 'xgb_basis54', 'xgb_basis55', 'xgb_basis56', 'xgb_basis57', 'xgb_basis58', 'xgb_basis59'] ['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip', 'device_model', 'device_type', 'app_or_web', 'app_site_id', 'app_site_model', 'app_site_model_aw', 'dev_ip_app_site', 'one_day', 'one_day_hour', 'day_hour_prev', 'day_hour_next', 'is_work_day', 'C15', 'C16', 'C18', 'C19', 'C20', 'app_category', 'app_domain', 'app_id', 'banner_pos', 'device_id', 'hour', 'site_category', 'site_domain', 'site_id', 'uid', 'uid_time', 'device_id_cnt', 'device_ip_cnt', 'uid_cnt', 'uid_time_cnt', 'top_10_app_id', 'top_25_app_id', 'top_5_app_id', 'top_50_app_id', 'top_1_app_id', 'top_2_app_id', 'top_15_app_id', 'top_20_app_id', 'top_30_app_id', 'top_10_site_id', 'top_25_site_id', 'top_5_site_id', 'top_50_site_id', 'top_1_site_id', 'top_2_site_id', 'top_15_site_id', 'top_20_site_id', 'top_30_site_id', 'top_10_app_domain', 'top_25_app_domain', 'top_5_app_domain', 'top_50_app_domain', 'top_1_app_domain', 'top_2_app_domain', 'top_15_app_domain', 'top_20_app_domain', 'top_30_app_domain', 'top_10_app_category', 'top_25_app_category', 'top_5_app_category', 'top_50_app_category', 'top_1_app_category', 'top_2_app_category', 'top_15_app_category', 'top_20_app_category', 'top_30_app_category', 'app_or_webdevice_type', '_key1', 'app_or_webC1', 'app_or_webC14', 'app_or_webdevice_model', 'app_or_webdevice_conn_type', 'app_or_webapp_site_model_aw', 'app_or_webdev_ip_app_site', 'app_or_webdevice_ip', 'app_or_webapp_site_model', 'app_or_webC17', 'app_or_webapp_site_id', 'app_or_webC21', 'device_ipdevice_type', 'device_ipC1', 'device_ipC14', 'device_ipdevice_model', 'device_ipdevice_conn_type', 'device_ipapp_site_model_aw', 'device_ipdev_ip_app_site', 'device_ipapp_site_model', 'device_ipC17', 'device_ipapp_site_id', 'device_ipC21', 'app_site_iddevice_type', 'app_site_idC1', 'app_site_idC14', 'app_site_iddevice_model', 'app_site_iddevice_conn_type', 'app_site_idapp_site_model_aw', 'app_site_iddev_ip_app_site', 'app_site_idapp_site_model', 'app_site_idC17', 'app_site_idC21', 'device_modeldevice_type', 'device_modelC1', 'device_modelC14', 'device_modeldevice_conn_type', 'device_modeldev_ip_app_site', 'device_modelapp_site_model_aw', 'device_modelapp_site_model', 'device_modelC17', 'device_modelC21', 'app_site_modeldevice_type', 'app_site_modelC1', 'app_site_modelC14', 'app_site_modeldevice_conn_type', 'app_site_modeldev_ip_app_site', 'app_site_modelapp_site_model_aw', 'app_site_modelC17', 'app_site_modelC21', 'C1device_type', 'C1C14', 'C1device_conn_type', 'C1dev_ip_app_site', 'C1app_site_model_aw', 'C1C17', 'C1C21', 'C14device_type', 'C14device_conn_type', 'C14dev_ip_app_site', 'C14app_site_model_aw', 'C14C17', 'C14C21', 'C17device_type', 'C17device_conn_type', 'C17dev_ip_app_site', 'C17app_site_model_aw', 'C17C21', 'C21app_site_model_aw', 'C21device_type', 'C21device_conn_type', 'C21dev_ip_app_site', 'device_typeapp_site_model_aw', 'device_typedevice_conn_type', 'device_typedev_ip_app_site', 'device_conn_typeapp_site_model_aw', 'device_conn_typedev_ip_app_site', 'app_site_model_awdev_ip_app_site', 'xgb_basis0', 'xgb_basis1', 'xgb_basis2', 'xgb_basis3', 'xgb_basis4', 'xgb_basis5', 'xgb_basis6', 'xgb_basis7', 'xgb_basis8', 'xgb_basis9', 'xgb_basis10', 'xgb_basis11', 'xgb_basis12', 'xgb_basis13', 'xgb_basis14', 'xgb_basis15', 'xgb_basis16', 'xgb_basis17', 'xgb_basis18', 'xgb_basis19', 'xgb_basis20', 'xgb_basis21', 'xgb_basis22', 'xgb_basis23', 'xgb_basis24', 'xgb_basis25', 'xgb_basis26', 'xgb_basis27', 'xgb_basis28', 'xgb_basis29', 'xgb_basis30', 'xgb_basis31', 'xgb_basis32', 'xgb_basis33', 'xgb_basis34', 'xgb_basis35', 'xgb_basis36', 'xgb_basis37', 'xgb_basis38', 'xgb_basis39', 'xgb_basis40', 'xgb_basis41', 'xgb_basis42', 'xgb_basis43', 'xgb_basis44', 'xgb_basis45', 'xgb_basis46', 'xgb_basis47', 'xgb_basis48', 'xgb_basis49', 'xgb_basis50', 'xgb_basis51', 'xgb_basis52', 'xgb_basis53', 'xgb_basis54', 'xgb_basis55', 'xgb_basis56', 'xgb_basis57', 'xgb_basis58', 'xgb_basis59']
2018-07-18 17:35:04,178 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 13)
2018-07-18 17:35:04,178 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 5)
2018-07-18 17:35:04,549 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 18)
2018-07-18 17:35:04,549 - DEBUG - data_preprocessing.py:239 - 耗时0.37105679512023926
2018-07-18 17:35:20,942 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 18)
2018-07-18 17:35:20,942 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 57)
2018-07-18 17:35:22,459 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 75)
2018-07-18 17:35:22,460 - DEBUG - data_preprocessing.py:239 - 耗时1.5176420211791992
2018-07-18 17:35:55,153 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 75)
2018-07-18 17:35:55,153 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 79)
2018-07-18 17:36:01,522 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 154)
2018-07-18 17:36:01,522 - DEBUG - data_preprocessing.py:239 - 耗时6.369340419769287
2018-07-18 17:36:13,950 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 154)
2018-07-18 17:36:13,951 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 60)
2018-07-18 17:36:24,749 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 214)
2018-07-18 17:36:24,749 - DEBUG - data_preprocessing.py:239 - 耗时10.798896074295044
2018-07-18 17:36:24,912 - DEBUG - data_preprocessing.py:540 - (4577464, 214)
2018-07-18 17:37:05,639 - DEBUG - xgb.py:208 - [[0.46185422 0.5381458 ]
 [0.20074391 0.7992561 ]
 [0.2519334  0.7480666 ]
 ...
 [0.0709821  0.9290179 ]
 [0.7727472  0.2272528 ]
 [0.47101235 0.52898765]]
(4577464, 213)
Traceback (most recent call last):
  File "xgb.py", line 223, in <module>
    done(False)
  File "xgb.py", line 209, in done
    y_pred = [round(value,4) for value in dtrain_predprob]
  File "xgb.py", line 209, in <listcomp>
    y_pred = [round(value,4) for value in dtrain_predprob]
TypeError: type numpy.ndarray doesn't define __round__ method
2018-07-18 17:39:02,643 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 13)
2018-07-18 17:39:02,643 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 5)
2018-07-18 17:39:03,001 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 18)
2018-07-18 17:39:03,001 - DEBUG - data_preprocessing.py:239 - 耗时0.3583188056945801
2018-07-18 17:39:20,273 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 18)
2018-07-18 17:39:20,273 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 57)
2018-07-18 17:39:21,801 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 75)
2018-07-18 17:39:21,801 - DEBUG - data_preprocessing.py:239 - 耗时1.528367519378662
2018-07-18 17:39:54,244 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 75)
2018-07-18 17:39:54,244 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 79)
2018-07-18 17:40:00,493 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 154)
2018-07-18 17:40:00,494 - DEBUG - data_preprocessing.py:239 - 耗时6.249749660491943
2018-07-18 17:40:12,849 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 154)
2018-07-18 17:40:12,849 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 60)
2018-07-18 17:40:23,816 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 214)
2018-07-18 17:40:23,816 - DEBUG - data_preprocessing.py:239 - 耗时10.967443227767944
2018-07-18 17:40:23,974 - DEBUG - data_preprocessing.py:540 - (4577464, 214)
2018-07-18 17:41:05,130 - DEBUG - xgb.py:208 - [0.5381458  0.7992561  0.7480666  ... 0.9290179  0.2272528  0.52898765]
2018-07-18 17:41:21,870 - DEBUG - xgb.py:210 - ------------------------------
2018-07-18 17:41:22,104 - DEBUG - xgb.py:212 - (4577464, 1)
2018-07-18 17:41:22,752 - DEBUG - xgb.py:214 - (4577464,)
(4577464, 213)
2018-07-18 18:06:08,361 - DEBUG - data_preprocessing.py:234 - data1.shape:(6064345, 13)
2018-07-18 18:06:08,361 - DEBUG - data_preprocessing.py:235 - data2.shape:(6064345, 5)
2018-07-18 18:06:08,840 - DEBUG - data_preprocessing.py:238 - 结果.shape:(6064345, 18)
2018-07-18 18:06:08,840 - DEBUG - data_preprocessing.py:239 - 耗时0.4789273738861084
2018-07-18 18:06:33,523 - DEBUG - data_preprocessing.py:234 - data1.shape:(6064345, 18)
2018-07-18 18:06:33,523 - DEBUG - data_preprocessing.py:235 - data2.shape:(6064345, 57)
2018-07-18 18:06:35,550 - DEBUG - data_preprocessing.py:238 - 结果.shape:(6064345, 75)
2018-07-18 18:06:35,550 - DEBUG - data_preprocessing.py:239 - 耗时2.026984930038452
2018-07-18 18:07:19,207 - DEBUG - data_preprocessing.py:234 - data1.shape:(6064345, 75)
2018-07-18 18:07:19,207 - DEBUG - data_preprocessing.py:235 - data2.shape:(6064345, 79)
2018-07-18 18:07:27,411 - DEBUG - data_preprocessing.py:238 - 结果.shape:(6064345, 154)
2018-07-18 18:07:27,412 - DEBUG - data_preprocessing.py:239 - 耗时8.204174518585205
2018-07-18 18:07:52,952 - DEBUG - data_preprocessing.py:234 - data1.shape:(6064345, 154)
2018-07-18 18:07:52,953 - DEBUG - data_preprocessing.py:235 - data2.shape:(6064345, 60)
2018-07-18 18:08:07,120 - DEBUG - data_preprocessing.py:238 - 结果.shape:(6064345, 214)
2018-07-18 18:08:07,121 - DEBUG - data_preprocessing.py:239 - 耗时14.167970657348633
2018-07-18 18:08:07,349 - DEBUG - data_preprocessing.py:520 - Index(['C1', 'C14', 'C17', 'C21', 'device_conn_type', 'device_ip',
       'device_model', 'device_type', 'app_or_web', 'app_site_id',
       ...
       'xgb_basis50', 'xgb_basis51', 'xgb_basis52', 'xgb_basis53',
       'xgb_basis54', 'xgb_basis55', 'xgb_basis56', 'xgb_basis57',
       'xgb_basis58', 'xgb_basis59'],
      dtype='object', length=214)
2018-07-18 18:08:07,350 - DEBUG - data_preprocessing.py:522 - (6064345, 214)
[18:11:01] Allocated 2309MB on [0] GeForce GTX 1070 Ti, 5277MB remaining.
[18:11:03] Allocated 162MB on [0] GeForce GTX 1070 Ti, 5161MB remaining.
[18:11:03] Allocated 49MB on [0] GeForce GTX 1070 Ti, 5111MB remaining.
[18:15:47] Allocated 990MB on [0] GeForce GTX 1070 Ti, 3999MB remaining.
/home/zhijiehuang/anaconda3/lib/python3.6/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
2018-07-18 18:15:58,436 - DEBUG - xgb.py:147 - 0.38877497809681655
2018-07-18 18:15:58,668 - DEBUG - xgb.py:194 - fin:to save validation predictions ...
2018-07-18 18:15:58,767 - DEBUG - xgb.py:196 - ['/data/xgboost.cv_fin.model.joblib_dat']
2018-07-18 18:16:07,790 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 13)
2018-07-18 18:16:07,790 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 5)
2018-07-18 18:16:07,919 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 18)
2018-07-18 18:16:07,919 - DEBUG - data_preprocessing.py:239 - 耗时0.12859392166137695
2018-07-18 18:16:34,048 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 18)
2018-07-18 18:16:34,048 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 57)
2018-07-18 18:16:35,563 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 75)
2018-07-18 18:16:35,563 - DEBUG - data_preprocessing.py:239 - 耗时1.5151755809783936
2018-07-18 18:17:08,235 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 75)
2018-07-18 18:17:08,236 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 79)
2018-07-18 18:17:14,497 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 154)
2018-07-18 18:17:14,497 - DEBUG - data_preprocessing.py:239 - 耗时6.261810302734375
2018-07-18 18:17:27,051 - DEBUG - data_preprocessing.py:234 - data1.shape:(4577464, 154)
2018-07-18 18:17:27,051 - DEBUG - data_preprocessing.py:235 - data2.shape:(4577464, 60)
2018-07-18 18:17:37,866 - DEBUG - data_preprocessing.py:238 - 结果.shape:(4577464, 214)
2018-07-18 18:17:37,866 - DEBUG - data_preprocessing.py:239 - 耗时10.814516067504883
2018-07-18 18:17:38,024 - DEBUG - data_preprocessing.py:540 - (4577464, 214)
2018-07-18 18:18:18,492 - DEBUG - xgb.py:208 - [0.3148123  0.2516734  0.32945055 ... 0.0483011  0.8286959  0.5073052 ]
2018-07-18 18:18:34,227 - DEBUG - xgb.py:210 - ------------------------------
2018-07-18 18:18:34,461 - DEBUG - xgb.py:212 - (4577464, 1)
2018-07-18 18:18:35,096 - DEBUG - xgb.py:214 - (4577464,)
(6064345, 214)
(4577464, 213)
2018-07-19 10:50:03,187 - DEBUG - ffm.py:52 - 设置参数
2018-07-19 10:50:03,192 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 4321643
[32m[------------] [0mNumber of Field: 78
[32m[------------] [0mTime cost for reading problem: 22.17 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
2018-07-19 13:35:39,847 - DEBUG - ffm.py:52 - 设置参数
2018-07-19 13:35:39,848 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 4321643
[32m[------------] [0mNumber of Field: 78
[32m[------------] [0mTime cost for reading problem: 21.92 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
2018-07-19 17:12:12,139 - DEBUG - ffm.py:52 - 设置参数
2018-07-19 17:12:12,139 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 4321643
[32m[------------] [0mNumber of Field: 78
[32m[------------] [0mTime cost for reading problem: 40.11 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
2018-07-19 17:30:03,931 - DEBUG - ffm.py:52 - 设置参数
2018-07-19 17:30:03,931 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mNumber of Feature: 64
[32m[------------] [0mNumber of Field: 65
[32m[------------] [0mTime cost for reading problem: 153.04 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 260.51 KB
[32m[------------] [0mTime cost for model initial: 0.00 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
[32m[------------][0m Epoch      Train log_loss       Test log_loss            Test AUC     Time cost (sec)
[32m[ [0m  10%[32m      ][0m     1            0.454707            0.453928            0.578061              823.08
[32m[ [0m  20%[32m      ][0m     2            0.454660            0.453956            0.582601              835.11
[32m[ [0m  30%[32m      ][0m     3            0.454603            0.453913            0.583493              832.50
[32m[ [0m  40%[32m      ][0m     4            0.454666            0.454040            0.581699              832.48
[32m[ [0m  50%[32m      ][0m     5            0.454598            0.454097            0.582615              834.21
[32m[ [0m  60%[32m      ][0m     6            0.454739            0.454169            0.580855              836.83
[32m[ [0m  70%[32m      ][0m     7            0.454516            0.454235            0.582446              839.97
[32m[ [0m  80%[32m      ][0m     8            0.454467            0.453819            0.583169              829.33
[32m[ [0m  90%[32m      ][0m     9            0.454744            0.454249            0.581217              833.85
[32m[ [0m 100%[32m      ][0m    10            0.454397            0.453812            0.582035              828.22
[32m[1m[ ACTION     ] Start to save model ...[0m
[32m[------------] [0mModel file: /data/ffm_model.out
[32m[------------] [0mTime cost for saving model: 0.02 (sec)
[32m[1m[ ACTION     ] Finish training[0m
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 8478.65 (sec)[0m
2018-07-19 19:51:22,586 - DEBUG - ffm.py:60 - to save validation predictions ...
2018-07-19 19:51:22,586 - DEBUG - ffm.py:64 - <xlearn.xlearn.XLearn object at 0x7f6a1135c1d0>
2018-07-19 19:51:22,586 - DEBUG - ffm.py:52 - 设置参数
2018-07-19 19:51:22,586 - DEBUG - ffm.py:79 - 预测
Info: 
 Model: ffm
 Loss: cross-entropy
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Load model ...[0m
[32m[------------] [0mLoad model from /data/ffm_model.out
[32m[------------] [0mLoss function: cross-entropy
[32m[------------] [0mScore function: ffm
[32m[------------] [0mNumber of Feature: 64
[32m[------------] [0mNumber of K: 8
[32m[------------] [0mNumber of field: 65
[32m[------------] [0mTime cost for loading model: 0.00 (sec)
[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_test.libffm.csv.bin) NOT found. Convert text file to binary file.
[32m[------------] [0mTime cost for reading problem: 56.35 (sec)
[32m[1m[ ACTION     ] Start to predict ...[0m
[32m[------------] [0mThe test loss is: 0.191723
[32m[1m[ ACTION     ] Clear the xLearn environment ...[0m
[32m[1m[------------] Total time cost: 83.50 (sec)[0m
2018-07-19 19:52:46,289 - DEBUG - ffm.py:86 - <xlearn.xlearn.XLearn object at 0x7f6a1135c1d0>
2018-07-19 19:52:49,387 - DEBUG - ffm.py:88 - ------------------------------
2018-07-19 19:52:49,497 - DEBUG - ffm.py:90 - (4577464, 1)
2018-07-19 19:52:50,660 - DEBUG - ffm.py:92 - (4577464,)
Info: 
 Model: ffm
 Loss: cross-entropy
2018-07-23 15:32:53,540 - DEBUG - ffm.py:52 - 设置参数
2018-07-23 15:32:53,540 - DEBUG - ffm.py:54 - 开始训练
[32m[1m----------------------------------------------------------------------------------------------
           _
          | |
     __  _| |     ___  __ _ _ __ _ __
     \ \/ / |    / _ \/ _` | '__| '_ \ 
      >  <| |___|  __/ (_| | |  | | | |
     /_/\_\_____/\___|\__,_|_|  |_| |_|

        xLearn   -- 0.31 Version --
----------------------------------------------------------------------------------------------

[39m[0m[32m[1m[ ACTION     ] Read Problem ...[0m
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_train.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mFirst check if the text file has been already converted to binary format.
[32m[------------] [0mBinary file (/data/ont_hot_vali.libffm.csv.bin) found. Skip converting text to binary.
[32m[------------] [0mNumber of Feature: 64
[32m[------------] [0mNumber of Field: 65
[32m[------------] [0mTime cost for reading problem: 38.34 (sec)
[32m[1m[ ACTION     ] Initialize model ...[0m
[32m[------------] [0mModel size: 260.51 KB
[32m[------------] [0mTime cost for model initial: 0.00 (sec)
[32m[1m[ ACTION     ] Start to train ...[0m
